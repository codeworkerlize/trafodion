# Force kills all the ampool processes (locator and server) and deletes the ampool data directory

. $TRAF_HOME/sql/scripts/ampool/setup_ampool_env

echo "This script will:"
echo "- kill the ampool processes"
echo "- remove the ampool data directory: ${AMPOOL_DBLOC}"

echo -n "Is this ok? (y, (n)) "
read YN

if [ "$YN" = "n" -o "$YN" = "N" ]; then
    echo "Exiting without doing anything..."
    exit 0
fi

jps | grep LocatorLauncher
if [[ $? == "0" ]]; then
  jps | grep LocatorLauncher | cut -f 1 -d' ' | xargs kill -9 
else
  echo "Did not find any Ampool locator process."
fi

jps | grep ServerLauncher
if [[ $? == "0" ]]; then
  jps | grep ServerLauncher | cut -f 1 -d' ' | xargs kill -9 
else
  echo "Did not find any Ampool server process."
fi

echo "Going to execute: rm -rf ${AMPOOL_DBLOC}"
rm -rf ${AMPOOL_DBLOC}

echo "Done."
