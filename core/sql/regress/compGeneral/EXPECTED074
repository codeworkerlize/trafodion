>>
>>cqd MODE_COMPATIBLE_1 'on';

--- SQL operation complete.
>>
>>obey TEST074(clnup);
>>--------------------------------------------------------------------------
>>
>>drop schema IF EXISTS t074sch_rownum cascade;

--- SQL operation complete.
>>
>>
>>
>>set schema t074sch_rownum;

--- SQL operation complete.
>>
>>obey TEST074(ddl);
>>--------------------------------------------------------------------------
>>
>>create schema t074sch_rownum;

--- SQL operation complete.
>>
>>-- table without primary key
>>drop table if exists t074t1 ;

--- SQL operation complete.
>>create table t074t1 ( c1 int not null, c2 int ) salt using 5 partitions on (c1) store by (c1);

--- SQL operation complete.
>>insert into t074t1 values(1, 20);

--- 1 row(s) inserted.
>>insert into t074t1 values(2, 19);

--- 1 row(s) inserted.
>>insert into t074t1 values(5, 16);

--- 1 row(s) inserted.
>>insert into t074t1 values(8, 13);

--- 1 row(s) inserted.
>>insert into t074t1 values(3, 18);

--- 1 row(s) inserted.
>>insert into t074t1 values(4, 17);

--- 1 row(s) inserted.
>>insert into t074t1 values(6, 15);

--- 1 row(s) inserted.
>>insert into t074t1 values(7, 14);

--- 1 row(s) inserted.
>>insert into t074t1 values(10, 11);

--- 1 row(s) inserted.
>>insert into t074t1 values(9, 12);

--- 1 row(s) inserted.
>>
>>-- table with primary key
>>drop table if exists t074t2 ;

--- SQL operation complete.
>>create table t074t2 ( c1 int not null, c2 int not null , primary key (c1, c2)) salt using 5 partitions on (c1, c2);

--- SQL operation complete.
>>insert into t074t2 values(2, 1);

--- 1 row(s) inserted.
>>insert into t074t2 values(5, 3);

--- 1 row(s) inserted.
>>insert into t074t2 values(1, 1);

--- 1 row(s) inserted.
>>insert into t074t2 values(3, 1);

--- 1 row(s) inserted.
>>insert into t074t2 values(1, 2);

--- 1 row(s) inserted.
>>insert into t074t2 values(3, 2);

--- 1 row(s) inserted.
>>insert into t074t2 values(4, 1);

--- 1 row(s) inserted.
>>insert into t074t2 values(5, 1);

--- 1 row(s) inserted.
>>insert into t074t2 values(2, 3);

--- 1 row(s) inserted.
>>insert into t074t2 values(5, 2);

--- 1 row(s) inserted.
>>insert into t074t2 values(2, 2);

--- 1 row(s) inserted.
>>
>>-- 
>>drop table if exists t074t3 ;

--- SQL operation complete.
>>CREATE TABLE t074t3
+>  (
+>    C1                               INT NO DEFAULT NOT NULL NOT DROPPABLE NOT
+>      SERIALIZED
+>  , C2                               INT DEFAULT NULL NOT SERIALIZED
+>  )
+>  STORE BY (C1 ASC)
+>  SALT USING 5 PARTITIONS
+> ATTRIBUTES ALIGNED FORMAT
+>;

--- SQL operation complete.
>>
>>insert into t074t3 values(1, 20);

--- 1 row(s) inserted.
>>insert into t074t3 values(2, 19);

--- 1 row(s) inserted.
>>insert into t074t3 values(5, 16);

--- 1 row(s) inserted.
>>insert into t074t3 values(8, 13);

--- 1 row(s) inserted.
>>insert into t074t3 values(3, 18);

--- 1 row(s) inserted.
>>insert into t074t3 values(4, 17);

--- 1 row(s) inserted.
>>insert into t074t3 values(6, 15);

--- 1 row(s) inserted.
>>insert into t074t3 values(7, 14);

--- 1 row(s) inserted.
>>insert into t074t3 values(10, 11);

--- 1 row(s) inserted.
>>insert into t074t3 values(9, 12);

--- 1 row(s) inserted.
>>
>>drop table if exists t074t4 ;

--- SQL operation complete.
>>create table t074t4 ( c1 int not null, "ROWNUM" varchar(30) not null , "rownum" varchar(30) not null);

--- SQL operation complete.
>>insert into t074t4 values(2, 'ROWNUM UPPER 01', 'rownum lower 21');

--- 1 row(s) inserted.
>>insert into t074t4 values(5, 'ROWNUM UPPER 02', 'rownum lower 22');

--- 1 row(s) inserted.
>>insert into t074t4 values(1, 'ROWNUM UPPER 03', 'rownum lower 23');

--- 1 row(s) inserted.
>>insert into t074t4 values(3, 'ROWNUM UPPER 04', 'rownum lower 24');

--- 1 row(s) inserted.
>>insert into t074t4 values(1, 'ROWNUM UPPER 05', 'rownum lower 25');

--- 1 row(s) inserted.
>>insert into t074t4 values(3, 'ROWNUM UPPER 06', 'rownum lower 26');

--- 1 row(s) inserted.
>>insert into t074t4 values(4, 'ROWNUM UPPER 07', 'rownum lower 27');

--- 1 row(s) inserted.
>>insert into t074t4 values(5, 'ROWNUM UPPER 08', 'rownum lower 28');

--- 1 row(s) inserted.
>>insert into t074t4 values(2, 'ROWNUM UPPER 09', 'rownum lower 29');

--- 1 row(s) inserted.
>>insert into t074t4 values(5, 'ROWNUM UPPER 10', 'rownum lower 20');

--- 1 row(s) inserted.
>>insert into t074t4 values(2, 'ROWNUM UPPER 11', 'rownum lower 21');

--- 1 row(s) inserted.
>>
>>create view t074t4_v as select c1, "ROWNUM" as ROWNUM_UPPER, "rownum" as ROWNUM_LOWER, rownum from t074t4 order by 2;

--- SQL operation complete.
>>
>>
>>
>>obey TEST074(common);
>>--------------------------------------------------------------------------
>>
>>prepare s1 from
+>  select c1, rownum from t074t1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM              
-----------  --------------------

          1                     1
          2                     2
          5                     3
          8                     4
          3                     5
          4                     6
          6                     7
          7                     8
         10                     9
          9                    10

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>  select c1, rownum from t074t1 where c1=3;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

2    .    3    root                                                  1.00E+001
1    .    2    sequence                                              1.00E+001
.    .    1    trafodion_scan                  T074T1                1.00E+001

--- SQL operation complete.
>>execute s1;

C1           ROWNUM              
-----------  --------------------

          3                     1

--- 1 row(s) selected.
>>
>>prepare s1 from 
+>  select c1, rownum from t074t1 where rownum <= 5;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM              
-----------  --------------------

          1                     1
          2                     2
          5                     3
          8                     4
          3                     5

--- 5 row(s) selected.
>>
>>prepare s1 from
+>  select c1, rownum from t074t1 order by c1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+002
3    .    4    sort                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM              
-----------  --------------------

          1                     1
          2                     2
          3                     5
          4                     6
          5                     3
          6                     7
          7                     8
          8                     4
          9                    10
         10                     9

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>  select t2.*, rownum rn from (select c1  from t074t1 ) t2;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           RN                  
-----------  --------------------

          1                     1
          2                     2
          5                     3
          8                     4
          3                     5
          4                     6
          6                     7
          7                     8
         10                     9
          9                    10

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select t2.*, t2.rn_n, rownum rn from (select c1, rownum rn_n from t074t1 order by c2) t2;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+002
4    .    5    sequence                                              1.00E+002
3    .    4    sort                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           RN_N                  RN_N                  RN
-----------  --------------------  --------------------  --------------------

         10                     9                     9                     1
          9                    10                    10                     2
          8                     4                     4                     3
          7                     8                     8                     4
          6                     7                     7                     5
          5                     3                     3                     6
          4                     6                     6                     7
          3                     5                     5                     8
          2                     2                     2                     9
          1                     1                     1                    10

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select c1,c2, rownum num from t074t1 order by c2 desc;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+002
3    .    4    sort                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           NUM                 
-----------  -----------  --------------------

          1           20                     1
          2           19                     2
          3           18                     5
          4           17                     6
          5           16                     3
          6           15                     7
          7           14                     8
          8           13                     4
          9           12                    10
         10           11                     9

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select c1,c2, rownum num from (select * from t074t1) order by c2 desc;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+002
3    .    4    sort                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           NUM                 
-----------  -----------  --------------------

          1           20                     1
          2           19                     2
          3           18                     5
          4           17                     6
          5           16                     3
          6           15                     7
          7           14                     8
          8           13                     4
          9           12                    10
         10           11                     9

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select c1, tt.num from (select c1, rownum num from t074t1 where rownum <=8) tt where tt.num >3;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           NUM                 
-----------  --------------------

          8                     4
          3                     5
          4                     6
          6                     7
          7                     8

--- 5 row(s) selected.
>>
>>prepare s1 from
+>SELECT * FROM (SELECT A.*, ROWNUM RN FROM (
+>                   select count(*) over() total,b.* from t074t1 b
+>                   WHERE 1=1 and c1 NOT IN(6,7,8)
+>         )A WHERE ROWNUM <= 6) WHERE RN >0;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+000
4    .    5    sequence                                              1.00E+000
3    .    4    firstn                                                1.00E+000
2    .    3    sort                                                  6.69E+001
1    .    2    sequence                                              6.69E+001
.    .    1    trafodion_scan                  T074T1                6.69E+001

--- SQL operation complete.
>>execute s1;

TOTAL                 C1           C2           RN                  
--------------------  -----------  -----------  --------------------

                   7            1           20                     1
                   7            2           19                     2
                   7            5           16                     3
                   7            3           18                     4
                   7            4           17                     5
                   7           10           11                     6

--- 6 row(s) selected.
>>
>>prepare s1 from 
+>select c1, tt.num from (select c1, rownum num from t074t1 where rownum <=8) tt where tt.num >3 limit 3;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+000
4    .    5    firstn                                                1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           NUM                 
-----------  --------------------

          8                     4
          3                     5
          4                     6

--- 3 row(s) selected.
>>
>>--rownum outside is not a reference to inner rownum
>>prepare s1 from 
+>select c1, rownum from
+>(
+>    select c1, rownum from t074t1 
+>)
+>where rownum <= 9
+>;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+000
4    .    5    sequence                                              1.00E+000
3    .    4    firstn                                                1.00E+000
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM              
-----------  --------------------

          1                     1
          2                     2
          5                     3
          8                     4
          3                     5
          4                     6
          6                     7
          7                     8
         10                     9

--- 9 row(s) selected.
>>
>>
>>
>>obey TEST074(join_query);
>>--------------------------------------------------------------------------
>>
>>prepare s1 from 
+>select t1.*, t2.*, rownum from t074t1 t1, t074t1 t2 ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          1           20            2           19                     2
          1           20            5           16                     3
          1           20            8           13                     4
          1           20            3           18                     5
          1           20            4           17                     6
          1           20            6           15                     7
          1           20            7           14                     8
          1           20           10           11                     9
          1           20            9           12                    10
          2           19            1           20                    11
          2           19            2           19                    12
          2           19            5           16                    13
          2           19            8           13                    14
          2           19            3           18                    15
          2           19            4           17                    16
          2           19            6           15                    17
          2           19            7           14                    18
          2           19           10           11                    19
          2           19            9           12                    20
          5           16            1           20                    21
          5           16            2           19                    22
          5           16            5           16                    23
          5           16            8           13                    24
          5           16            3           18                    25
          5           16            4           17                    26
          5           16            6           15                    27
          5           16            7           14                    28
          5           16           10           11                    29
          5           16            9           12                    30
          8           13            1           20                    31
          8           13            2           19                    32
          8           13            5           16                    33
          8           13            8           13                    34
          8           13            3           18                    35
          8           13            4           17                    36
          8           13            6           15                    37
          8           13            7           14                    38
          8           13           10           11                    39
          8           13            9           12                    40
          3           18            1           20                    41
          3           18            2           19                    42
          3           18            5           16                    43
          3           18            8           13                    44
          3           18            3           18                    45
          3           18            4           17                    46
          3           18            6           15                    47
          3           18            7           14                    48
          3           18           10           11                    49
          3           18            9           12                    50
          4           17            1           20                    51
          4           17            2           19                    52
          4           17            5           16                    53
          4           17            8           13                    54
          4           17            3           18                    55
          4           17            4           17                    56
          4           17            6           15                    57
          4           17            7           14                    58
          4           17           10           11                    59
          4           17            9           12                    60
          6           15            1           20                    61
          6           15            2           19                    62
          6           15            5           16                    63
          6           15            8           13                    64
          6           15            3           18                    65
          6           15            4           17                    66
          6           15            6           15                    67
          6           15            7           14                    68
          6           15           10           11                    69
          6           15            9           12                    70
          7           14            1           20                    71
          7           14            2           19                    72
          7           14            5           16                    73
          7           14            8           13                    74
          7           14            3           18                    75
          7           14            4           17                    76
          7           14            6           15                    77
          7           14            7           14                    78
          7           14           10           11                    79
          7           14            9           12                    80
         10           11            1           20                    81
         10           11            2           19                    82
         10           11            5           16                    83
         10           11            8           13                    84
         10           11            3           18                    85
         10           11            4           17                    86
         10           11            6           15                    87
         10           11            7           14                    88
         10           11           10           11                    89
         10           11            9           12                    90
          9           12            1           20                    91
          9           12            2           19                    92
          9           12            5           16                    93
          9           12            8           13                    94
          9           12            3           18                    95
          9           12            4           17                    96
          9           12            6           15                    97
          9           12            7           14                    98
          9           12           10           11                    99
          9           12            9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select t074t1.*, t074t3.*, rownum from t074t1, t074t3 ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T3                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          1           20            2           19                     2
          1           20            5           16                     3
          1           20            8           13                     4
          1           20            3           18                     5
          1           20            4           17                     6
          1           20            6           15                     7
          1           20            7           14                     8
          1           20           10           11                     9
          1           20            9           12                    10
          2           19            1           20                    11
          2           19            2           19                    12
          2           19            5           16                    13
          2           19            8           13                    14
          2           19            3           18                    15
          2           19            4           17                    16
          2           19            6           15                    17
          2           19            7           14                    18
          2           19           10           11                    19
          2           19            9           12                    20
          5           16            1           20                    21
          5           16            2           19                    22
          5           16            5           16                    23
          5           16            8           13                    24
          5           16            3           18                    25
          5           16            4           17                    26
          5           16            6           15                    27
          5           16            7           14                    28
          5           16           10           11                    29
          5           16            9           12                    30
          8           13            1           20                    31
          8           13            2           19                    32
          8           13            5           16                    33
          8           13            8           13                    34
          8           13            3           18                    35
          8           13            4           17                    36
          8           13            6           15                    37
          8           13            7           14                    38
          8           13           10           11                    39
          8           13            9           12                    40
          3           18            1           20                    41
          3           18            2           19                    42
          3           18            5           16                    43
          3           18            8           13                    44
          3           18            3           18                    45
          3           18            4           17                    46
          3           18            6           15                    47
          3           18            7           14                    48
          3           18           10           11                    49
          3           18            9           12                    50
          4           17            1           20                    51
          4           17            2           19                    52
          4           17            5           16                    53
          4           17            8           13                    54
          4           17            3           18                    55
          4           17            4           17                    56
          4           17            6           15                    57
          4           17            7           14                    58
          4           17           10           11                    59
          4           17            9           12                    60
          6           15            1           20                    61
          6           15            2           19                    62
          6           15            5           16                    63
          6           15            8           13                    64
          6           15            3           18                    65
          6           15            4           17                    66
          6           15            6           15                    67
          6           15            7           14                    68
          6           15           10           11                    69
          6           15            9           12                    70
          7           14            1           20                    71
          7           14            2           19                    72
          7           14            5           16                    73
          7           14            8           13                    74
          7           14            3           18                    75
          7           14            4           17                    76
          7           14            6           15                    77
          7           14            7           14                    78
          7           14           10           11                    79
          7           14            9           12                    80
         10           11            1           20                    81
         10           11            2           19                    82
         10           11            5           16                    83
         10           11            8           13                    84
         10           11            3           18                    85
         10           11            4           17                    86
         10           11            6           15                    87
         10           11            7           14                    88
         10           11           10           11                    89
         10           11            9           12                    90
          9           12            1           20                    91
          9           12            2           19                    92
          9           12            5           16                    93
          9           12            8           13                    94
          9           12            3           18                    95
          9           12            4           17                    96
          9           12            6           15                    97
          9           12            7           14                    98
          9           12           10           11                    99
          9           12            9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select t1.*, t2.*, rownum from (select * from t074t1) t1, (select * from t074t1) t2 ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          1           20            2           19                     2
          1           20            5           16                     3
          1           20            8           13                     4
          1           20            3           18                     5
          1           20            4           17                     6
          1           20            6           15                     7
          1           20            7           14                     8
          1           20           10           11                     9
          1           20            9           12                    10
          2           19            1           20                    11
          2           19            2           19                    12
          2           19            5           16                    13
          2           19            8           13                    14
          2           19            3           18                    15
          2           19            4           17                    16
          2           19            6           15                    17
          2           19            7           14                    18
          2           19           10           11                    19
          2           19            9           12                    20
          5           16            1           20                    21
          5           16            2           19                    22
          5           16            5           16                    23
          5           16            8           13                    24
          5           16            3           18                    25
          5           16            4           17                    26
          5           16            6           15                    27
          5           16            7           14                    28
          5           16           10           11                    29
          5           16            9           12                    30
          8           13            1           20                    31
          8           13            2           19                    32
          8           13            5           16                    33
          8           13            8           13                    34
          8           13            3           18                    35
          8           13            4           17                    36
          8           13            6           15                    37
          8           13            7           14                    38
          8           13           10           11                    39
          8           13            9           12                    40
          3           18            1           20                    41
          3           18            2           19                    42
          3           18            5           16                    43
          3           18            8           13                    44
          3           18            3           18                    45
          3           18            4           17                    46
          3           18            6           15                    47
          3           18            7           14                    48
          3           18           10           11                    49
          3           18            9           12                    50
          4           17            1           20                    51
          4           17            2           19                    52
          4           17            5           16                    53
          4           17            8           13                    54
          4           17            3           18                    55
          4           17            4           17                    56
          4           17            6           15                    57
          4           17            7           14                    58
          4           17           10           11                    59
          4           17            9           12                    60
          6           15            1           20                    61
          6           15            2           19                    62
          6           15            5           16                    63
          6           15            8           13                    64
          6           15            3           18                    65
          6           15            4           17                    66
          6           15            6           15                    67
          6           15            7           14                    68
          6           15           10           11                    69
          6           15            9           12                    70
          7           14            1           20                    71
          7           14            2           19                    72
          7           14            5           16                    73
          7           14            8           13                    74
          7           14            3           18                    75
          7           14            4           17                    76
          7           14            6           15                    77
          7           14            7           14                    78
          7           14           10           11                    79
          7           14            9           12                    80
         10           11            1           20                    81
         10           11            2           19                    82
         10           11            5           16                    83
         10           11            8           13                    84
         10           11            3           18                    85
         10           11            4           17                    86
         10           11            6           15                    87
         10           11            7           14                    88
         10           11           10           11                    89
         10           11            9           12                    90
          9           12            1           20                    91
          9           12            2           19                    92
          9           12            5           16                    93
          9           12            8           13                    94
          9           12            3           18                    95
          9           12            4           17                    96
          9           12            6           15                    97
          9           12            7           14                    98
          9           12           10           11                    99
          9           12            9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select t1.*, t2.*, rownum from (select * from t074t1 order by c1) t1, (select * from t074t1) t2 ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          1           20            2           19                     2
          1           20            5           16                     3
          1           20            8           13                     4
          1           20            3           18                     5
          1           20            4           17                     6
          1           20            6           15                     7
          1           20            7           14                     8
          1           20           10           11                     9
          1           20            9           12                    10
          2           19            1           20                    11
          2           19            2           19                    12
          2           19            5           16                    13
          2           19            8           13                    14
          2           19            3           18                    15
          2           19            4           17                    16
          2           19            6           15                    17
          2           19            7           14                    18
          2           19           10           11                    19
          2           19            9           12                    20
          3           18            1           20                    21
          3           18            2           19                    22
          3           18            5           16                    23
          3           18            8           13                    24
          3           18            3           18                    25
          3           18            4           17                    26
          3           18            6           15                    27
          3           18            7           14                    28
          3           18           10           11                    29
          3           18            9           12                    30
          4           17            1           20                    31
          4           17            2           19                    32
          4           17            5           16                    33
          4           17            8           13                    34
          4           17            3           18                    35
          4           17            4           17                    36
          4           17            6           15                    37
          4           17            7           14                    38
          4           17           10           11                    39
          4           17            9           12                    40
          5           16            1           20                    41
          5           16            2           19                    42
          5           16            5           16                    43
          5           16            8           13                    44
          5           16            3           18                    45
          5           16            4           17                    46
          5           16            6           15                    47
          5           16            7           14                    48
          5           16           10           11                    49
          5           16            9           12                    50
          6           15            1           20                    51
          6           15            2           19                    52
          6           15            5           16                    53
          6           15            8           13                    54
          6           15            3           18                    55
          6           15            4           17                    56
          6           15            6           15                    57
          6           15            7           14                    58
          6           15           10           11                    59
          6           15            9           12                    60
          7           14            1           20                    61
          7           14            2           19                    62
          7           14            5           16                    63
          7           14            8           13                    64
          7           14            3           18                    65
          7           14            4           17                    66
          7           14            6           15                    67
          7           14            7           14                    68
          7           14           10           11                    69
          7           14            9           12                    70
          8           13            1           20                    71
          8           13            2           19                    72
          8           13            5           16                    73
          8           13            8           13                    74
          8           13            3           18                    75
          8           13            4           17                    76
          8           13            6           15                    77
          8           13            7           14                    78
          8           13           10           11                    79
          8           13            9           12                    80
          9           12            1           20                    81
          9           12            2           19                    82
          9           12            5           16                    83
          9           12            8           13                    84
          9           12            3           18                    85
          9           12            4           17                    86
          9           12            6           15                    87
          9           12            7           14                    88
          9           12           10           11                    89
          9           12            9           12                    90
         10           11            1           20                    91
         10           11            2           19                    92
         10           11            5           16                    93
         10           11            8           13                    94
         10           11            3           18                    95
         10           11            4           17                    96
         10           11            6           15                    97
         10           11            7           14                    98
         10           11           10           11                    99
         10           11            9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t1 A join t074t1 B on A.c1 = B.c1 ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  5.00E+003
4    .    5    sequence                                              5.00E+003
3    .    4    sort                                                  5.00E+003
2    1    3    hybrid_hash_join                                      5.00E+003
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          2           19            2           19                     2
          5           16            5           16                     3
          8           13            8           13                     4
          3           18            3           18                     5
          4           17            4           17                     6
          6           15            6           15                     7
          7           14            7           14                     8
         10           11           10           11                     9
          9           12            9           12                    10

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t1 A join t074t2 B on A.c1 = B.c1 ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  5.00E+003
4    .    5    sequence                                              5.00E+003
3    .    4    sort                                                  5.00E+003
2    1    3    hybrid_hash_join                                      5.00E+003
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1            1                     1
          1           20            1            2                     2
          2           19            2            1                     3
          2           19            2            2                     4
          2           19            2            3                     5
          5           16            5            1                     6
          5           16            5            2                     7
          5           16            5            3                     8
          3           18            3            1                     9
          3           18            3            2                    10
          4           17            4            1                    11

--- 11 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t2 A join t074t2 B on A.c1 = B.c1 ;

--- SQL command prepared.
>> --?
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  5.00E+003
4    .    5    sequence                                              5.00E+003
3    .    4    sort                                                  5.00E+003
2    1    3    hybrid_hash_join                                      5.00E+003
.    .    2    trafodion_scan                  T074T2                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1            1            1            1                     1
          1            1            1            2                     2
          1            2            1            1                     3
          1            2            1            2                     4
          2            1            2            1                     5
          2            1            2            2                     6
          2            1            2            3                     7
          2            2            2            1                     8
          2            2            2            2                     9
          2            2            2            3                    10
          2            3            2            1                    11
          2            3            2            2                    12
          2            3            2            3                    13
          3            1            3            1                    14
          3            1            3            2                    15
          3            2            3            1                    16
          3            2            3            2                    17
          4            1            4            1                    18
          5            1            5            1                    19
          5            1            5            2                    20
          5            1            5            3                    21
          5            2            5            1                    22
          5            2            5            2                    23
          5            2            5            3                    24
          5            3            5            1                    25
          5            3            5            2                    26
          5            3            5            3                    27

--- 27 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t2 A join t074t2 B on A.c1 = B.c1 ;

--- SQL command prepared.
>> --?
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  5.00E+003
4    .    5    sequence                                              5.00E+003
3    .    4    sort                                                  5.00E+003
2    1    3    hybrid_hash_join                                      5.00E+003
.    .    2    trafodion_scan                  T074T2                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1            1            1            1                     1
          1            1            1            2                     2
          1            2            1            1                     3
          1            2            1            2                     4
          2            1            2            1                     5
          2            1            2            2                     6
          2            1            2            3                     7
          2            2            2            1                     8
          2            2            2            2                     9
          2            2            2            3                    10
          2            3            2            1                    11
          2            3            2            2                    12
          2            3            2            3                    13
          3            1            3            1                    14
          3            1            3            2                    15
          3            2            3            1                    16
          3            2            3            2                    17
          4            1            4            1                    18
          5            1            5            1                    19
          5            1            5            2                    20
          5            1            5            3                    21
          5            2            5            1                    22
          5            2            5            2                    23
          5            2            5            3                    24
          5            3            5            1                    25
          5            3            5            2                    26
          5            3            5            3                    27

--- 27 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t2 A join t074t2 B on A.c1 = B.c1 order by 1,2;

--- SQL command prepared.
>> --?
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  5.00E+003
4    .    5    sequence                                              5.00E+003
3    .    4    sort                                                  5.00E+003
2    1    3    hybrid_hash_join                                      5.00E+003
.    .    2    trafodion_scan                  T074T2                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1            1            1            1                     1
          1            1            1            2                     2
          1            2            1            1                     3
          1            2            1            2                     4
          2            1            2            1                     5
          2            1            2            2                     6
          2            1            2            3                     7
          2            2            2            1                     8
          2            2            2            2                     9
          2            2            2            3                    10
          2            3            2            1                    11
          2            3            2            2                    12
          2            3            2            3                    13
          3            1            3            1                    14
          3            1            3            2                    15
          3            2            3            1                    16
          3            2            3            2                    17
          4            1            4            1                    18
          5            1            5            1                    19
          5            1            5            2                    20
          5            1            5            3                    21
          5            2            5            1                    22
          5            2            5            2                    23
          5            2            5            3                    24
          5            3            5            1                    25
          5            3            5            2                    26
          5            3            5            3                    27

--- 27 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, C.*, rownum from t074t1 A left join t074t1 B on A.c1=B.c1 left join t074t1 C on B.c1 = C.c1;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

11   .    12   root                                                  2.50E+005
10   .    11   sequence                                              2.50E+005
9    .    10   esp_exchange                    1:2(hash2) (m)        2.50E+005
8    .    9    sort                                                  2.50E+005
7    2    8    left_hybrid_hash_joi                                  2.50E+005
6    4    7    left_hybrid_hash_joi                                  5.00E+003
5    .    6    esp_exchange                    2(hash2):5(hash2)     1.00E+002
.    .    5    trafodion_scan                  T074T1                1.00E+002
3    .    4    esp_exchange                    2(rep-b):5(hash2)     1.00E+002
.    .    3    trafodion_scan                  T074T1                1.00E+002
1    .    2    esp_exchange                    2(rep-b):5(hash2)     1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           C1           C2           ROWNUM
-----------  -----------  -----------  -----------  -----------  -----------  --------------------

          1           20            1           20            1           20                     1
          2           19            2           19            2           19                     2
          5           16            5           16            5           16                     3
          8           13            8           13            8           13                     4
          3           18            3           18            3           18                     5
          4           17            4           17            4           17                     6
          6           15            6           15            6           15                     7
          7           14            7           14            7           14                     8
         10           11           10           11           10           11                     9
          9           12            9           12            9           12                    10

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t1 A right join t074t2 B on A.c1=B.c1;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  5.00E+003
4    .    5    sequence                                              5.00E+003
3    .    4    sort                                                  5.00E+003
2    1    3    left_hybrid_hash_joi                                  5.00E+003
.    .    2    trafodion_scan                  T074T2                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1            1                     1
          1           20            1            2                     2
          2           19            2            1                     3
          2           19            2            2                     4
          2           19            2            3                     5
          5           16            5            1                     6
          5           16            5            2                     7
          5           16            5            3                     8
          3           18            3            1                     9
          3           18            3            2                    10
          4           17            4            1                    11

--- 11 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, C.*, rownum from t074t1 A right join t074t1 B on A.c1=B.c1 right join t074t2 C on B.c1 = C.c1;

--- SQL command prepared.
>> --?
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

12   .    13   root                                                  2.50E+005
11   .    12   sequence                                              2.50E+005
10   .    11   esp_exchange                    1:2(hash2) (m)        2.50E+005
9    .    10   sort                                                  2.50E+005
8    6    9    left_hybrid_hash_joi                                  2.50E+005
7    .    8    esp_exchange                    2(hash2):5(hash2)     1.00E+002
.    .    7    trafodion_scan                  T074T2                1.00E+002
5    .    6    esp_exchange                    2(rep-b):2(hash2)     5.00E+003
4    2    5    left_hybrid_hash_joi                                  5.00E+003
3    .    4    esp_exchange                    2(hash2):5(hash2)     1.00E+002
.    .    3    trafodion_scan                  T074T1                1.00E+002
1    .    2    esp_exchange                    2(rep-b):5(hash2)     1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           C1           C2           ROWNUM
-----------  -----------  -----------  -----------  -----------  -----------  --------------------

          1           20            1           20            1            1                     1
          1           20            1           20            1            2                     2
          2           19            2           19            2            1                     3
          2           19            2           19            2            2                     4
          2           19            2           19            2            3                     5
          5           16            5           16            5            1                     6
          5           16            5           16            5            2                     7
          5           16            5           16            5            3                     8
          3           18            3           18            3            1                     9
          3           18            3           18            3            2                    10
          4           17            4           17            4            1                    11

--- 11 row(s) selected.
>>
>>--fail  ambiguous
>>prepare s1 from 
+>select A.*, B.*, rownum from t074t1 A join t074t1 B on A.c1 = B.c1 where rownum < 5;

*** ERROR[4011] Reference made to column #TAB.C1 via star (*) is ambiguous.

*** ERROR[8822] The statement was not prepared.

>>explain options 'f' s1;

*** ERROR[8804] The provided input statement does not exist in the current context.

--- SQL operation failed with errors.
>>execute s1;

*** ERROR[15017] Statement S1 was not found.

>>
>>prepare s1 from 
+>select A.c1 a_c1, A.c2 a_c2, B.c1 b_c1, B.c2 b_c2, rownum from t074t1 A join t074t1 B on A.c1 = B.c1 where rownum < 5;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

6    .    7    root                                                  1.00E+000
5    .    6    sequence                                              1.00E+000
4    .    5    firstn                                                1.00E+000
3    .    4    sort                                                  5.00E+003
2    1    3    hybrid_hash_join                                      5.00E+003
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

A_C1         A_C2         B_C1         B_C2         ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          2           19            2           19                     2
          5           16            5           16                     3
          8           13            8           13                     4

--- 4 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from ( select c1 from t074t1 order by c2 desc ) A, t074t1 B ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C1           C2           ROWNUM              
-----------  -----------  -----------  --------------------

          1            1           20                     1
          1            2           19                     2
          1            5           16                     3
          1            8           13                     4
          1            3           18                     5
          1            4           17                     6
          1            6           15                     7
          1            7           14                     8
          1           10           11                     9
          1            9           12                    10
          2            1           20                    11
          2            2           19                    12
          2            5           16                    13
          2            8           13                    14
          2            3           18                    15
          2            4           17                    16
          2            6           15                    17
          2            7           14                    18
          2           10           11                    19
          2            9           12                    20
          3            1           20                    21
          3            2           19                    22
          3            5           16                    23
          3            8           13                    24
          3            3           18                    25
          3            4           17                    26
          3            6           15                    27
          3            7           14                    28
          3           10           11                    29
          3            9           12                    30
          4            1           20                    31
          4            2           19                    32
          4            5           16                    33
          4            8           13                    34
          4            3           18                    35
          4            4           17                    36
          4            6           15                    37
          4            7           14                    38
          4           10           11                    39
          4            9           12                    40
          5            1           20                    41
          5            2           19                    42
          5            5           16                    43
          5            8           13                    44
          5            3           18                    45
          5            4           17                    46
          5            6           15                    47
          5            7           14                    48
          5           10           11                    49
          5            9           12                    50
          6            1           20                    51
          6            2           19                    52
          6            5           16                    53
          6            8           13                    54
          6            3           18                    55
          6            4           17                    56
          6            6           15                    57
          6            7           14                    58
          6           10           11                    59
          6            9           12                    60
          7            1           20                    61
          7            2           19                    62
          7            5           16                    63
          7            8           13                    64
          7            3           18                    65
          7            4           17                    66
          7            6           15                    67
          7            7           14                    68
          7           10           11                    69
          7            9           12                    70
          8            1           20                    71
          8            2           19                    72
          8            5           16                    73
          8            8           13                    74
          8            3           18                    75
          8            4           17                    76
          8            6           15                    77
          8            7           14                    78
          8           10           11                    79
          8            9           12                    80
          9            1           20                    81
          9            2           19                    82
          9            5           16                    83
          9            8           13                    84
          9            3           18                    85
          9            4           17                    86
          9            6           15                    87
          9            7           14                    88
          9           10           11                    89
          9            9           12                    90
         10            1           20                    91
         10            2           19                    92
         10            5           16                    93
         10            8           13                    94
         10            3           18                    95
         10            4           17                    96
         10            6           15                    97
         10            7           14                    98
         10           10           11                    99
         10            9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, rownum from ( select c1, c2 from t074t1 order by 2 desc) A, t074t1 B ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           ROWNUM              
-----------  -----------  -----------  -----------  --------------------

          1           20            1           20                     1
          1           20            2           19                     2
          1           20            5           16                     3
          1           20            8           13                     4
          1           20            3           18                     5
          1           20            4           17                     6
          1           20            6           15                     7
          1           20            7           14                     8
          1           20           10           11                     9
          1           20            9           12                    10
          2           19            1           20                    11
          2           19            2           19                    12
          2           19            5           16                    13
          2           19            8           13                    14
          2           19            3           18                    15
          2           19            4           17                    16
          2           19            6           15                    17
          2           19            7           14                    18
          2           19           10           11                    19
          2           19            9           12                    20
          3           18            1           20                    21
          3           18            2           19                    22
          3           18            5           16                    23
          3           18            8           13                    24
          3           18            3           18                    25
          3           18            4           17                    26
          3           18            6           15                    27
          3           18            7           14                    28
          3           18           10           11                    29
          3           18            9           12                    30
          4           17            1           20                    31
          4           17            2           19                    32
          4           17            5           16                    33
          4           17            8           13                    34
          4           17            3           18                    35
          4           17            4           17                    36
          4           17            6           15                    37
          4           17            7           14                    38
          4           17           10           11                    39
          4           17            9           12                    40
          5           16            1           20                    41
          5           16            2           19                    42
          5           16            5           16                    43
          5           16            8           13                    44
          5           16            3           18                    45
          5           16            4           17                    46
          5           16            6           15                    47
          5           16            7           14                    48
          5           16           10           11                    49
          5           16            9           12                    50
          6           15            1           20                    51
          6           15            2           19                    52
          6           15            5           16                    53
          6           15            8           13                    54
          6           15            3           18                    55
          6           15            4           17                    56
          6           15            6           15                    57
          6           15            7           14                    58
          6           15           10           11                    59
          6           15            9           12                    60
          7           14            1           20                    61
          7           14            2           19                    62
          7           14            5           16                    63
          7           14            8           13                    64
          7           14            3           18                    65
          7           14            4           17                    66
          7           14            6           15                    67
          7           14            7           14                    68
          7           14           10           11                    69
          7           14            9           12                    70
          8           13            1           20                    71
          8           13            2           19                    72
          8           13            5           16                    73
          8           13            8           13                    74
          8           13            3           18                    75
          8           13            4           17                    76
          8           13            6           15                    77
          8           13            7           14                    78
          8           13           10           11                    79
          8           13            9           12                    80
          9           12            1           20                    81
          9           12            2           19                    82
          9           12            5           16                    83
          9           12            8           13                    84
          9           12            3           18                    85
          9           12            4           17                    86
          9           12            6           15                    87
          9           12            7           14                    88
          9           12           10           11                    89
          9           12            9           12                    90
         10           11            1           20                    91
         10           11            2           19                    92
         10           11            5           16                    93
         10           11            8           13                    94
         10           11            3           18                    95
         10           11            4           17                    96
         10           11            6           15                    97
         10           11            7           14                    98
         10           11           10           11                    99
         10           11            9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select A.*, B.*, C.*, rownum from ( select c1, c2 from t074t1 order by 2 ) A join t074t2 B on A.c1=B.c1 join t074t2 C on B.c1=C.c1;

--- SQL command prepared.
>> --? order by 2 is not working in Oracle
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

11   .    12   root                                                  2.50E+005
10   .    11   sequence                                              2.50E+005
9    .    10   esp_exchange                    1:2(hash2) (m)        2.50E+005
8    .    9    sort                                                  2.50E+005
7    2    8    hybrid_hash_join                                      2.50E+005
6    4    7    hybrid_hash_join                                      5.00E+003
5    .    6    esp_exchange                    2(hash2):5(hash2)     1.00E+002
.    .    5    trafodion_scan                  T074T2                1.00E+002
3    .    4    esp_exchange                    2(rep-b):5(hash2)     1.00E+002
.    .    3    trafodion_scan                  T074T2                1.00E+002
1    .    2    esp_exchange                    2(rep-b):5(hash2)     1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           C1           C2           ROWNUM
-----------  -----------  -----------  -----------  -----------  -----------  --------------------

          5           16            5            1            5            1                     1
          5           16            5            1            5            2                     2
          5           16            5            1            5            3                     3
          5           16            5            2            5            1                     4
          5           16            5            2            5            2                     5
          5           16            5            2            5            3                     6
          5           16            5            3            5            1                     7
          5           16            5            3            5            2                     8
          5           16            5            3            5            3                     9
          4           17            4            1            4            1                    10
          3           18            3            1            3            1                    11
          3           18            3            1            3            2                    12
          3           18            3            2            3            1                    13
          3           18            3            2            3            2                    14
          2           19            2            1            2            1                    15
          2           19            2            1            2            2                    16
          2           19            2            1            2            3                    17
          2           19            2            2            2            1                    18
          2           19            2            2            2            2                    19
          2           19            2            2            2            3                    20
          2           19            2            3            2            1                    21
          2           19            2            3            2            2                    22
          2           19            2            3            2            3                    23
          1           20            1            1            1            1                    24
          1           20            1            1            1            2                    25
          1           20            1            2            1            1                    26
          1           20            1            2            1            2                    27

--- 27 row(s) selected.
>>
>>prepare s1 from 
+>select A.*,B.*,C.*, rownum from ( select c1, c2 from t074t1 order by 2 ) A join t074t2 B on A.c1=B.c1 right join t074t2 C on B.c1=C.c1 order by A.c1, B.c2, C.c2;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

15   .    16   root                                                  2.50E+005
14   .    15   esp_exchange                    1:2(hash2) (m)        2.50E+005
13   .    14   sort                                                  2.50E+005
12   .    13   esp_exchange                    2(hash2):1 (m)        2.50E+005
11   .    12   sequence                                              2.50E+005
10   .    11   esp_exchange                    1:2(hash2) (m)        2.50E+005
9    .    10   sort                                                  2.50E+005
8    6    9    left_hybrid_hash_joi                                  2.50E+005
7    .    8    esp_exchange                    2(hash2):5(hash2)     1.00E+002
.    .    7    trafodion_scan                  T074T2                1.00E+002
5    .    6    esp_exchange                    2(rep-b):2(hash2)     5.00E+003
4    2    5    hybrid_hash_join                                      5.00E+003
3    .    4    esp_exchange                    2(hash2):5(hash2)     1.00E+002
.    .    3    trafodion_scan                  T074T1                1.00E+002
1    .    2    esp_exchange                    2(rep-b):5(hash2)     1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           C1           C2           C1           C2           ROWNUM
-----------  -----------  -----------  -----------  -----------  -----------  --------------------

          1           20            1            1            1            1                    24
          1           20            1            1            1            2                    25
          1           20            1            2            1            1                    26
          1           20            1            2            1            2                    27
          2           19            2            1            2            1                    15
          2           19            2            1            2            2                    16
          2           19            2            1            2            3                    17
          2           19            2            2            2            1                    18
          2           19            2            2            2            2                    19
          2           19            2            2            2            3                    20
          2           19            2            3            2            1                    21
          2           19            2            3            2            2                    22
          2           19            2            3            2            3                    23
          3           18            3            1            3            1                    11
          3           18            3            1            3            2                    12
          3           18            3            2            3            1                    13
          3           18            3            2            3            2                    14
          4           17            4            1            4            1                    10
          5           16            5            1            5            1                     1
          5           16            5            1            5            2                     2
          5           16            5            1            5            3                     3
          5           16            5            2            5            1                     4
          5           16            5            2            5            2                     5
          5           16            5            2            5            3                     6
          5           16            5            3            5            1                     7
          5           16            5            3            5            2                     8
          5           16            5            3            5            3                     9

--- 27 row(s) selected.
>>
>>prepare s1 from 
+>select T.*, rownum from ( select A.c1, B.c2 from t074t1 A, t074t1 B order by A.c2, B.c2 ) T ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           ROWNUM              
-----------  -----------  --------------------

         10           11                     1
         10           12                     2
         10           13                     3
         10           14                     4
         10           15                     5
         10           16                     6
         10           17                     7
         10           18                     8
         10           19                     9
         10           20                    10
          9           11                    11
          9           12                    12
          9           13                    13
          9           14                    14
          9           15                    15
          9           16                    16
          9           17                    17
          9           18                    18
          9           19                    19
          9           20                    20
          8           11                    21
          8           12                    22
          8           13                    23
          8           14                    24
          8           15                    25
          8           16                    26
          8           17                    27
          8           18                    28
          8           19                    29
          8           20                    30
          7           11                    31
          7           12                    32
          7           13                    33
          7           14                    34
          7           15                    35
          7           16                    36
          7           17                    37
          7           18                    38
          7           19                    39
          7           20                    40
          6           11                    41
          6           12                    42
          6           13                    43
          6           14                    44
          6           15                    45
          6           16                    46
          6           17                    47
          6           18                    48
          6           19                    49
          6           20                    50
          5           11                    51
          5           12                    52
          5           13                    53
          5           14                    54
          5           15                    55
          5           16                    56
          5           17                    57
          5           18                    58
          5           19                    59
          5           20                    60
          4           11                    61
          4           12                    62
          4           13                    63
          4           14                    64
          4           15                    65
          4           16                    66
          4           17                    67
          4           18                    68
          4           19                    69
          4           20                    70
          3           11                    71
          3           12                    72
          3           13                    73
          3           14                    74
          3           15                    75
          3           16                    76
          3           17                    77
          3           18                    78
          3           19                    79
          3           20                    80
          2           11                    81
          2           12                    82
          2           13                    83
          2           14                    84
          2           15                    85
          2           16                    86
          2           17                    87
          2           18                    88
          2           19                    89
          2           20                    90
          1           11                    91
          1           12                    92
          1           13                    93
          1           14                    94
          1           15                    95
          1           16                    96
          1           17                    97
          1           18                    98
          1           19                    99
          1           20                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select T.*, rownum from ( select A.c1, B.c2 from t074t1 A, t074t1 B ) T ;

--- SQL command prepared.
>> --?
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           ROWNUM              
-----------  -----------  --------------------

          1           20                     1
          1           19                     2
          1           16                     3
          1           13                     4
          1           18                     5
          1           17                     6
          1           15                     7
          1           14                     8
          1           11                     9
          1           12                    10
          2           20                    11
          2           19                    12
          2           16                    13
          2           13                    14
          2           18                    15
          2           17                    16
          2           15                    17
          2           14                    18
          2           11                    19
          2           12                    20
          5           20                    21
          5           19                    22
          5           16                    23
          5           13                    24
          5           18                    25
          5           17                    26
          5           15                    27
          5           14                    28
          5           11                    29
          5           12                    30
          8           20                    31
          8           19                    32
          8           16                    33
          8           13                    34
          8           18                    35
          8           17                    36
          8           15                    37
          8           14                    38
          8           11                    39
          8           12                    40
          3           20                    41
          3           19                    42
          3           16                    43
          3           13                    44
          3           18                    45
          3           17                    46
          3           15                    47
          3           14                    48
          3           11                    49
          3           12                    50
          4           20                    51
          4           19                    52
          4           16                    53
          4           13                    54
          4           18                    55
          4           17                    56
          4           15                    57
          4           14                    58
          4           11                    59
          4           12                    60
          6           20                    61
          6           19                    62
          6           16                    63
          6           13                    64
          6           18                    65
          6           17                    66
          6           15                    67
          6           14                    68
          6           11                    69
          6           12                    70
          7           20                    71
          7           19                    72
          7           16                    73
          7           13                    74
          7           18                    75
          7           17                    76
          7           15                    77
          7           14                    78
          7           11                    79
          7           12                    80
         10           20                    81
         10           19                    82
         10           16                    83
         10           13                    84
         10           18                    85
         10           17                    86
         10           15                    87
         10           14                    88
         10           11                    89
         10           12                    90
          9           20                    91
          9           19                    92
          9           16                    93
          9           13                    94
          9           18                    95
          9           17                    96
          9           15                    97
          9           14                    98
          9           11                    99
          9           12                   100

--- 100 row(s) selected.
>>
>>prepare s1 from 
+>select T.*, rownum from ( select A.c1, B.c2 from t074t2 A, t074t1 B ) T ;

--- SQL command prepared.
>> --?
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           ROWNUM              
-----------  -----------  --------------------

          1           20                     1
          1           19                     2
          1           16                     3
          1           13                     4
          1           18                     5
          1           17                     6
          1           15                     7
          1           14                     8
          1           11                     9
          1           12                    10
          1           20                    11
          1           19                    12
          1           16                    13
          1           13                    14
          1           18                    15
          1           17                    16
          1           15                    17
          1           14                    18
          1           11                    19
          1           12                    20
          2           20                    21
          2           19                    22
          2           16                    23
          2           13                    24
          2           18                    25
          2           17                    26
          2           15                    27
          2           14                    28
          2           11                    29
          2           12                    30
          2           20                    31
          2           19                    32
          2           16                    33
          2           13                    34
          2           18                    35
          2           17                    36
          2           15                    37
          2           14                    38
          2           11                    39
          2           12                    40
          2           20                    41
          2           19                    42
          2           16                    43
          2           13                    44
          2           18                    45
          2           17                    46
          2           15                    47
          2           14                    48
          2           11                    49
          2           12                    50
          3           20                    51
          3           19                    52
          3           16                    53
          3           13                    54
          3           18                    55
          3           17                    56
          3           15                    57
          3           14                    58
          3           11                    59
          3           12                    60
          3           20                    61
          3           19                    62
          3           16                    63
          3           13                    64
          3           18                    65
          3           17                    66
          3           15                    67
          3           14                    68
          3           11                    69
          3           12                    70
          4           20                    71
          4           19                    72
          4           16                    73
          4           13                    74
          4           18                    75
          4           17                    76
          4           15                    77
          4           14                    78
          4           11                    79
          4           12                    80
          5           20                    81
          5           19                    82
          5           16                    83
          5           13                    84
          5           18                    85
          5           17                    86
          5           15                    87
          5           14                    88
          5           11                    89
          5           12                    90
          5           20                    91
          5           19                    92
          5           16                    93
          5           13                    94
          5           18                    95
          5           17                    96
          5           15                    97
          5           14                    98
          5           11                    99
          5           12                   100
          5           20                   101
          5           19                   102
          5           16                   103
          5           13                   104
          5           18                   105
          5           17                   106
          5           15                   107
          5           14                   108
          5           11                   109
          5           12                   110

--- 110 row(s) selected.
>>
>>prepare s1 from 
+>select T.*, rownum from ( select A.c1, B.c2 from t074t1 A, t074t2 B ) T ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T1                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           ROWNUM              
-----------  -----------  --------------------

          1            1                     1
          1            2                     2
          1            1                     3
          1            2                     4
          1            3                     5
          1            1                     6
          1            2                     7
          1            1                     8
          1            1                     9
          1            2                    10
          1            3                    11
          2            1                    12
          2            2                    13
          2            1                    14
          2            2                    15
          2            3                    16
          2            1                    17
          2            2                    18
          2            1                    19
          2            1                    20
          2            2                    21
          2            3                    22
          5            1                    23
          5            2                    24
          5            1                    25
          5            2                    26
          5            3                    27
          5            1                    28
          5            2                    29
          5            1                    30
          5            1                    31
          5            2                    32
          5            3                    33
          8            1                    34
          8            2                    35
          8            1                    36
          8            2                    37
          8            3                    38
          8            1                    39
          8            2                    40
          8            1                    41
          8            1                    42
          8            2                    43
          8            3                    44
          3            1                    45
          3            2                    46
          3            1                    47
          3            2                    48
          3            3                    49
          3            1                    50
          3            2                    51
          3            1                    52
          3            1                    53
          3            2                    54
          3            3                    55
          4            1                    56
          4            2                    57
          4            1                    58
          4            2                    59
          4            3                    60
          4            1                    61
          4            2                    62
          4            1                    63
          4            1                    64
          4            2                    65
          4            3                    66
          6            1                    67
          6            2                    68
          6            1                    69
          6            2                    70
          6            3                    71
          6            1                    72
          6            2                    73
          6            1                    74
          6            1                    75
          6            2                    76
          6            3                    77
          7            1                    78
          7            2                    79
          7            1                    80
          7            2                    81
          7            3                    82
          7            1                    83
          7            2                    84
          7            1                    85
          7            1                    86
          7            2                    87
          7            3                    88
         10            1                    89
         10            2                    90
         10            1                    91
         10            2                    92
         10            3                    93
         10            1                    94
         10            2                    95
         10            1                    96
         10            1                    97
         10            2                    98
         10            3                    99
          9            1                   100
          9            2                   101
          9            1                   102
          9            2                   103
          9            3                   104
          9            1                   105
          9            2                   106
          9            1                   107
          9            1                   108
          9            2                   109
          9            3                   110

--- 110 row(s) selected.
>>
>>prepare s1 from 
+>select T.*, rownum from ( select A.c1, B.c2 from t074t2 A, t074t2 B ) T ;

--- SQL command prepared.
>> --ok
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

5    .    6    root                                                  1.00E+004
4    .    5    sequence                                              1.00E+004
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T2                1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           ROWNUM              
-----------  -----------  --------------------

          1            1                     1
          1            2                     2
          1            1                     3
          1            2                     4
          1            3                     5
          1            1                     6
          1            2                     7
          1            1                     8
          1            1                     9
          1            2                    10
          1            3                    11
          1            1                    12
          1            2                    13
          1            1                    14
          1            2                    15
          1            3                    16
          1            1                    17
          1            2                    18
          1            1                    19
          1            1                    20
          1            2                    21
          1            3                    22
          2            1                    23
          2            2                    24
          2            1                    25
          2            2                    26
          2            3                    27
          2            1                    28
          2            2                    29
          2            1                    30
          2            1                    31
          2            2                    32
          2            3                    33
          2            1                    34
          2            2                    35
          2            1                    36
          2            2                    37
          2            3                    38
          2            1                    39
          2            2                    40
          2            1                    41
          2            1                    42
          2            2                    43
          2            3                    44
          2            1                    45
          2            2                    46
          2            1                    47
          2            2                    48
          2            3                    49
          2            1                    50
          2            2                    51
          2            1                    52
          2            1                    53
          2            2                    54
          2            3                    55
          3            1                    56
          3            2                    57
          3            1                    58
          3            2                    59
          3            3                    60
          3            1                    61
          3            2                    62
          3            1                    63
          3            1                    64
          3            2                    65
          3            3                    66
          3            1                    67
          3            2                    68
          3            1                    69
          3            2                    70
          3            3                    71
          3            1                    72
          3            2                    73
          3            1                    74
          3            1                    75
          3            2                    76
          3            3                    77
          4            1                    78
          4            2                    79
          4            1                    80
          4            2                    81
          4            3                    82
          4            1                    83
          4            2                    84
          4            1                    85
          4            1                    86
          4            2                    87
          4            3                    88
          5            1                    89
          5            2                    90
          5            1                    91
          5            2                    92
          5            3                    93
          5            1                    94
          5            2                    95
          5            1                    96
          5            1                    97
          5            2                    98
          5            3                    99
          5            1                   100
          5            2                   101
          5            1                   102
          5            2                   103
          5            3                   104
          5            1                   105
          5            2                   106
          5            1                   107
          5            1                   108
          5            2                   109
          5            3                   110
          5            1                   111
          5            2                   112
          5            1                   113
          5            2                   114
          5            3                   115
          5            1                   116
          5            2                   117
          5            1                   118
          5            1                   119
          5            2                   120
          5            3                   121

--- 121 row(s) selected.
>>
>>prepare s1 from
+>select T.*, rownum from (select A.c1 A_C1, B.c2 from t074t2 A, t074t1 B order by A_C1, 2, A.c2) T where rownum < 30;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

6    .    7    root                                                  1.00E+000
5    .    6    sequence                                              1.00E+000
4    .    5    firstn                                                1.00E+000
3    .    4    sort                                                  1.00E+004
2    1    3    hybrid_hash_join                                      1.00E+004
.    .    2    trafodion_scan                  T074T2                1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

A_C1         C2           ROWNUM              
-----------  -----------  --------------------

          1           11                     1
          1           11                     2
          1           12                     3
          1           12                     4
          1           13                     5
          1           13                     6
          1           14                     7
          1           14                     8
          1           15                     9
          1           15                    10
          1           16                    11
          1           16                    12
          1           17                    13
          1           17                    14
          1           18                    15
          1           18                    16
          1           19                    17
          1           19                    18
          1           20                    19
          1           20                    20
          2           11                    21
          2           11                    22
          2           11                    23
          2           12                    24
          2           12                    25
          2           12                    26
          2           13                    27
          2           13                    28
          2           13                    29

--- 29 row(s) selected.
>>
>>
>>
>>obey TEST074(complex_expr);
>>--------------------------------------------------------------------------
>>
>>
>>
>>prepare s1 from
+>SELECT  1+1+1+1+1+rownum from t074t1 ;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)              
--------------------

                   6
                   7
                   8
                   9
                  10
                  11
                  12
                  13
                  14
                  15

--- 10 row(s) selected.
>>
>>prepare s1 from
+>select abs(rownum) from t074t1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)              
--------------------

                   1
                   2
                   3
                   4
                   5
                   6
                   7
                   8
                   9
                  10

--- 10 row(s) selected.
>>
>>prepare s1 from
+>select COS(rownum) from t074t1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)                   
-------------------------

 5.40302305868139776E-001
-4.16146836547142400E-001
-9.89992496600445312E-001
-6.53643620863611904E-001
 2.83662185463226240E-001
 9.60170286650365952E-001
 7.53902254343304576E-001
-1.45500033808613536E-001
-9.11130261884676992E-001
-8.39071529076452352E-001

--- 10 row(s) selected.
>>
>>prepare s1 from
+>select c1, MOD(CAST(POWER(rownum,2) AS DECIMAL(10,0)), 10) from t074t1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           (EXPR)
-----------  ------

          1       1
          2       4
          5       9
          8       6
          3       5
          4       6
          6       9
          7       4
         10       1
          9       0

--- 10 row(s) selected.
>>
>>prepare s1 from
+>select ROUND(POWER(rownum,2), -1) from t074t1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)                   
-------------------------

 0.00000000000000000E+000
 0.00000000000000000E+000
 1.00000000000000000E+001
 2.00000000000000000E+001
 3.00000000000000000E+001
 4.00000000000000000E+001
 5.00000000000000000E+001
 6.00000000000000000E+001
 8.00000000000000000E+001
 1.00000000000000000E+002

--- 10 row(s) selected.
>>
>>prepare s1 from
+>select ROUND(POWER(rownum,2), -1) from t074t1 where rownum < 6;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)                   
-------------------------

 0.00000000000000000E+000
 0.00000000000000000E+000
 1.00000000000000000E+001
 2.00000000000000000E+001
 3.00000000000000000E+001

--- 5 row(s) selected.
>>
>>prepare s1 from
+>select rownum + 1, rownum + 2, 3+rownum, 4*rownum from t074t1;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)                (EXPR)                (EXPR)                (EXPR)
--------------------  --------------------  --------------------  --------------------

                   2                     3                     4                     4
                   3                     4                     5                     8
                   4                     5                     6                    12
                   5                     6                     7                    16
                   6                     7                     8                    20
                   7                     8                     9                    24
                   8                     9                    10                    28
                   9                    10                    11                    32
                  10                    11                    12                    36
                  11                    12                    13                    40

--- 10 row(s) selected.
>>
>>prepare s1 from
+>select rownum + 1, ROUND(POWER(rownum,2), -1), rownum + 2, 3+rownum, 4*rownum from t074t1 where rownum < 6;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)                (EXPR)                     (EXPR)                (EXPR)                (EXPR)
--------------------  -------------------------  --------------------  --------------------  --------------------

                   2   0.00000000000000000E+000                     3                     4                     4
                   3   0.00000000000000000E+000                     4                     5                     8
                   4   1.00000000000000000E+001                     5                     6                    12
                   5   2.00000000000000000E+001                     6                     7                    16
                   6   3.00000000000000000E+001                     7                     8                    20

--- 5 row(s) selected.
>>
>>prepare s1 from
+>select ROUND(POWER(rownum,2), -1) as RN_TEST from t074t1 where rownum - 3 < 6;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  3.40E+001
2    .    3    sequence                                              3.40E+001
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

RN_TEST                  
-------------------------

 0.00000000000000000E+000
 0.00000000000000000E+000
 1.00000000000000000E+001
 2.00000000000000000E+001
 3.00000000000000000E+001
 4.00000000000000000E+001
 5.00000000000000000E+001
 6.00000000000000000E+001

--- 8 row(s) selected.
>>
>>prepare s1 from
+>select ROUND(POWER(rownum,2), -1) as RN_TEST from t074t1 where rownum - 3 < rownum - 2;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  3.40E+001
2    .    3    sequence                                              3.40E+001
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

RN_TEST                  
-------------------------

 0.00000000000000000E+000
 0.00000000000000000E+000
 1.00000000000000000E+001
 2.00000000000000000E+001
 3.00000000000000000E+001
 4.00000000000000000E+001
 5.00000000000000000E+001
 6.00000000000000000E+001
 8.00000000000000000E+001
 1.00000000000000000E+002

--- 10 row(s) selected.
>>
>>
>>--fail
>>prepare s1 from
+>select sum(rownum) from t074t1;

*** ERROR[4375] Window or Sequence function COUNT nested within an aggregate function in the same scope is not supported.

*** ERROR[8822] The statement was not prepared.

>>explain options 'f' s1;

*** ERROR[8804] The provided input statement does not exist in the current context.

--- SQL operation failed with errors.
>>execute s1;

*** ERROR[15017] Statement S1 was not found.

>>
>>--fail
>>prepare s1 from
+>select sum(rownum) from (select rownum from t074t1);

*** ERROR[4375] Window or Sequence function COUNT nested within an aggregate function in the same scope is not supported.

*** ERROR[8822] The statement was not prepared.

>>explain options 'f' s1;

*** ERROR[8804] The provided input statement does not exist in the current context.

--- SQL operation failed with errors.
>>execute s1;

*** ERROR[15017] Statement S1 was not found.

>>
>>--fail
>>prepare s1 from
+>select sum(rn) from (select rownum as rn from t074t1);

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+000
3    .    4    sort_scalar_aggr                                      1.00E+000
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)              
--------------------

                  55

--- 1 row(s) selected.
>>
>>--fail
>>prepare s1 from
+>select avg(rownum) from t074t1;

*** ERROR[4375] Window or Sequence function COUNT nested within an aggregate function in the same scope is not supported.

*** ERROR[8822] The statement was not prepared.

>>explain options 'f' s1;

*** ERROR[8804] The provided input statement does not exist in the current context.

--- SQL operation failed with errors.
>>execute s1;

*** ERROR[15017] Statement S1 was not found.

>>
>>--fail
>>prepare s1 from
+>SELECT rownum, c1, c2, SUM (c1) over(ORDER BY C2) AS olap_sum FROM t074t2;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T2                1.00E+002

--- SQL operation complete.
>>execute s1;

(EXPR)                C1           C2           OLAP_SUM            
--------------------  -----------  -----------  --------------------

                   1            1            1                     1
                   2            3            1                     4
                   3            5            1                     9
                   4            4            1                    13
                   5            2            1                    15
                   6            3            2                    18
                   7            5            2                    23
                   8            2            2                    25
                   9            1            2                    26
                  10            5            3                    31
                  11            2            3                    33

--- 11 row(s) selected.
>>
>>
>>
>>
>>obey TEST074(error_ambiguous);
>>--------------------------------------------------------------------------
>>
>>prepare s1 from 
+>select c1, rownum, rownum from t074t1 ;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sequence                                              1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM                ROWNUM              
-----------  --------------------  --------------------

          1                     1                     1
          2                     2                     2
          5                     3                     3
          8                     4                     4
          3                     5                     5
          4                     6                     6
          6                     7                     7
          7                     8                     8
         10                     9                     9
          9                    10                    10

--- 10 row(s) selected.
>>
>>prepare s1 from 
+>select c1, rownum, rownum from t074t2 where rownum <= 5;

*** ERROR[4004] Column name #TAB."ROWNUM" is ambiguous.  Tables in scope: TRAFODION.T074SCH_ROWNUM.#TAB.  Default schema: TRAFODION.T074SCH_ROWNUM.

*** ERROR[8822] The statement was not prepared.

>>explain options 'f' s1;

*** ERROR[8804] The provided input statement does not exist in the current context.

--- SQL operation failed with errors.
>>execute s1;

*** ERROR[15017] Statement S1 was not found.

>>
>>prepare s1 from 
+>select *, rownum from (select c1, rownum, rownum, rownum from t074t2);

*** ERROR[4011] Reference made to column #TAB."ROWNUM" via star (*) is ambiguous.

*** ERROR[8822] The statement was not prepared.

>>explain options 'f' s1;

*** ERROR[8804] The provided input statement does not exist in the current context.

--- SQL operation failed with errors.
>>execute s1;

*** ERROR[15017] Statement S1 was not found.

>>
>>
>>
>>
>>obey TEST074(error_order);
>>--------------------------------------------------------------------------
>>
>>-- Order Issue : can't get order of table yet in sub-sub-query
>>-- Oracle result :
>>--        C1         C2        NUM
>>------------ ---------- ----------
>>--         1         20          1
>>--         2         19          2
>>--         3         18          5
>>--         4         17          6
>>--         5         16          3
>>--         6         15          7
>>--         7         14          8
>>--         8         13          4
>>--         9         12         10
>>--        10         11          9
>>prepare s1 from 
+>select c1,c2, rownum num from (select * from (select * from t074t1)) order by c2 desc;

--- SQL command prepared.
>> --not sort before sequence
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sort                                                  1.00E+002
1    .    2    sequence                                              1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           NUM                 
-----------  -----------  --------------------

          1           20                     4
          2           19                     1
          3           18                     8
          4           17                     2
          5           16                     9
          6           15                     7
          7           14                    10
          8           13                     5
          9           12                     6
         10           11                     3

--- 10 row(s) selected.
>>
>>
>>-- Order Issue : order-by clause in sub-query is omitted by SQL engine
>>-- Oracle result :
>>--        C1         C2        NUM
>>------------ ---------- ----------
>>--         3         18          5
>>--         4         17          6
>>--         6         15          7
>>--         7         14          8
>>--         8         13          4
>>--         9         12         10
>>--        10         11          9
>>prepare s1 from 
+>select c1,c2, tt.num from (select c1,c2, rownum num from t074t1 order by c2 desc) tt where tt.num >3;

--- SQL command prepared.
>>--order by c2 is ommitted by sub-query
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  3.40E+001
2    .    3    sequence                                              3.40E+001
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           NUM                 
-----------  -----------  --------------------

          8           13                     4
          3           18                     5
          4           17                     6
          6           15                     7
          7           14                     8
         10           11                     9
          9           12                    10

--- 7 row(s) selected.
>>
>>
>>-- Order Issue : order-by clause in sub-query is omitted by SQL engine
>>-- Oracle result :
>>--        C1        NUM
>>------------ ----------
>>--         8          4
>>--         7          8
>>--         6          7
>>--         4          6
>>--         3          5
>>prepare s1 from 
+>select c1, tt.num from (select c1, rownum num from t074t1 where rownum <=8 order by c2) tt where tt.num >3;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

4    .    5    root                                                  1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           NUM                 
-----------  --------------------

          8                     4
          3                     5
          4                     6
          6                     7
          7                     8

--- 5 row(s) selected.
>>
>>
>>-- Order Issue : 1. order of table in sub-sub-query; 2. order-by clause in sub-query is omitted by SQL engine
>>-- Oracle result :
>>--        C1         C2        NUM
>>------------ ---------- ----------
>>--         3         18          5
>>--         4         17          6
>>--         6         15          7
>>--         7         14          8
>>--         8         13          4
>>--         9         12         10
>>--        10         11          9
>>prepare s1 from 
+>select c1,c2, tt.num from (select c1,c2, rownum num from (select * from (select * from t074t1)) order by c2 desc) tt where tt.num >3;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

2    .    3    root                                                  3.40E+001
1    .    2    sequence                                              3.40E+001
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           C2           NUM                 
-----------  -----------  --------------------

          1           20                     4
          8           13                     5
          9           12                     6
          6           15                     7
          3           18                     8
          5           16                     9
          7           14                    10

--- 7 row(s) selected.
>>
>>
>>
>>obey TEST074(error_other);
>>--------------------------------------------------------------------------
>>
>>prepare s1 from 
+>select c1, rownum from --rownum outside is not a reference to inner rownum
+>(
+>    select c1, rownum from t074t1 where rownum <= 10  
+>)
+>where rownum <= 9
+>;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

6    .    7    root                                                  1.00E+000
5    .    6    sequence                                              1.00E+000
4    .    5    firstn                                                1.00E+000
3    .    4    sequence                                              1.00E+000
2    .    3    firstn                                                1.00E+000
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T1                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM              
-----------  --------------------

          1                     1
          2                     2
          5                     3
          8                     4
          3                     5
          4                     6
          6                     7
          7                     8
         10                     9

--- 9 row(s) selected.
>>
>>create table t_fail(rownum int);

*** ERROR[15001] A syntax error occurred at or before:
create table t_fail(rownum int);
                         ^ (26 characters from start of SQL statement)

*** ERROR[8822] The statement was not prepared.

>>
>>prepare s1 from
+>select rownum , "ROWNUM", "rownum" from t074t4 order by 2;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sort                                                  1.00E+002
1    .    2    sequence                                              1.00E+002
.    .    1    trafodion_scan                  T074T4                1.00E+002

--- SQL operation complete.
>>execute s1;

ROWNUM                ROWNUM                          rownum
--------------------  ------------------------------  ------------------------------

                   1  ROWNUM UPPER 01                 rownum lower 21               
                   2  ROWNUM UPPER 02                 rownum lower 22               
                   3  ROWNUM UPPER 03                 rownum lower 23               
                   4  ROWNUM UPPER 04                 rownum lower 24               
                   5  ROWNUM UPPER 05                 rownum lower 25               
                   6  ROWNUM UPPER 06                 rownum lower 26               
                   7  ROWNUM UPPER 07                 rownum lower 27               
                   8  ROWNUM UPPER 08                 rownum lower 28               
                   9  ROWNUM UPPER 09                 rownum lower 29               
                  10  ROWNUM UPPER 10                 rownum lower 20               
                  11  ROWNUM UPPER 11                 rownum lower 21               

--- 11 row(s) selected.
>>
>>prepare s1 from 
+>select * from t074t4_v;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

3    .    4    root                                                  1.00E+002
2    .    3    sort                                                  1.00E+002
1    .    2    sequence                                              1.00E+002
.    .    1    trafodion_scan                  T074T4                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM_UPPER                    ROWNUM_LOWER                    ROWNUM
-----------  ------------------------------  ------------------------------  --------------------

          2  ROWNUM UPPER 01                 rownum lower 21                                    1
          5  ROWNUM UPPER 02                 rownum lower 22                                    2
          1  ROWNUM UPPER 03                 rownum lower 23                                    3
          3  ROWNUM UPPER 04                 rownum lower 24                                    4
          1  ROWNUM UPPER 05                 rownum lower 25                                    5
          3  ROWNUM UPPER 06                 rownum lower 26                                    6
          4  ROWNUM UPPER 07                 rownum lower 27                                    7
          5  ROWNUM UPPER 08                 rownum lower 28                                    8
          2  ROWNUM UPPER 09                 rownum lower 29                                    9
          5  ROWNUM UPPER 10                 rownum lower 20                                   10
          2  ROWNUM UPPER 11                 rownum lower 21                                   11

--- 11 row(s) selected.
>>
>>cqd mode_compatible_1 'off';

--- SQL operation complete.
>>
>>prepare s1 from
+>select rownum , "ROWNUM", "rownum" from t074t4 order by 2;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

2    .    3    root                                                  1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T4                1.00E+002

--- SQL operation complete.
>>execute s1;

ROWNUM                          ROWNUM                          rownum
------------------------------  ------------------------------  ------------------------------

ROWNUM UPPER 01                 ROWNUM UPPER 01                 rownum lower 21               
ROWNUM UPPER 02                 ROWNUM UPPER 02                 rownum lower 22               
ROWNUM UPPER 03                 ROWNUM UPPER 03                 rownum lower 23               
ROWNUM UPPER 04                 ROWNUM UPPER 04                 rownum lower 24               
ROWNUM UPPER 05                 ROWNUM UPPER 05                 rownum lower 25               
ROWNUM UPPER 06                 ROWNUM UPPER 06                 rownum lower 26               
ROWNUM UPPER 07                 ROWNUM UPPER 07                 rownum lower 27               
ROWNUM UPPER 08                 ROWNUM UPPER 08                 rownum lower 28               
ROWNUM UPPER 09                 ROWNUM UPPER 09                 rownum lower 29               
ROWNUM UPPER 10                 ROWNUM UPPER 10                 rownum lower 20               
ROWNUM UPPER 11                 ROWNUM UPPER 11                 rownum lower 21               

--- 11 row(s) selected.
>>
>>prepare s1 from 
+>select * from t074t4_v;

--- SQL command prepared.
>>explain options 'f' s1;

LC   RC   OP   OPERATOR              OPT       DESCRIPTION           CARD
---- ---- ---- --------------------  --------  --------------------  ---------

2    .    3    root                                                  1.00E+002
1    .    2    sort                                                  1.00E+002
.    .    1    trafodion_scan                  T074T4                1.00E+002

--- SQL operation complete.
>>execute s1;

C1           ROWNUM_UPPER                    ROWNUM_LOWER                    ROWNUM
-----------  ------------------------------  ------------------------------  ------------------------------

          2  ROWNUM UPPER 01                 rownum lower 21                 ROWNUM UPPER 01               
          5  ROWNUM UPPER 02                 rownum lower 22                 ROWNUM UPPER 02               
          1  ROWNUM UPPER 03                 rownum lower 23                 ROWNUM UPPER 03               
          3  ROWNUM UPPER 04                 rownum lower 24                 ROWNUM UPPER 04               
          1  ROWNUM UPPER 05                 rownum lower 25                 ROWNUM UPPER 05               
          3  ROWNUM UPPER 06                 rownum lower 26                 ROWNUM UPPER 06               
          4  ROWNUM UPPER 07                 rownum lower 27                 ROWNUM UPPER 07               
          5  ROWNUM UPPER 08                 rownum lower 28                 ROWNUM UPPER 08               
          2  ROWNUM UPPER 09                 rownum lower 29                 ROWNUM UPPER 09               
          5  ROWNUM UPPER 10                 rownum lower 20                 ROWNUM UPPER 10               
          2  ROWNUM UPPER 11                 rownum lower 21                 ROWNUM UPPER 11               

--- 11 row(s) selected.
>>
>>cqd mode_compatible_1 'on';

--- SQL operation complete.
>>
>>
>>
>>obey TEST074(m18148);
>>--------------------------------------------------------------------------
>>
>>drop table IF EXISTS m18148;

--- SQL operation complete.
>>CREATE TABLE m18148(c1 INT,c2 varchar(100));

--- SQL operation complete.
>>INSERT INTO m18148 values(1,'abc');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(2,'bcd');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(3,'cde');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(4,'def');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(5,'efg');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(6,'fgh');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(7,'ghi');

--- 1 row(s) inserted.
>>INSERT INTO m18148 values(8,'hij');

--- 1 row(s) inserted.
>>
>>--use rownum with group by
>>SELECT
+>    *
+>FROM
+>    (
+>        SELECT
+>            c1
+>            , c2
+>            , ROWNUM AS RN
+>        FROM
+>            m18148 T
+>        GROUP BY
+>            c1
+>            , c2 ) M
+>WHERE
+>    M.RN < 5;

C1           C2                                                                                                    RN
-----------  ----------------------------------------------------------------------------------------------------  --------------------

          1  abc                                                                                                                      1
          2  bcd                                                                                                                      2
          3  cde                                                                                                                      3
          4  def                                                                                                                      4

--- 4 row(s) selected.
>>
>>--with condition inside sub-query
>>SELECT
+>    *
+>FROM
+>    (
+>        SELECT
+>            c1
+>            , c2
+>            , row_number() over() AS RN
+>        FROM
+>            m18148 T
+>			where c1 = 7 or c1 = 8
+>        GROUP BY
+>            c1
+>            , c2 
+>		) M
+>WHERE
+>    M.RN < 5;

C1           C2                                                                                                    RN
-----------  ----------------------------------------------------------------------------------------------------  --------------------

          7  ghi                                                                                                                      1
          8  hij                                                                                                                      2

--- 2 row(s) selected.
>>
>>
>>obey TEST074(m19155);
>>--------------------------------------------------------------------------
>>
>>create table m19155_t1(c1 int,c2 int,c3 int);

--- SQL operation complete.
>>create table m19155_t2(c1 int,c2 int,c5 int);

--- SQL operation complete.
>>
>>select rownum st,a.* from ( select t1.c1,t1.c2,t2.c5 from m19155_t1 t1 left join m19155_t2 t2 on t1.c1=t2.c1 order by c1 desc,c2 asc) a;

--- 0 row(s) selected.
>>
>>drop table m19155_t1;

--- SQL operation complete.
>>drop table m19155_t2;

--- SQL operation complete.
>>
>>
>>obey TEST074(clnup);
>>--------------------------------------------------------------------------
>>
>>drop schema IF EXISTS t074sch_rownum cascade;

--- SQL operation complete.
>>
>>
>>
>>cqd MODE_COMPATIBLE_1 'off';

--- SQL operation complete.
>>
>>exit;

End of MXCI Session

