>>obey TESTSCEE(set_up);
>>----------------------------------------------------
>>-------------------- set up section ----------------
>>----------------------------------------------------
>>
>>obey GetMvDesc6;
>>--set pattern $$VERS_CURR_SCHEMA_VERSION$$ 2400;
>>set param ?mvDescSubId  -2;
>>set param ?mvName 'SUMBY_DAY';
>>set param ?mvSchemaName 'SUMBY';
>>
>>-- query the TEXT SMD table for the descriptor of an MV
>>prepare getMVDescFromTEXT  from
+>  select text0 || 
+>         coalesce(text1, '') || 
+>         coalesce(text2, '') || 
+>         coalesce(text3, '') || 
+>         coalesce(text4, '') ||
+>         coalesce(text5, '') 
+>           as mv_descriptor_text
+>  from
+>		 (SELECT o.object_uid as uid0, text as text0
+>		         from  HP_DEFINITION_SCHEMA.TEXT t,
+>		               HP_DEFINITION_SCHEMA.objects o,
+>		               HP_SYSTEM_CATALOG.SYSTEM_SCHEMA.schemata s
+>		         where o.object_name = ?mvName
+>		           and o.OBJECT_TYPE = 'MV'
+>		           and o.object_uid = t.object_uid
+>		           and o.schema_uid = s.schema_uid
+>		           and s.schema_name = ?mvSchemaName
+>		           and t.object_sub_id = ?mvDescSubId
+>		           and sequence_num = 0 ) as row0
+>	left outer join
+>		 (SELECT o.object_uid as uid1, text as text1
+>		         from  HP_DEFINITION_SCHEMA.TEXT t,
+>		               HP_DEFINITION_SCHEMA.objects o,
+>		               HP_SYSTEM_CATALOG.SYSTEM_SCHEMA.schemata s
+>		         where o.object_name = ?mvName
+>		           and o.OBJECT_TYPE = 'MV'
+>		           and o.object_uid = t.object_uid
+>		           and o.schema_uid = s.schema_uid
+>		           and s.schema_name = ?mvSchemaName
+>		           and t.object_sub_id = ?mvDescSubId
+>		           and sequence_num = 1 ) as row1
+>		 on uid0 = uid1
+>	left outer join
+>		 (SELECT o.object_uid as uid2, text as text2
+>		         from  HP_DEFINITION_SCHEMA.TEXT t,
+>		               HP_DEFINITION_SCHEMA.objects o,
+>		               HP_SYSTEM_CATALOG.SYSTEM_SCHEMA.schemata s
+>		         where o.object_name = ?mvName
+>		           and o.OBJECT_TYPE = 'MV'
+>		           and o.object_uid = t.object_uid
+>		           and o.schema_uid = s.schema_uid
+>		           and s.schema_name = ?mvSchemaName
+>		           and t.object_sub_id = ?mvDescSubId
+>		           and sequence_num = 2 ) as row2
+>		 on uid0 = uid2
+>	left outer join
+>		 (SELECT o.object_uid as uid3, text as text3
+>		         from  HP_DEFINITION_SCHEMA.TEXT t,
+>		               HP_DEFINITION_SCHEMA.objects o,
+>		               HP_SYSTEM_CATALOG.SYSTEM_SCHEMA.schemata s
+>		         where o.object_name = ?mvName
+>		           and o.OBJECT_TYPE = 'MV'
+>		           and o.object_uid = t.object_uid
+>		           and o.schema_uid = s.schema_uid
+>		           and s.schema_name = ?mvSchemaName
+>		           and t.object_sub_id = ?mvDescSubId
+>		           and sequence_num = 3 ) as row3
+>		 on uid0 = uid3
+>	left outer join
+>		 (SELECT o.object_uid as uid4, text as text4
+>		         from  HP_DEFINITION_SCHEMA.TEXT t,
+>		               HP_DEFINITION_SCHEMA.objects o,
+>		               HP_SYSTEM_CATALOG.SYSTEM_SCHEMA.schemata s
+>		         where o.object_name = ?mvName
+>		           and o.OBJECT_TYPE = 'MV'
+>		           and o.object_uid = t.object_uid
+>		           and o.schema_uid = s.schema_uid
+>		           and s.schema_name = ?mvSchemaName
+>		           and t.object_sub_id = ?mvDescSubId
+>		           and sequence_num = 4 ) as row4
+>		 on uid0 = uid4
+>	left outer join
+>		 (SELECT o.object_uid as uid5, text as text5
+>		         from  HP_DEFINITION_SCHEMA.TEXT t,
+>		               HP_DEFINITION_SCHEMA.objects o,
+>		               HP_SYSTEM_CATALOG.SYSTEM_SCHEMA.schemata s
+>		         where o.object_name = ?mvName
+>		           and o.OBJECT_TYPE = 'MV'
+>		           and o.object_uid = t.object_uid
+>		           and o.schema_uid = s.schema_uid
+>		           and s.schema_name = ?mvSchemaName
+>		           and t.object_sub_id = ?mvDescSubId
+>		           and sequence_num = 5 ) as row5
+>		 on uid0 = uid5;

--- SQL command prepared.
>>
>>
>>control query default MVQR_REWRITE_LEVEL '3';

--- SQL operation complete.
>>control query default MVQR_REWRITE_ENABLED_OPTION 'ON';

--- SQL operation complete.
>>--control query default QUERY_CACHE '0';
>>control query default MVQR_PUBLISH_TO 'PRIVATE';

--- SQL operation complete.
>>control query default REF_CONSTRAINT_NO_ACTION_LIKE_RESTRICT '1';

--- SQL operation complete.
>>control query default MVQR_ALL_JBBS_IN_QD 'ON';

--- SQL operation complete.
>>control query default MVQR_USE_RI_FOR_EXTRA_HUB_TABLES 'ON';

--- SQL operation complete.
>>control query default MVQR_REWRITE_CANDIDATES 'CAT.SCEE.SCEE_MV1 ,:CAT.SCEE.SCEE_MV2';

--- SQL operation complete.
>>
>>-- This is used to make sure the MV is used in the plan.
>>prepare checkPlan from
+>select operator, tname
+>from table(explain(NULL, 'QUERYSTMT'))
+>where operator like '%_SCAN%'
+>order by tname;

--- SQL command prepared.
>>
>>create schema scee;

--- SQL operation complete.
>>set schema scee;

--- SQL operation complete.
>>set pattern $$MVSchemaName$$ SCEE;
>>
>>CREATE TABLE DIM_COUNTRY_OUTRIGGER
+>(
+>	country_iso_code      CHAR(2)  NOT NULL ,
+>	country_iso_name      VARCHAR(100) ,
+>	country_name          VARCHAR(30)  NOT NULL ,
+>	sce_region_code       CHAR(7)  NOT NULL ,
+>	sce_marketing_region_code  CHAR(20)  NOT NULL ,
+>	marketing_report_sort_order  SMALLINT  NOT NULL ,
+>	sce_finance_region_code  CHAR(4)  NOT NULL ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+> PRIMARY KEY (country_iso_code)
+>) no partition;

--- SQL operation complete.
>>
>>CREATE TABLE DIM_ACCT
+>(
+>	acct_id               LARGEINT  NOT NULL ,
+>	demographic_id        LARGEINT  NOT NULL ,
+>	source_psn_acct_id    LARGEINT ,
+>	source_psn_acct_hex   CHAR(16) ,
+>	source_master_psn_acct_id  LARGEINT  NOT NULL ,
+>	source_online_id      VARCHAR(20)  NOT NULL ,
+>	vulgar_source_online_id_ind  VARCHAR(20)  NOT NULL ,
+>	source_acct_jid_id    VARCHAR(20) ,
+>	auto_deposit_ind      VARCHAR(20)  NOT NULL ,
+>	adult_confirmed_ind   VARCHAR(20)  NOT NULL ,
+>	account_suspend_ind   VARCHAR(20)  NOT NULL ,
+>	email_confirmed_ind   VARCHAR(20)  NOT NULL ,
+>	dob                   DATE ,
+>	gender                VARCHAR(20)  NOT NULL ,
+>	language_iso_code     VARCHAR(20)  NOT NULL ,
+>	language_name         VARCHAR(20)  NOT NULL ,
+>	country_iso_code      VARCHAR(20)  NOT NULL ,
+>	country_name          VARCHAR(20)  NOT NULL ,
+>	time_zone_iso_code    VARCHAR(20) ,
+>	acct_creation_dt_id   INTEGER  NOT NULL ,
+>	acct_creation_utc_dttm  DATE  NOT NULL ,
+>	acct_updated_dt_id    INTEGER  NOT NULL ,
+>	acct_updated_utc_dttm  DATE  NOT NULL ,
+>	utc_offset            NUMERIC ,
+>	acct_creation_local_time_id  INTEGER  NOT NULL ,
+>	acct_updated_local_time_id  INTEGER  NOT NULL ,
+>	optin_status_direct   VARCHAR(20)  NOT NULL ,
+>	optin_status_3rd_party  VARCHAR(20)  NOT NULL ,
+>	source_sce_region_code  VARCHAR(20) ,
+>	sce_region_code       VARCHAR(20)  NOT NULL ,
+>	signup_console_code   VARCHAR(64)  NOT NULL ,
+>	eula_version          VARCHAR(10) ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	scd_start_dt          DATE ,
+>	scd_end_dt            DATE ,
+>	scd_current_ind       CHAR(1) ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	PRIMARY KEY (acct_id)
+>)
+>HASH PARTITION BY (acct_id)
+>MAX TABLE SIZE 500 
+>number of partitions 1;

--- SQL operation complete.
>>
>>
>>CREATE TABLE DIM_DEMOGRAPHIC
+>(
+>	demographic_id        SMALLINT  NOT NULL ,
+>	country_iso_code      CHAR(2)  NOT NULL ,
+>	language_iso_code     CHAR(2)  NOT NULL ,
+>	language_name         VARCHAR(30)  NOT NULL ,
+>	gender                CHAR(15)  NOT NULL ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	PRIMARY KEY (demographic_id)
+>) no partition;

--- SQL operation complete.
>>
>>alter table DIM_DEMOGRAPHIC add constraint dem_fk foreign key 
+>  (country_iso_code) references DIM_COUNTRY_OUTRIGGER(COUNTRY_ISO_CODE) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.DEM_FK has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>
>>
>>CREATE TABLE DIM_DT
+>(
+>	dt_hrchy_id           INTEGER  NOT NULL ,
+>	aggr_level_code       VARCHAR(20)  NOT NULL ,
+>	aggr_level_num        INTEGER  NOT NULL ,
+>	calendar_dt           DATE  NOT NULL ,
+>	day_of_week           INTEGER  NOT NULL ,
+>	day_num_in_month      INTEGER  NOT NULL ,
+>	day_num_overall       INTEGER  NOT NULL ,
+>	day_name              VARCHAR(20)  NOT NULL ,
+>	day_abrv              VARCHAR(20)  NOT NULL ,
+>	quarter               INTEGER  NOT NULL ,
+>	sply_day_id           INTEGER  NOT NULL ,
+>	weekday_flag          CHAR(1)  NOT NULL ,
+>	week_id               INTEGER  NOT NULL ,
+>	week_num_in_year      INTEGER  NOT NULL ,
+>	week_num_overall      INTEGER  NOT NULL ,
+>	week_begin_dt         DATE  NOT NULL ,
+>	week_begin_dt_id      INTEGER  NOT NULL ,
+>	week_end_dt           DATE  NOT NULL ,
+>	week_end_dt_id        INTEGER  NOT NULL ,
+>	sply_week_id          INTEGER  NOT NULL ,
+>	store_day_of_week     INTEGER  NOT NULL ,
+>	store_week_id         INTEGER  NOT NULL ,
+>	store_week_num_in_year  INTEGER  NOT NULL ,
+>	store_week_num_overall  INTEGER  NOT NULL ,
+>	store_week_begin_dt   DATE  NOT NULL ,
+>	store_week_begin_dt_id  INTEGER  NOT NULL ,
+>	store_week_end_dt     DATE  NOT NULL ,
+>	store_week_end_dt_id  INTEGER  NOT NULL ,
+>	month_id              INTEGER  NOT NULL ,
+>	month_num             INTEGER  NOT NULL ,
+>	month_num_overall     INTEGER  NOT NULL ,
+>	month_name            VARCHAR(20)  NOT NULL ,
+>	month_abrv            VARCHAR(20)  NOT NULL ,
+>	sply_month_id         INTEGER  NOT NULL ,
+>	year_id               INTEGER  NOT NULL ,
+>	year_num              INTEGER  NOT NULL ,
+>	year_month            CHAR(7)  NOT NULL ,
+>	last_day_in_month_ind  CHAR(1)  NOT NULL ,
+>	relative_day_num      INTEGER ,
+>	relative_week_num     INTEGER ,
+>	relative_month_num    INTEGER ,
+>	relative_year_num     INTEGER ,
+>	source_system_id      SMALLINT ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	PRIMARY KEY (dt_hrchy_id)
+>) no partition;

--- SQL operation complete.
>>
>>
>>CREATE TABLE DIM_PRODUCT_SKU
+>(
+>	product_sku_id        INTEGER  NOT NULL ,
+>	title_id              SMALLINT ,
+>	publisher             VARCHAR(25) , -- VARCHAR(255)
+>	service_provider      VARCHAR(25) , -- VARCHAR(255)
+>	game_genre            CHAR(20)  NOT NULL ,
+>	franchise             VARCHAR(25) , -- VARCHAR(255)
+>	title_name            VARCHAR(25) , -- VARCHAR(255)
+>	disk_title_name       VARCHAR(25) , -- VARCHAR(255)
+>	product_group         VARCHAR(25) , -- VARCHAR(255)
+>	product_name          VARCHAR(25) , -- VARCHAR(255)
+>	sku_name              VARCHAR(25) , -- VARCHAR(255)
+>	sku_type              CHAR(20)  NOT NULL ,
+>	np_com_name           VARCHAR(25) , -- VARCHAR(255)
+>	pmt_sku               CHAR(56)  NOT NULL ,
+>	pmt_product_id        CHAR(48)  NOT NULL ,
+>	pmt_revision_status   INTEGER  NOT NULL ,
+>	pmt_revision          INTEGER  NOT NULL ,
+>	pmt_service_provider_id  CHAR(8)  NOT NULL ,
+>	pmt_creation_date     TIMESTAMP  NOT NULL ,
+>	pmt_subscription_sku  CHAR(56)  NOT NULL ,
+>	pmt_duration_months   INTEGER  NOT NULL ,
+>	pmt_duration_days     INTEGER  NOT NULL ,
+>	pmt_ordering_index    INTEGER  NOT NULL ,
+>	pmt_title_id          CHAR(15)  NOT NULL ,
+>	pmt_business_category  VARCHAR(32)  NOT NULL ,
+>	pmt_sku_type          INTEGER  NOT NULL ,
+>	pmt_content_url       VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_business_description  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_duration_seconds  LARGEINT  NOT NULL ,
+>	pmt_base_sku          CHAR(56)  NOT NULL ,
+>	pmt_video_type        VARCHAR(30)  NOT NULL ,
+>	pmt_in_game_flag      CHAR(1)  NOT NULL ,
+>	pmt_free_flag         CHAR(1)  NOT NULL ,
+>	pmt_ps3_flag          CHAR(1)  NOT NULL ,
+>	pmt_pc_flag           CHAR(1)  NOT NULL ,
+>	pmt_service_provider_email  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_service_provider_type  VARCHAR(100)  NOT NULL ,
+>	pmt_service_provider_language_code  CHAR(2)  NOT NULL ,
+>	pmt_service_provider  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_service_provider_home_url  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_title_type        VARCHAR(100)  NOT NULL ,
+>	pmt_title_type_description  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_title_language_code  CHAR(2)  NOT NULL ,
+>	pmt_title_name        VARCHAR(100)  NOT NULL ,
+>	pmt_title_image_url   VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_title_small_image_url  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_product_tax_code  INTEGER  NOT NULL ,
+>	pmt_product_language_code  CHAR(2)  NOT NULL ,
+>	pmt_product_name      VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_product_short_desc  VARCHAR(10)  NOT NULL ,  --VARCHAR(1000)
+>	pmt_product_home_url  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_product_image_url  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_product_small_image_url  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_sku_language_code  CHAR(2)  NOT NULL ,
+>	pmt_sku_name          VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	pmt_sku_creation_date  TIMESTAMP  NOT NULL ,
+>	pmt_sku_modify_date   TIMESTAMP  NOT NULL ,
+>	pmt_sku_description   VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	wws_service_provider  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	wws_franchise         VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	wws_title_name        VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	wws_title_description  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	wws_product_description  VARCHAR(25)  NOT NULL , -- VARCHAR(255)
+>	wws_type_level1       CHAR(15)  NOT NULL ,
+>	wws_type_level2       CHAR(15)  NOT NULL ,
+>	wws_type_level3       CHAR(15)  NOT NULL ,
+>	sceecat_franchise     VARCHAR(100)  NOT NULL ,
+>	sceecat_game          VARCHAR(100)  NOT NULL ,
+>	sceecat_super_title   VARCHAR(100)  NOT NULL ,
+>	sceecat_title_name    VARCHAR(100)  NOT NULL ,
+>	sceecat_service_provider  VARCHAR(100)  NOT NULL ,
+>	sceecat_generation    CHAR(15)  NOT NULL ,
+>	sceecat_genre         CHAR(20)  NOT NULL ,
+>	sceecat_foc_flag      CHAR(1)  NOT NULL ,
+>	sceecat_profit_centre  INTEGER  NOT NULL ,
+>	sceecat_publisher     VARCHAR(100)  NOT NULL ,
+>	sceecat_party_type    CHAR(15)  NOT NULL ,
+>	scd_current_ind       CHAR(1)  NOT NULL ,
+>	scd_end_date          DATE  NOT NULL ,
+>	scd_start_date        DATE  NOT NULL ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	PRIMARY KEY (product_sku_id)
+>) no partition;

--- SQL operation complete.
>>
>>
>>CREATE TABLE DIM_TITLE
+>(
+>	title_id              SMALLINT  NOT NULL ,
+>	title_name            CHAR(60) ,
+>	publisher             VARCHAR(255) ,
+>	service_provider      VARCHAR(255) ,
+>	game_genre            CHAR(20) ,
+>	franchise             VARCHAR(255) ,
+>	disk_title_name       VARCHAR(255) ,
+>	np_com_name           VARCHAR(255) ,
+>	title_type            CHAR(15) ,
+>	title_image_url       VARCHAR(255) ,
+>	title_image_small_url  VARCHAR(255) ,
+>	wws_title_name        VARCHAR(255) ,
+>	wws_franchise         VARCHAR(255) ,
+>	source_title_id       CHAR(15) ,
+>	initial_release_dt    DATE ,
+>	manually_updated_ind  CHAR(1) ,
+>	pmt_service_provider  VARCHAR(255) ,
+>	pmt_title_type        VARCHAR(100) ,
+>	pmt_title_name        VARCHAR(100) ,
+>	sceecat_franchise     VARCHAR(100) ,
+>	sceecat_game          VARCHAR(100) ,
+>	sceecat_super_title   VARCHAR(100) ,
+>	sceecat_title_name    VARCHAR(100) ,
+>	sceecat_service_provider  VARCHAR(100) ,
+>	sceecat_generation    CHAR(15) ,
+>	sceecat_genre         CHAR(20) ,
+>	sceecat_publisher     VARCHAR(100) ,
+>	sceecat_party_type    CHAR(15) ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	PRIMARY KEY (title_id)
+>) no partition;

--- SQL operation complete.
>>
>>
>>CREATE TABLE DIM_TRANSACTION_TYPE
+>(
+>	transaction_type_id   SMALLINT  NOT NULL ,
+>	transaction_type_code  CHAR(4)  NOT NULL ,
+>	transaction_type_name  VARCHAR(50)  NOT NULL ,
+>	transaction_group     CHAR(20) ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	PRIMARY KEY (transaction_type_id)
+>) no partition;

--- SQL operation complete.
>>
>>
>>CREATE TABLE FCT_PSN_STORE_TRANSACTION
+>(
+>	transaction_local_dt_id  INTEGER  NOT NULL ,
+>	device_type_id           INTEGER  NOT NULL ,
+>	billable_demographic_id  SMALLINT NOT NULL ,
+>	title_id                 SMALLINT NOT NULL ,
+>	billable_acct_id         LARGEINT  NOT NULL ,
+>	transaction_id           LARGEINT  NOT NULL ,
+>	download_acct_id         LARGEINT ,
+>	download_acct_age_id     INTEGER ,
+>	billable_acct_age_id     LARGEINT NOT NULL ,
+>	transaction_utc_dt_id    INTEGER  NOT NULL ,
+>	associated_transaction_id  LARGEINT  NOT NULL ,
+>	in_game_flag             CHAR(1)  NOT NULL ,
+>	refunded_ind             CHAR(1)  NOT NULL ,
+>	product_sku_id           INTEGER NOT NULL ,
+>	transaction_local_time_id  INTEGER ,
+>	transaction_time_id      INTEGER  NOT NULL ,
+>	transaction_type_id      SMALLINT NOT NULL ,
+>	refund_reason_id      INTEGER  NOT NULL ,
+>	psn_tenure_id         INTEGER  NOT NULL ,
+>	currency_iso_code     CHAR(3)  NOT NULL ,
+>	country_iso_code      CHAR(2)  NOT NULL ,
+>	quantity              INTEGER  NOT NULL ,
+>	sales_inc_vat         NUMERIC(18,5) ,
+>	sales_inc_vat_usd     NUMERIC(18,5) ,
+>	sales_inc_vat_eur     NUMERIC(18,5) ,
+>	sales_inc_vat_jpy     NUMERIC(18,5) ,
+>	sales_vat             NUMERIC(18,5) ,
+>	sales_vat_usd         NUMERIC(18,5) ,
+>	sales_vat_eur         NUMERIC(18,5) ,
+>	sales_vat_jpy         NUMERIC(18,5) ,
+>	sales_exc_vat         NUMERIC(18,5) ,
+>	sales_exc_vat_usd     NUMERIC(18,5) ,
+>	sales_exc_vat_eur     NUMERIC(18,5) ,
+>	sales_exc_vat_jpy     NUMERIC(18,5) ,
+>	sp_wholesale_price    NUMERIC(18,5) ,
+>	sp_wholesale_price_usd  NUMERIC(18,5) ,
+>	sp_wholesale_price_eur  NUMERIC(18,5) ,
+>	sp_wholesale_price_jpy  NUMERIC(18,5) ,
+>	download_cogs         NUMERIC(18,5) ,
+>	download_cogs_usd     NUMERIC(18,5) ,
+>	download_cogs_eur     NUMERIC(18,5) ,
+>	download_cogs_jpy     NUMERIC(18,5) ,
+>	retail_margin         NUMERIC(18,5) ,
+>	retail_margin_usd     NUMERIC(18,5) ,
+>	retail_margin_eur     NUMERIC(18,5) ,
+>	retail_margin_jpy     NUMERIC(18,5) ,
+>	source_hdr_report_id  INTEGER  NOT NULL ,
+>	source_report_id      LARGEINT  NOT NULL ,
+>	source_sequence_id    INTEGER  NOT NULL ,
+>	source_system_id      SMALLINT  NOT NULL ,
+>	etl_id_inserted       LARGEINT  NOT NULL ,
+>	etl_id_updated        LARGEINT  NOT NULL ,
+>	PRIMARY KEY (transaction_local_dt_id, device_type_id, billable_demographic_id, title_id, billable_acct_id, transaction_id)
+>) no partition;

--- SQL operation complete.
>>
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk1 foreign key (transaction_local_dt_id)  references DIM_DT(DT_HRCHY_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK1 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk2 foreign key (billable_demographic_id)  references DIM_DEMOGRAPHIC(DEMOGRAPHIC_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK2 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk3 foreign key (title_id)                 references DIM_TITLE(TITLE_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK3 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk4 foreign key (billable_acct_id)         references DIM_ACCT(ACCT_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK4 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk5 foreign key (billable_acct_age_id)     references DIM_ACCT(ACCT_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK5 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk6 foreign key (product_sku_id)           references DIM_PRODUCT_SKU(PRODUCT_SKU_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK6 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>alter table FCT_PSN_STORE_TRANSACTION add constraint txn_fk7 foreign key (transaction_type_id)      references DIM_TRANSACTION_TYPE(TRANSACTION_TYPE_ID) NOT ENFORCED;

*** WARNING[1313] The referential integrity constraint CAT.SCEE.TXN_FK7 has been created with the NOT ENFORCED attribute and will not be enforced during INSERT, UPDATE, OR DELETE statements.

--- SQL operation completed with warnings.
>>
>>obey TESTSCEE(create_mvs);
>>--===========================================
>>-- MVs
>>--===========================================
>>
>>-- Single table MAV with groupby on foreign key columns
>>
>>CREATE MV SCEE_MV1
+>    REFRESH ON REQUEST
+>    INITIALIZED ON CREATE
+>    AS
+>SELECT
+>    TRANSACTION_LOCAL_DT_ID,
+>    DEVICE_TYPE_ID,
+>    BILLABLE_DEMOGRAPHIC_ID,
+>    TITLE_ID,
+>    BILLABLE_ACCT_AGE_ID,
+>    IN_GAME_FLAG,
+>    PRODUCT_SKU_ID,
+>    TRANSACTION_TYPE_ID,
+>    CURRENCY_ISO_CODE,
+>    SUM(QUANTITY)               AS QUANTITY,
+>    SUM(SALES_INC_VAT_USD)      AS SALES_INC_VAT_USD,
+>    SUM(SALES_VAT_USD)          AS SALES_VAT_USD,
+>    SUM(SALES_EXC_VAT_USD)      AS SALES_EXC_VAT_USD,
+>    SUM(SP_WHOLESALE_PRICE_USD) AS SP_WHOLESALE_PRICE_USD,
+>    SUM(DOWNLOAD_COGS_USD)      AS DOWNLOAD_COGS_USD,
+>    SUM(RETAIL_MARGIN_USD)      AS RETAIL_MARGIN_USD
+>FROM
+>    FCT_PSN_STORE_TRANSACTION
+>GROUP BY
+>    TRANSACTION_LOCAL_DT_ID,
+>    DEVICE_TYPE_ID,
+>    BILLABLE_DEMOGRAPHIC_ID,
+>    TITLE_ID,
+>    BILLABLE_ACCT_AGE_ID,
+>    IN_GAME_FLAG,
+>    PRODUCT_SKU_ID,
+>    TRANSACTION_TYPE_ID,    
+>    CURRENCY_ISO_CODE
+>;

--- SQL operation complete.
>>
>>set pattern $$MVName$$ SCEE_MV1;
>>obey TESTSCEE(dump_MV);
>>--===========================================
>>--== Create the MV descriptor XML
>>--===========================================
>>
>>log $$MVName$$.tmp clear;
<Publish TS='0'>
<MV>
  <Version>
    1.0
  </Version>
  <Table>
    CAT.SCEE.SCEE_MV1
  </Table>
  <Misc isIncremental='1'>
  </Misc>
  <JBB id='B0'>
    <Hub>
      <JBBCList>
        <Table id='T1' TS='212223875584503777' numCols='52'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION
        </Table>
      </JBBCList>
    </Hub>
    <ExtraHub>
    </ExtraHub>
    <OutputList>
      <Output id='O734' name='QUANTITY'>
        <Expr id='X734'>
          <Function id='S734' op='sum' aggregateFunc='3'>
            <Column id='C602' tableId='T1' colIndex='21' isNullable='0'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.QUANTITY
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O735' name='SALES_INC_VAT_USD'>
        <Expr id='X735'>
          <Function id='S735' op='sum' aggregateFunc='3'>
            <Column id='C604' tableId='T1' colIndex='23'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O736' name='SALES_VAT_USD'>
        <Expr id='X736'>
          <Function id='S736' op='sum' aggregateFunc='3'>
            <Column id='C608' tableId='T1' colIndex='27'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_VAT_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O737' name='SALES_EXC_VAT_USD'>
        <Expr id='X737'>
          <Function id='S737' op='sum' aggregateFunc='3'>
            <Column id='C612' tableId='T1' colIndex='31'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_EXC_VAT_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O738' name='SP_WHOLESALE_PRICE_USD'>
        <Expr id='X738'>
          <Function id='S738' op='sum' aggregateFunc='3'>
            <Column id='C616' tableId='T1' colIndex='35'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SP_WHOLESALE_PRICE_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O739' name='DOWNLOAD_COGS_USD'>
        <Expr id='X739'>
          <Function id='S739' op='sum' aggregateFunc='3'>
            <Column id='C620' tableId='T1' colIndex='39'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DOWNLOAD_COGS_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O740' name='RETAIL_MARGIN_USD'>
        <Expr id='X740'>
          <Function id='S740' op='sum' aggregateFunc='3'>
            <Column id='C624' tableId='T1' colIndex='43'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.RETAIL_MARGIN_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O742' name='SYS_COUNTSTAR1'>
        <Expr id='X742'>
          <Function id='S742' op='count' aggregateFunc='1'>
            <NumericVal id='S741' scale='0'>
              1 
            </NumericVal>
          </Function>
        </Expr>
      </Output>
      <Output id='O743' name='SYS_COUNT2'>
        <Expr id='X743'>
          <Function id='S743' op='count_nonull' aggregateFunc='2'>
            <Column ref='C604'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O744' name='SYS_COUNT3'>
        <Expr id='X744'>
          <Function id='S744' op='count_nonull' aggregateFunc='2'>
            <Column ref='C608'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O745' name='SYS_COUNT4'>
        <Expr id='X745'>
          <Function id='S745' op='count_nonull' aggregateFunc='2'>
            <Column ref='C612'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O746' name='SYS_COUNT5'>
        <Expr id='X746'>
          <Function id='S746' op='count_nonull' aggregateFunc='2'>
            <Column ref='C616'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O747' name='SYS_COUNT6'>
        <Expr id='X747'>
          <Function id='S747' op='count_nonull' aggregateFunc='2'>
            <Column ref='C620'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O748' name='SYS_COUNT7'>
        <Expr id='X748'>
          <Function id='S748' op='count_nonull' aggregateFunc='2'>
            <Column ref='C624'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O750' name='TRANSACTION_LOCAL_DT_ID'>
        <Column ref='C581'>
        </Column>
      </Output>
      <Output id='O753' name='DEVICE_TYPE_ID'>
        <Column ref='C582'>
        </Column>
      </Output>
      <Output id='O756' name='BILLABLE_DEMOGRAPHIC_ID'>
        <Column ref='C583'>
        </Column>
      </Output>
      <Output id='O759' name='TITLE_ID'>
        <Column ref='C584'>
        </Column>
      </Output>
      <Output id='O774' name='BILLABLE_ACCT_AGE_ID'>
        <Column ref='C589'>
        </Column>
      </Output>
      <Output id='O783' name='IN_GAME_FLAG'>
        <Column ref='C592'>
        </Column>
      </Output>
      <Output id='O789' name='PRODUCT_SKU_ID'>
        <Column ref='C594'>
        </Column>
      </Output>
      <Output id='O798' name='TRANSACTION_TYPE_ID'>
        <Column ref='C597'>
        </Column>
      </Output>
      <Output id='O807' name='CURRENCY_ISO_CODE'>
        <Column ref='C600'>
        </Column>
      </Output>
    </OutputList>
    <GroupBy id='G2'>
      <Primary>
        <Column id='C581' tableId='T1' colIndex='0' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID
        </Column>
        <Column id='C582' tableId='T1' colIndex='1' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DEVICE_TYPE_ID
        </Column>
        <Column id='C583' tableId='T1' colIndex='2' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
        </Column>
        <Column id='C584' tableId='T1' colIndex='3' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TITLE_ID
        </Column>
        <Column id='C589' tableId='T1' colIndex='8' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_AGE_ID
        </Column>
        <Column id='C592' tableId='T1' colIndex='11' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.IN_GAME_FLAG
        </Column>
        <Column id='C594' tableId='T1' colIndex='13' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID
        </Column>
        <Column id='C597' tableId='T1' colIndex='16' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_TYPE_ID
        </Column>
        <Column id='C600' tableId='T1' colIndex='19' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.CURRENCY_ISO_CODE
        </Column>
      </Primary>
    </GroupBy>
  </JBB>
</MV>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
<Update op='Refresh' TS='1'> </Update>
</Publish>
>>
>>
>>-- Single table MAV with groupby on foreign key columns
>>
>>CREATE MV SCEE_MV2 
+>    REFRESH ON REQUEST
+>    INITIALIZED ON CREATE
+>    AS
+>SELECT
+>    TRANSACTION_LOCAL_DT_ID,
+>    DEVICE_TYPE_ID,
+>    BILLABLE_DEMOGRAPHIC_ID,
+>    TITLE_ID,
+>    TRANSACTION_TYPE_ID,
+>    CURRENCY_ISO_CODE,
+>    SUM(QUANTITY)               AS QUANTITY,
+>    SUM(SALES_INC_VAT_USD)      AS SALES_INC_VAT_USD,
+>    SUM(SALES_VAT_USD)          AS SALES_VAT_USD,
+>    SUM(SALES_EXC_VAT_USD)      AS SALES_EXC_VAT_USD,
+>    SUM(SP_WHOLESALE_PRICE_USD) AS SP_WHOLESALE_PRICE_USD,
+>    SUM(DOWNLOAD_COGS_USD)      AS DOWNLOAD_COGS_USD,
+>    SUM(RETAIL_MARGIN_USD)      AS RETAIL_MARGIN_USD
+>FROM
+>    FCT_PSN_STORE_TRANSACTION
+>GROUP BY
+>    TRANSACTION_LOCAL_DT_ID,
+>    DEVICE_TYPE_ID,
+>    BILLABLE_DEMOGRAPHIC_ID,
+>    TITLE_ID,
+>    TRANSACTION_TYPE_ID,
+>    CURRENCY_ISO_CODE
+>;

--- SQL operation complete.
>>
>>set pattern $$MVName$$ SCEE_MV2;
>>obey TESTSCEE(dump_MV);
>>--===========================================
>>--== Create the MV descriptor XML
>>--===========================================
>>
>>log $$MVName$$.tmp clear;
<Publish TS='0'>
<MV>
  <Version>
    1.0
  </Version>
  <Table>
    CAT.SCEE.SCEE_MV2
  </Table>
  <Misc isIncremental='1'>
  </Misc>
  <JBB id='B0'>
    <Hub>
      <JBBCList>
        <Table id='T1' TS='212223875584660052' numCols='52'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION
        </Table>
      </JBBCList>
    </Hub>
    <ExtraHub>
    </ExtraHub>
    <OutputList>
      <Output id='O662' name='QUANTITY'>
        <Expr id='X662'>
          <Function id='S662' op='sum' aggregateFunc='3'>
            <Column id='C530' tableId='T1' colIndex='21' isNullable='0'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.QUANTITY
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O663' name='SALES_INC_VAT_USD'>
        <Expr id='X663'>
          <Function id='S663' op='sum' aggregateFunc='3'>
            <Column id='C532' tableId='T1' colIndex='23'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O664' name='SALES_VAT_USD'>
        <Expr id='X664'>
          <Function id='S664' op='sum' aggregateFunc='3'>
            <Column id='C536' tableId='T1' colIndex='27'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_VAT_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O665' name='SALES_EXC_VAT_USD'>
        <Expr id='X665'>
          <Function id='S665' op='sum' aggregateFunc='3'>
            <Column id='C540' tableId='T1' colIndex='31'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_EXC_VAT_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O666' name='SP_WHOLESALE_PRICE_USD'>
        <Expr id='X666'>
          <Function id='S666' op='sum' aggregateFunc='3'>
            <Column id='C544' tableId='T1' colIndex='35'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SP_WHOLESALE_PRICE_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O667' name='DOWNLOAD_COGS_USD'>
        <Expr id='X667'>
          <Function id='S667' op='sum' aggregateFunc='3'>
            <Column id='C548' tableId='T1' colIndex='39'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DOWNLOAD_COGS_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O668' name='RETAIL_MARGIN_USD'>
        <Expr id='X668'>
          <Function id='S668' op='sum' aggregateFunc='3'>
            <Column id='C552' tableId='T1' colIndex='43'>
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.RETAIL_MARGIN_USD
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O670' name='SYS_COUNTSTAR1'>
        <Expr id='X670'>
          <Function id='S670' op='count' aggregateFunc='1'>
            <NumericVal id='S669' scale='0'>
              1 
            </NumericVal>
          </Function>
        </Expr>
      </Output>
      <Output id='O671' name='SYS_COUNT2'>
        <Expr id='X671'>
          <Function id='S671' op='count_nonull' aggregateFunc='2'>
            <Column ref='C532'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O672' name='SYS_COUNT3'>
        <Expr id='X672'>
          <Function id='S672' op='count_nonull' aggregateFunc='2'>
            <Column ref='C536'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O673' name='SYS_COUNT4'>
        <Expr id='X673'>
          <Function id='S673' op='count_nonull' aggregateFunc='2'>
            <Column ref='C540'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O674' name='SYS_COUNT5'>
        <Expr id='X674'>
          <Function id='S674' op='count_nonull' aggregateFunc='2'>
            <Column ref='C544'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O675' name='SYS_COUNT6'>
        <Expr id='X675'>
          <Function id='S675' op='count_nonull' aggregateFunc='2'>
            <Column ref='C548'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O676' name='SYS_COUNT7'>
        <Expr id='X676'>
          <Function id='S676' op='count_nonull' aggregateFunc='2'>
            <Column ref='C552'>
            </Column>
          </Function>
        </Expr>
      </Output>
      <Output id='O678' name='TRANSACTION_LOCAL_DT_ID'>
        <Column ref='C509'>
        </Column>
      </Output>
      <Output id='O681' name='DEVICE_TYPE_ID'>
        <Column ref='C510'>
        </Column>
      </Output>
      <Output id='O684' name='BILLABLE_DEMOGRAPHIC_ID'>
        <Column ref='C511'>
        </Column>
      </Output>
      <Output id='O687' name='TITLE_ID'>
        <Column ref='C512'>
        </Column>
      </Output>
      <Output id='O726' name='TRANSACTION_TYPE_ID'>
        <Column ref='C525'>
        </Column>
      </Output>
      <Output id='O735' name='CURRENCY_ISO_CODE'>
        <Column ref='C528'>
        </Column>
      </Output>
    </OutputList>
    <GroupBy id='G2'>
      <Primary>
        <Column id='C509' tableId='T1' colIndex='0' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID
        </Column>
        <Column id='C510' tableId='T1' colIndex='1' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DEVICE_TYPE_ID
        </Column>
        <Column id='C511' tableId='T1' colIndex='2' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
        </Column>
        <Column id='C512' tableId='T1' colIndex='3' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TITLE_ID
        </Column>
        <Column id='C525' tableId='T1' colIndex='16' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_TYPE_ID
        </Column>
        <Column id='C528' tableId='T1' colIndex='19' isNullable='0'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION.CURRENCY_ISO_CODE
        </Column>
      </Primary>
    </GroupBy>
  </JBB>
</MV>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
<Update op='Refresh' TS='1'> </Update>
</Publish>
>>
>>
>>obey TESTSCEE(match_Q1);
>>--===========================================
>>--== Low Level Query
>>--===========================================
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'DUMP';

--- SQL operation complete.
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    DIM_ACCT.SOURCE_PSN_ACCT_ID,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD) AS SALES_INC_VAT_USD
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>        --FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.day_of_week
+>    )
+>INNER JOIN DIM_TITLE
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TITLE_ID = DIM_TITLE.TITLE_ID
+>    )
+>INNER JOIN DIM_PRODUCT_SKU
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID = DIM_PRODUCT_SKU.PRODUCT_SKU_ID
+>    )
+>INNER JOIN DIM_ACCT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_AGE_ID = DIM_ACCT.ACCT_ID
+>    )
+>WHERE
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE = 'SCEA'
+>AND DIM_DT.RELATIVE_MONTH_NUM = -1
+>AND DIM_TITLE.TITLE_NAME = 'SingStar'
+>AND DIM_PRODUCT_SKU.PRODUCT_NAME = 'Song - Amy Winehouse, Rehab'
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    DIM_ACCT.SOURCE_PSN_ACCT_ID
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME ASC ;

--- SQL command prepared.
>>
>>set pattern $$QueryName$$ SCEE_Q1;
>>obey TESTSCEE(dump_Query);
>>--===========================================
>>--== Create the query descriptor XML
>>--===========================================
>>
>>log $$QueryName$$.tmp clear;
>>sh sh ./CropDescriptor.ksh -q -i $$QueryName$$.TMP -o $$QueryName$$.xml;
>>-- and once for the test log file
>>execute QueryStmt;

Query Descriptor
-------------------------------------------------------------------------------------------------

<Query>                                                                                          
  <Version>                                                                                      
    1.0                                                                                          
  </Version>                                                                                     
  <Misc rewriteLevel='3'>                                                                        
  </Misc>                                                                                        
  <JBB id='B0'>                                                                                  
    <Hub>                                                                                        
      <JBBCList>                                                                                 
        <Table id='T1' TS='212223875584316247' numCols='38'>                                     
          CAT.SCEE.DIM_ACCT                                                                      
          <Key>                                                                                  
            <Column id='C776' tableId='T1' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_ACCT.ACCT_ID                                                          
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T7' TS='212223875581222002' numCols='10' rangeBits='00000001'>                
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER                                                         
          <Key>                                                                                  
            <Column id='C1' tableId='T7' colIndex='0' isNullable='0'>                            
              CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE                                    
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T6' TS='212223875583909932' numCols='8'>                                      
          CAT.SCEE.DIM_DEMOGRAPHIC                                                               
          <Key>                                                                                  
            <Column id='C38' tableId='T6' colIndex='0' isNullable='0'>                           
              CAT.SCEE.DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID                                            
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T4' TS='212223875583659892' numCols='45' rangeBits='0000000000000800'>        
          CAT.SCEE.DIM_DT                                                                        
          <Key>                                                                                  
            <Column id='C224' tableId='T4' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_DT.DT_HRCHY_ID                                                        
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T2' TS='212223875584394385' numCols='83' rangeBits='000004000000000000000000'>
          CAT.SCEE.DIM_PRODUCT_SKU                                                               
          <Key>                                                                                  
            <Column id='C464' tableId='T2' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_SKU_ID                                            
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T3' TS='212223875584019325' numCols='31' rangeBits='00000004'>                
          CAT.SCEE.DIM_TITLE                                                                     
          <Key>                                                                                  
            <Column id='C394' tableId='T3' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_TITLE.TITLE_ID                                                        
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T5' TS='212223875584660052' numCols='52'>                                     
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION                                                     
          <Key>                                                                                  
            <Column id='C70' tableId='T5' colIndex='0' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID                         
            </Column>                                                                            
            <Column id='C71' tableId='T5' colIndex='1' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DEVICE_TYPE_ID                                  
            </Column>                                                                            
            <Column id='C72' tableId='T5' colIndex='2' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID                         
            </Column>                                                                            
            <Column id='C73' tableId='T5' colIndex='3' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TITLE_ID                                        
            </Column>                                                                            
            <Column id='C74' tableId='T5' colIndex='4' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_ID                                
            </Column>                                                                            
            <Column id='C75' tableId='T5' colIndex='5' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_ID                                  
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
      </JBBCList>                                                                                
      <JoinPredList>                                                                             
        <JoinPred id='J927'>                                                                     
          <Column ref='C1'>                                                                      
          </Column>                                                                              
          <Column id='C39' tableId='T6' colIndex='1' isNullable='0'>                             
            CAT.SCEE.DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE                                            
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J957'>                                                                     
          <Column ref='C38'>                                                                     
          </Column>                                                                              
          <Column ref='C72'>                                                                     
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J984'>                                                                     
          <Column ref='C224'>                                                                    
          </Column>                                                                              
          <Column ref='C70'>                                                                     
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J993'>                                                                     
          <Column ref='C394'>                                                                    
          </Column>                                                                              
          <Column ref='C73'>                                                                     
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J1008'>                                                                    
          <Column ref='C776'>                                                                    
          </Column>                                                                              
          <Column id='C78' tableId='T5' colIndex='8' isNullable='0'>                             
            CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_AGE_ID                              
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J1023'>                                                                    
          <Column ref='C464'>                                                                    
          </Column>                                                                              
          <Column id='C83' tableId='T5' colIndex='13' isNullable='0'>                            
            CAT.SCEE.FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID                                    
          </Column>                                                                              
        </JoinPred>                                                                              
      </JoinPredList>                                                                            
      <RangePredList>                                                                            
        <Range id='R1838' sqlType='CHAR(7) CHARACTER SET ISO88591 NO NULLS'>                     
          <Column ref='C4'>                                                                      
          </Column>                                                                              
          <OpEQ>                                                                                 
            <StringVal><![CDATA[SCEA]]></StringVal>                                              
          </OpEQ>                                                                                
        </Range>                                                                                 
        <Range id='R1839' sqlType='INTEGER SIGNED ALLOWS NULLS'>                                 
          <Column id='C264' tableId='T4' colIndex='40'>                                          
            CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM                                                   
          </Column>                                                                              
          <OpEQ>                                                                                 
            <NumericVal scale='0'>                                                               
              -1                                                                                 
            </NumericVal>                                                                        
          </OpEQ>                                                                                
        </Range>                                                                                 
        <Range id='R1840' sqlType='CHAR(60) CHARACTER SET ISO88591 ALLOWS NULLS'>                
          <Column ref='C395'>                                                                    
          </Column>                                                                              
          <OpEQ>                                                                                 
            <StringVal><![CDATA[SingStar]]></StringVal>                                          
          </OpEQ>                                                                                
        </Range>                                                                                 
        <Range id='R1841' sqlType='VARCHAR(25) CHARACTER SET ISO88591 ALLOWS NULLS'>             
          <Column ref='C473'>                                                                    
          </Column>                                                                              
          <OpEQ>                                                                                 
            <StringVal><![CDATA[Song - Amy Winehouse, Rehab]]></StringVal>                       
          </OpEQ>                                                                                
        </Range>                                                                                 
      </RangePredList>                                                                           
    </Hub>                                                                                       
    <ExtraHub>                                                                                   
    </ExtraHub>                                                                                  
    <OutputList>                                                                                 
      <Output id='O916'>                                                                         
        <Expr id='X916'>                                                                         
          <Function id='S916' op='sum' aggregateFunc='3'>                                        
            <Column id='C91' tableId='T5' colIndex='21' isNullable='0'>                          
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.QUANTITY                                        
            </Column>                                                                            
          </Function>                                                                            
        </Expr>                                                                                  
      </Output>                                                                                  
      <Output id='O917'>                                                                         
        <Expr id='X917'>                                                                         
          <Function id='S917' op='sum' aggregateFunc='3'>                                        
            <Column id='C93' tableId='T5' colIndex='23'>                                         
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD                               
            </Column>                                                                            
          </Function>                                                                            
        </Expr>                                                                                  
      </Output>                                                                                  
      <Output id='O933'>                                                                         
        <Column ref='C3'>                                                                        
        </Column>                                                                                
      </Output>                                                                                  
      <Output id='O1195'>                                                                        
        <Column ref='C241'>                                                                      
        </Column>                                                                                
      </Output>                                                                                  
      <Output id='O1410'>                                                                        
        <Column ref='C473'>                                                                      
        </Column>                                                                                
      </Output>                                                                                  
      <Output id='O1645'>                                                                        
        <Column ref='C778'>                                                                      
        </Column>                                                                                
      </Output>                                                                                  
    </OutputList>                                                                                
    <GroupBy id='G8'>                                                                            
      <Primary>                                                                                  
        <Column id='C3' tableId='T7' colIndex='2' isNullable='0'>                                
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME                                            
        </Column>                                                                                
        <Column id='C4' tableId='T7' colIndex='3' isNullable='0'>                                
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE                                         
        </Column>                                                                                
        <Column id='C241' tableId='T4' colIndex='17' isNullable='0'>                             
          CAT.SCEE.DIM_DT.WEEK_END_DT                                                            
        </Column>                                                                                
        <Column id='C395' tableId='T3' colIndex='1'>                                             
          CAT.SCEE.DIM_TITLE.TITLE_NAME                                                          
        </Column>                                                                                
        <Column id='C473' tableId='T2' colIndex='9'>                                             
          CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_NAME                                                  
        </Column>                                                                                
        <Column id='C778' tableId='T1' colIndex='2'>                                             
          CAT.SCEE.DIM_ACCT.SOURCE_PSN_ACCT_ID                                                   
        </Column>                                                                                
      </Primary>                                                                                 
    </GroupBy>                                                                                   
  </JBB>                                                                                         
</Query>                                                                                         

--- 218 row(s) selected.
>>
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'OFF';

--- SQL operation complete.
>>
>>sh echo INITIALIZE           >> scee_q1.in;
>>sh echo PUBLISH SCEE_MV1.xml >> scee_q1.in;
>>sh echo PUBLISH SCEE_MV2.xml >> scee_q1.in;
>>sh echo MATCH SCEE_Q1.xml    >> scee_q1.in;
>>
>>sh sh -c "$QMS scee_q1.in scee.out";
>>
>>log;
<Result>
  <Version>
    1.0
  </Version>
  <JbbResult ref='B0'>
    <JbbSubset ref='G8' hasGroupby='1'>
      <TableList>
        <Table ref='T5'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION
        </Table>
      </TableList>
      <CandidateList>
        <Candidate isPreferredMatch='0' isIndirectGroupBy='1' statsOnly='0'>
          <MVName TS='0'>
            CAT.SCEE.SCEE_MV1
          </MVName>
          <RangePredList>
            <Range ref='R1838' result='NotProvided'>
              <Column ref='C4' tableId='T7'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE
              </Column>
            </Range>
            <Range ref='R1839' result='NotProvided'>
              <Column ref='C264' tableId='T4'>
                CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM
              </Column>
            </Range>
            <Range ref='R1840' result='NotProvided'>
              <Column ref='C395' tableId='T3'>
                CAT.SCEE.DIM_TITLE.TITLE_NAME
              </Column>
            </Range>
            <Range ref='R1841' result='NotProvided'>
              <Column ref='C473' tableId='T2'>
                CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_NAME
              </Column>
            </Range>
          </RangePredList>
          <GroupBy ref='G8' result='NotProvided'>
            <Primary>
              <Column ref='C3' tableId='T7'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME
              </Column>
              <Column ref='C4' tableId='T7'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE
              </Column>
              <Column ref='C241' tableId='T4'>
                CAT.SCEE.DIM_DT.WEEK_END_DT
              </Column>
              <Column ref='C395' tableId='T3'>
                CAT.SCEE.DIM_TITLE.TITLE_NAME
              </Column>
              <Column ref='C473' tableId='T2'>
                CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_NAME
              </Column>
              <Column ref='C778' tableId='T1'>
                CAT.SCEE.DIM_ACCT.SOURCE_PSN_ACCT_ID
              </Column>
            </Primary>
          </GroupBy>
          <OutputList>
            <Output ref='C72' result='Provided'>
              <MVColumn ref='C72'>
                BILLABLE_DEMOGRAPHIC_ID
              </MVColumn>
            </Output>
            <Output ref='C70' result='Provided'>
              <MVColumn ref='C70'>
                TRANSACTION_LOCAL_DT_ID
              </MVColumn>
            </Output>
            <Output ref='C73' result='Provided'>
              <MVColumn ref='C73'>
                TITLE_ID
              </MVColumn>
            </Output>
            <Output ref='C78' result='Provided'>
              <MVColumn ref='C78'>
                BILLABLE_ACCT_AGE_ID
              </MVColumn>
            </Output>
            <Output ref='C83' result='Provided'>
              <MVColumn ref='C83'>
                PRODUCT_SKU_ID
              </MVColumn>
            </Output>
            <Output ref='O917' result='NotProvided'>
              <Expr ref='X917'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S917'>
                    SALES_INC_VAT_USD
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
            <Output ref='O916' result='NotProvided'>
              <Expr ref='X916'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S916'>
                    QUANTITY
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
          </OutputList>
        </Candidate>
      </CandidateList>
    </JbbSubset>
  </JbbResult>
</Result>
>>
>>obey TESTSCEE(match_Q1_bad);
>>--===========================================
>>--== Low Level Query
>>--== Disqualified because the query uses an 
>>--== aggregate function on a dimension table.
>>--===========================================
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'DUMP';

--- SQL operation complete.
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    DIM_ACCT.SOURCE_PSN_ACCT_ID,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD) AS SALES_INC_VAT_USD,
+>    sum(dim_dt.aggr_level_num) as extra_aggr
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>        --FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.day_of_week
+>    )
+>INNER JOIN DIM_TITLE
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TITLE_ID = DIM_TITLE.TITLE_ID
+>    )
+>INNER JOIN DIM_PRODUCT_SKU
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID = DIM_PRODUCT_SKU.PRODUCT_SKU_ID
+>    )
+>INNER JOIN DIM_ACCT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_AGE_ID = DIM_ACCT.ACCT_ID
+>    )
+>WHERE
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE = 'SCEA'
+>AND DIM_DT.RELATIVE_MONTH_NUM = -1
+>AND DIM_TITLE.TITLE_NAME = 'SingStar'
+>AND DIM_PRODUCT_SKU.PRODUCT_NAME = 'Song - Amy Winehouse, Rehab'
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    DIM_ACCT.SOURCE_PSN_ACCT_ID
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME ASC ;

--- SQL command prepared.
>>
>>set pattern $$QueryName$$ SCEE_Q1X;
>>obey TESTSCEE(dump_Query);
>>--===========================================
>>--== Create the query descriptor XML
>>--===========================================
>>
>>log $$QueryName$$.tmp clear;
>>sh sh ./CropDescriptor.ksh -q -i $$QueryName$$.TMP -o $$QueryName$$.xml;
>>-- and once for the test log file
>>execute QueryStmt;

Query Descriptor
-------------------------------------------------------------------------------------------------

<Query>                                                                                          
  <Version>                                                                                      
    1.0                                                                                          
  </Version>                                                                                     
  <Misc rewriteLevel='3'>                                                                        
  </Misc>                                                                                        
  <JBB id='B0'>                                                                                  
    <Hub>                                                                                        
      <JBBCList>                                                                                 
        <Table id='T1' TS='212223875584316247' numCols='38'>                                     
          CAT.SCEE.DIM_ACCT                                                                      
          <Key>                                                                                  
            <Column id='C776' tableId='T1' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_ACCT.ACCT_ID                                                          
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T7' TS='212223875581222002' numCols='10' rangeBits='00000001'>                
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER                                                         
          <Key>                                                                                  
            <Column id='C1' tableId='T7' colIndex='0' isNullable='0'>                            
              CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE                                    
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T6' TS='212223875583909932' numCols='8'>                                      
          CAT.SCEE.DIM_DEMOGRAPHIC                                                               
          <Key>                                                                                  
            <Column id='C38' tableId='T6' colIndex='0' isNullable='0'>                           
              CAT.SCEE.DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID                                            
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T4' TS='212223875583659892' numCols='45' rangeBits='0000000000000800'>        
          CAT.SCEE.DIM_DT                                                                        
          <Key>                                                                                  
            <Column id='C224' tableId='T4' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_DT.DT_HRCHY_ID                                                        
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T2' TS='212223875584394385' numCols='83' rangeBits='000004000000000000000000'>
          CAT.SCEE.DIM_PRODUCT_SKU                                                               
          <Key>                                                                                  
            <Column id='C464' tableId='T2' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_SKU_ID                                            
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T3' TS='212223875584019325' numCols='31' rangeBits='00000004'>                
          CAT.SCEE.DIM_TITLE                                                                     
          <Key>                                                                                  
            <Column id='C394' tableId='T3' colIndex='0' isNullable='0'>                          
              CAT.SCEE.DIM_TITLE.TITLE_ID                                                        
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
        <Table id='T5' TS='212223875584660052' numCols='52'>                                     
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION                                                     
          <Key>                                                                                  
            <Column id='C70' tableId='T5' colIndex='0' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID                         
            </Column>                                                                            
            <Column id='C71' tableId='T5' colIndex='1' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DEVICE_TYPE_ID                                  
            </Column>                                                                            
            <Column id='C72' tableId='T5' colIndex='2' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID                         
            </Column>                                                                            
            <Column id='C73' tableId='T5' colIndex='3' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TITLE_ID                                        
            </Column>                                                                            
            <Column id='C74' tableId='T5' colIndex='4' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_ID                                
            </Column>                                                                            
            <Column id='C75' tableId='T5' colIndex='5' isNullable='0'>                           
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_ID                                  
            </Column>                                                                            
          </Key>                                                                                 
        </Table>                                                                                 
      </JBBCList>                                                                                
      <JoinPredList>                                                                             
        <JoinPred id='J928'>                                                                     
          <Column ref='C1'>                                                                      
          </Column>                                                                              
          <Column id='C39' tableId='T6' colIndex='1' isNullable='0'>                             
            CAT.SCEE.DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE                                            
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J958'>                                                                     
          <Column ref='C38'>                                                                     
          </Column>                                                                              
          <Column ref='C72'>                                                                     
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J985'>                                                                     
          <Column ref='C224'>                                                                    
          </Column>                                                                              
          <Column ref='C70'>                                                                     
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J994'>                                                                     
          <Column ref='C394'>                                                                    
          </Column>                                                                              
          <Column ref='C73'>                                                                     
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J1009'>                                                                    
          <Column ref='C776'>                                                                    
          </Column>                                                                              
          <Column id='C78' tableId='T5' colIndex='8' isNullable='0'>                             
            CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_AGE_ID                              
          </Column>                                                                              
        </JoinPred>                                                                              
        <JoinPred id='J1024'>                                                                    
          <Column ref='C464'>                                                                    
          </Column>                                                                              
          <Column id='C83' tableId='T5' colIndex='13' isNullable='0'>                            
            CAT.SCEE.FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID                                    
          </Column>                                                                              
        </JoinPred>                                                                              
      </JoinPredList>                                                                            
      <RangePredList>                                                                            
        <Range id='R1839' sqlType='CHAR(7) CHARACTER SET ISO88591 NO NULLS'>                     
          <Column ref='C4'>                                                                      
          </Column>                                                                              
          <OpEQ>                                                                                 
            <StringVal><![CDATA[SCEA]]></StringVal>                                              
          </OpEQ>                                                                                
        </Range>                                                                                 
        <Range id='R1840' sqlType='INTEGER SIGNED ALLOWS NULLS'>                                 
          <Column id='C264' tableId='T4' colIndex='40'>                                          
            CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM                                                   
          </Column>                                                                              
          <OpEQ>                                                                                 
            <NumericVal scale='0'>                                                               
              -1                                                                                 
            </NumericVal>                                                                        
          </OpEQ>                                                                                
        </Range>                                                                                 
        <Range id='R1841' sqlType='CHAR(60) CHARACTER SET ISO88591 ALLOWS NULLS'>                
          <Column ref='C395'>                                                                    
          </Column>                                                                              
          <OpEQ>                                                                                 
            <StringVal><![CDATA[SingStar]]></StringVal>                                          
          </OpEQ>                                                                                
        </Range>                                                                                 
        <Range id='R1842' sqlType='VARCHAR(25) CHARACTER SET ISO88591 ALLOWS NULLS'>             
          <Column ref='C473'>                                                                    
          </Column>                                                                              
          <OpEQ>                                                                                 
            <StringVal><![CDATA[Song - Amy Winehouse, Rehab]]></StringVal>                       
          </OpEQ>                                                                                
        </Range>                                                                                 
      </RangePredList>                                                                           
    </Hub>                                                                                       
    <ExtraHub>                                                                                   
    </ExtraHub>                                                                                  
    <OutputList>                                                                                 
      <Output id='O916'>                                                                         
        <Expr id='X916'>                                                                         
          <Function id='S916' op='sum' aggregateFunc='3'>                                        
            <Column id='C91' tableId='T5' colIndex='21' isNullable='0'>                          
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.QUANTITY                                        
            </Column>                                                                            
          </Function>                                                                            
        </Expr>                                                                                  
      </Output>                                                                                  
      <Output id='O917'>                                                                         
        <Expr id='X917'>                                                                         
          <Function id='S917' op='sum' aggregateFunc='3'>                                        
            <Column id='C93' tableId='T5' colIndex='23'>                                         
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD                               
            </Column>                                                                            
          </Function>                                                                            
        </Expr>                                                                                  
      </Output>                                                                                  
      <Output id='O918'>                                                                         
        <Expr id='X918'>                                                                         
          <Function id='S918' op='sum' aggregateFunc='3'>                                        
            <Column id='C226' tableId='T4' colIndex='2' isNullable='0'>                          
              CAT.SCEE.DIM_DT.AGGR_LEVEL_NUM                                                     
            </Column>                                                                            
          </Function>                                                                            
        </Expr>                                                                                  
      </Output>                                                                                  
      <Output id='O934'>                                                                         
        <Column ref='C3'>                                                                        
        </Column>                                                                                
      </Output>                                                                                  
      <Output id='O1196'>                                                                        
        <Column ref='C241'>                                                                      
        </Column>                                                                                
      </Output>                                                                                  
      <Output id='O1411'>                                                                        
        <Column ref='C473'>                                                                      
        </Column>                                                                                
      </Output>                                                                                  
      <Output id='O1646'>                                                                        
        <Column ref='C778'>                                                                      
        </Column>                                                                                
      </Output>                                                                                  
    </OutputList>                                                                                
    <GroupBy id='G8'>                                                                            
      <Primary>                                                                                  
        <Column id='C3' tableId='T7' colIndex='2' isNullable='0'>                                
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME                                            
        </Column>                                                                                
        <Column id='C4' tableId='T7' colIndex='3' isNullable='0'>                                
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE                                         
        </Column>                                                                                
        <Column id='C241' tableId='T4' colIndex='17' isNullable='0'>                             
          CAT.SCEE.DIM_DT.WEEK_END_DT                                                            
        </Column>                                                                                
        <Column id='C395' tableId='T3' colIndex='1'>                                             
          CAT.SCEE.DIM_TITLE.TITLE_NAME                                                          
        </Column>                                                                                
        <Column id='C473' tableId='T2' colIndex='9'>                                             
          CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_NAME                                                  
        </Column>                                                                                
        <Column id='C778' tableId='T1' colIndex='2'>                                             
          CAT.SCEE.DIM_ACCT.SOURCE_PSN_ACCT_ID                                                   
        </Column>                                                                                
      </Primary>                                                                                 
    </GroupBy>                                                                                   
  </JBB>                                                                                         
</Query>                                                                                         

--- 227 row(s) selected.
>>
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'OFF';

--- SQL operation complete.
>>
>>sh echo INITIALIZE           >> scee_q1x.in;
>>sh echo PUBLISH SCEE_MV1.xml >> scee_q1x.in;
>>sh echo PUBLISH SCEE_MV2.xml >> scee_q1x.in;
>>sh echo MATCH SCEE_Q1X.xml    >> scee_q1x.in;
>>
>>sh sh -c "$QMS scee_q1x.in scee.out";
>>
>>log;
<Result>
  <Version>
    1.0
  </Version>
</Result>
>>
>>obey TESTSCEE(match_Q2);
>>--===========================================
>>--== Mid Level Query
>>--===========================================
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'DUMP';

--- SQL operation complete.
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD) AS SALES_INC_VAT_USD
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>    )
+>INNER JOIN DIM_TITLE
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TITLE_ID = DIM_TITLE.TITLE_ID
+>    )
+>INNER JOIN DIM_PRODUCT_SKU
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID = DIM_PRODUCT_SKU.PRODUCT_SKU_ID
+>    )
+>WHERE
+>    DIM_DT.RELATIVE_MONTH_NUM = -1
+>AND DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE = 'SCEA'
+>AND DIM_TITLE.TITLE_NAME = 'SingStar'
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME ASC 
+>;

--- SQL command prepared.
>>
>>set pattern $$QueryName$$ SCEE_Q2;
>>obey TESTSCEE(dump_Query);
>>--===========================================
>>--== Create the query descriptor XML
>>--===========================================
>>
>>log $$QueryName$$.tmp clear;
>>sh sh ./CropDescriptor.ksh -q -i $$QueryName$$.TMP -o $$QueryName$$.xml;
>>-- and once for the test log file
>>execute QueryStmt;

Query Descriptor
-----------------------------------------------------------------------------------------

<Query>                                                                                  
  <Version>                                                                              
    1.0                                                                                  
  </Version>                                                                             
  <Misc rewriteLevel='3'>                                                                
  </Misc>                                                                                
  <JBB id='B0'>                                                                          
    <Hub>                                                                                
      <JBBCList>                                                                         
        <Table id='T6' TS='212223875581222002' numCols='10' rangeBits='00000001'>        
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER                                                 
          <Key>                                                                          
            <Column id='C1' tableId='T6' colIndex='0' isNullable='0'>                    
              CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE                            
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T5' TS='212223875583909932' numCols='8'>                              
          CAT.SCEE.DIM_DEMOGRAPHIC                                                       
          <Key>                                                                          
            <Column id='C38' tableId='T5' colIndex='0' isNullable='0'>                   
              CAT.SCEE.DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID                                    
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T3' TS='212223875583659892' numCols='45' rangeBits='0000000000000800'>
          CAT.SCEE.DIM_DT                                                                
          <Key>                                                                          
            <Column id='C224' tableId='T3' colIndex='0' isNullable='0'>                  
              CAT.SCEE.DIM_DT.DT_HRCHY_ID                                                
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T1' TS='212223875584394385' numCols='83'>                             
          CAT.SCEE.DIM_PRODUCT_SKU                                                       
          <Key>                                                                          
            <Column id='C464' tableId='T1' colIndex='0' isNullable='0'>                  
              CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_SKU_ID                                    
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T2' TS='212223875584019325' numCols='31' rangeBits='00000004'>        
          CAT.SCEE.DIM_TITLE                                                             
          <Key>                                                                          
            <Column id='C394' tableId='T2' colIndex='0' isNullable='0'>                  
              CAT.SCEE.DIM_TITLE.TITLE_ID                                                
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T4' TS='212223875584660052' numCols='52'>                             
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION                                             
          <Key>                                                                          
            <Column id='C70' tableId='T4' colIndex='0' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID                 
            </Column>                                                                    
            <Column id='C71' tableId='T4' colIndex='1' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DEVICE_TYPE_ID                          
            </Column>                                                                    
            <Column id='C72' tableId='T4' colIndex='2' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID                 
            </Column>                                                                    
            <Column id='C73' tableId='T4' colIndex='3' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TITLE_ID                                
            </Column>                                                                    
            <Column id='C74' tableId='T4' colIndex='4' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_ID                        
            </Column>                                                                    
            <Column id='C75' tableId='T4' colIndex='5' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_ID                          
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
      </JBBCList>                                                                        
      <JoinPredList>                                                                     
        <JoinPred id='J793'>                                                             
          <Column ref='C1'>                                                              
          </Column>                                                                      
          <Column id='C39' tableId='T5' colIndex='1' isNullable='0'>                     
            CAT.SCEE.DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE                                    
          </Column>                                                                      
        </JoinPred>                                                                      
        <JoinPred id='J823'>                                                             
          <Column ref='C38'>                                                             
          </Column>                                                                      
          <Column ref='C72'>                                                             
          </Column>                                                                      
        </JoinPred>                                                                      
        <JoinPred id='J850'>                                                             
          <Column ref='C224'>                                                            
          </Column>                                                                      
          <Column ref='C70'>                                                             
          </Column>                                                                      
        </JoinPred>                                                                      
        <JoinPred id='J859'>                                                             
          <Column ref='C394'>                                                            
          </Column>                                                                      
          <Column ref='C73'>                                                             
          </Column>                                                                      
        </JoinPred>                                                                      
        <JoinPred id='J889'>                                                             
          <Column ref='C464'>                                                            
          </Column>                                                                      
          <Column id='C83' tableId='T4' colIndex='13' isNullable='0'>                    
            CAT.SCEE.FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID                            
          </Column>                                                                      
        </JoinPred>                                                                      
      </JoinPredList>                                                                    
      <RangePredList>                                                                    
        <Range id='R1553' sqlType='CHAR(7) CHARACTER SET ISO88591 NO NULLS'>             
          <Column ref='C4'>                                                              
          </Column>                                                                      
          <OpEQ>                                                                         
            <StringVal><![CDATA[SCEA]]></StringVal>                                      
          </OpEQ>                                                                        
        </Range>                                                                         
        <Range id='R1554' sqlType='INTEGER SIGNED ALLOWS NULLS'>                         
          <Column id='C264' tableId='T3' colIndex='40'>                                  
            CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM                                           
          </Column>                                                                      
          <OpEQ>                                                                         
            <NumericVal scale='0'>                                                       
              -1                                                                         
            </NumericVal>                                                                
          </OpEQ>                                                                        
        </Range>                                                                         
        <Range id='R1555' sqlType='CHAR(60) CHARACTER SET ISO88591 ALLOWS NULLS'>        
          <Column ref='C395'>                                                            
          </Column>                                                                      
          <OpEQ>                                                                         
            <StringVal><![CDATA[SingStar]]></StringVal>                                  
          </OpEQ>                                                                        
        </Range>                                                                         
      </RangePredList>                                                                   
    </Hub>                                                                               
    <ExtraHub>                                                                           
    </ExtraHub>                                                                          
    <OutputList>                                                                         
      <Output id='O784'>                                                                 
        <Expr id='X784'>                                                                 
          <Function id='S784' op='sum' aggregateFunc='3'>                                
            <Column id='C91' tableId='T4' colIndex='21' isNullable='0'>                  
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.QUANTITY                                
            </Column>                                                                    
          </Function>                                                                    
        </Expr>                                                                          
      </Output>                                                                          
      <Output id='O785'>                                                                 
        <Expr id='X785'>                                                                 
          <Function id='S785' op='sum' aggregateFunc='3'>                                
            <Column id='C93' tableId='T4' colIndex='23'>                                 
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD                       
            </Column>                                                                    
          </Function>                                                                    
        </Expr>                                                                          
      </Output>                                                                          
      <Output id='O799'>                                                                 
        <Column ref='C3'>                                                                
        </Column>                                                                        
      </Output>                                                                          
      <Output id='O1061'>                                                                
        <Column ref='C241'>                                                              
        </Column>                                                                        
      </Output>                                                                          
      <Output id='O1276'>                                                                
        <Column ref='C473'>                                                              
        </Column>                                                                        
      </Output>                                                                          
    </OutputList>                                                                        
    <GroupBy id='G7'>                                                                    
      <Primary>                                                                          
        <Column id='C3' tableId='T6' colIndex='2' isNullable='0'>                        
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME                                    
        </Column>                                                                        
        <Column id='C4' tableId='T6' colIndex='3' isNullable='0'>                        
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE                                 
        </Column>                                                                        
        <Column id='C241' tableId='T3' colIndex='17' isNullable='0'>                     
          CAT.SCEE.DIM_DT.WEEK_END_DT                                                    
        </Column>                                                                        
        <Column id='C395' tableId='T2' colIndex='1'>                                     
          CAT.SCEE.DIM_TITLE.TITLE_NAME                                                  
        </Column>                                                                        
        <Column id='C473' tableId='T1' colIndex='9'>                                     
          CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_NAME                                          
        </Column>                                                                        
      </Primary>                                                                         
    </GroupBy>                                                                           
  </JBB>                                                                                 
</Query>                                                                                 

--- 189 row(s) selected.
>>
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'OFF';

--- SQL operation complete.
>>
>>sh echo INITIALIZE           >> scee_q2.in;
>>sh echo PUBLISH SCEE_MV1.xml >> scee_q2.in;
>>sh echo PUBLISH SCEE_MV2.xml >> scee_q2.in;
>>sh echo MATCH SCEE_Q2.xml    >> scee_q2.in;
>>
>>sh sh -c "$QMS scee_q2.in scee.out";
>>
>>log;
<Result>
  <Version>
    1.0
  </Version>
  <JbbResult ref='B0'>
    <JbbSubset ref='G7' hasGroupby='1'>
      <TableList>
        <Table ref='T4'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION
        </Table>
      </TableList>
      <CandidateList>
        <Candidate isPreferredMatch='0' isIndirectGroupBy='1' statsOnly='0'>
          <MVName TS='0'>
            CAT.SCEE.SCEE_MV1
          </MVName>
          <RangePredList>
            <Range ref='R1553' result='NotProvided'>
              <Column ref='C4' tableId='T6'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE
              </Column>
            </Range>
            <Range ref='R1554' result='NotProvided'>
              <Column ref='C264' tableId='T3'>
                CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM
              </Column>
            </Range>
            <Range ref='R1555' result='NotProvided'>
              <Column ref='C395' tableId='T2'>
                CAT.SCEE.DIM_TITLE.TITLE_NAME
              </Column>
            </Range>
          </RangePredList>
          <GroupBy ref='G7' result='NotProvided'>
            <Primary>
              <Column ref='C3' tableId='T6'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME
              </Column>
              <Column ref='C4' tableId='T6'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE
              </Column>
              <Column ref='C241' tableId='T3'>
                CAT.SCEE.DIM_DT.WEEK_END_DT
              </Column>
              <Column ref='C395' tableId='T2'>
                CAT.SCEE.DIM_TITLE.TITLE_NAME
              </Column>
              <Column ref='C473' tableId='T1'>
                CAT.SCEE.DIM_PRODUCT_SKU.PRODUCT_NAME
              </Column>
            </Primary>
          </GroupBy>
          <OutputList>
            <Output ref='C72' result='Provided'>
              <MVColumn ref='C72'>
                BILLABLE_DEMOGRAPHIC_ID
              </MVColumn>
            </Output>
            <Output ref='C70' result='Provided'>
              <MVColumn ref='C70'>
                TRANSACTION_LOCAL_DT_ID
              </MVColumn>
            </Output>
            <Output ref='C73' result='Provided'>
              <MVColumn ref='C73'>
                TITLE_ID
              </MVColumn>
            </Output>
            <Output ref='C83' result='Provided'>
              <MVColumn ref='C83'>
                PRODUCT_SKU_ID
              </MVColumn>
            </Output>
            <Output ref='O785' result='NotProvided'>
              <Expr ref='X785'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S785'>
                    SALES_INC_VAT_USD
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
            <Output ref='O784' result='NotProvided'>
              <Expr ref='X784'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S784'>
                    QUANTITY
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
          </OutputList>
        </Candidate>
      </CandidateList>
    </JbbSubset>
  </JbbResult>
</Result>
>>
>>obey TESTSCEE(match_Q3);
>>--===========================================
>>--== High Level Query
>>--===========================================
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'DUMP';

--- SQL operation complete.
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD ) AS SALES_INC_VAT_USD
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>    )
+>WHERE
+>    DIM_DT.RELATIVE_MONTH_NUM = -1
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC 
+>;

--- SQL command prepared.
>>
>>set pattern $$QueryName$$ SCEE_Q3;
>>obey TESTSCEE(dump_Query);
>>--===========================================
>>--== Create the query descriptor XML
>>--===========================================
>>
>>log $$QueryName$$.tmp clear;
>>sh sh ./CropDescriptor.ksh -q -i $$QueryName$$.TMP -o $$QueryName$$.xml;
>>-- and once for the test log file
>>execute QueryStmt;

Query Descriptor
-----------------------------------------------------------------------------------------

<Query>                                                                                  
  <Version>                                                                              
    1.0                                                                                  
  </Version>                                                                             
  <Misc rewriteLevel='3'>                                                                
  </Misc>                                                                                
  <JBB id='B0'>                                                                          
    <Hub>                                                                                
      <JBBCList>                                                                         
        <Table id='T4' TS='212223875581222002' numCols='10'>                             
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER                                                 
          <Key>                                                                          
            <Column id='C1' tableId='T4' colIndex='0' isNullable='0'>                    
              CAT.SCEE.DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE                            
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T3' TS='212223875583909932' numCols='8'>                              
          CAT.SCEE.DIM_DEMOGRAPHIC                                                       
          <Key>                                                                          
            <Column id='C38' tableId='T3' colIndex='0' isNullable='0'>                   
              CAT.SCEE.DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID                                    
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T1' TS='212223875583659892' numCols='45' rangeBits='0000000000000800'>
          CAT.SCEE.DIM_DT                                                                
          <Key>                                                                          
            <Column id='C224' tableId='T1' colIndex='0' isNullable='0'>                  
              CAT.SCEE.DIM_DT.DT_HRCHY_ID                                                
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
        <Table id='T2' TS='212223875584660052' numCols='52'>                             
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION                                             
          <Key>                                                                          
            <Column id='C70' tableId='T2' colIndex='0' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID                 
            </Column>                                                                    
            <Column id='C71' tableId='T2' colIndex='1' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.DEVICE_TYPE_ID                          
            </Column>                                                                    
            <Column id='C72' tableId='T2' colIndex='2' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID                 
            </Column>                                                                    
            <Column id='C73' tableId='T2' colIndex='3' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TITLE_ID                                
            </Column>                                                                    
            <Column id='C74' tableId='T2' colIndex='4' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_ID                        
            </Column>                                                                    
            <Column id='C75' tableId='T2' colIndex='5' isNullable='0'>                   
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.TRANSACTION_ID                          
            </Column>                                                                    
          </Key>                                                                         
        </Table>                                                                         
      </JBBCList>                                                                        
      <JoinPredList>                                                                     
        <JoinPred id='J402'>                                                             
          <Column ref='C1'>                                                              
          </Column>                                                                      
          <Column id='C39' tableId='T3' colIndex='1' isNullable='0'>                     
            CAT.SCEE.DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE                                    
          </Column>                                                                      
        </JoinPred>                                                                      
        <JoinPred id='J432'>                                                             
          <Column ref='C38'>                                                             
          </Column>                                                                      
          <Column ref='C72'>                                                             
          </Column>                                                                      
        </JoinPred>                                                                      
        <JoinPred id='J459'>                                                             
          <Column ref='C224'>                                                            
          </Column>                                                                      
          <Column ref='C70'>                                                             
          </Column>                                                                      
        </JoinPred>                                                                      
      </JoinPredList>                                                                    
      <RangePredList>                                                                    
        <Range id='R787' sqlType='INTEGER SIGNED ALLOWS NULLS'>                          
          <Column id='C264' tableId='T1' colIndex='40'>                                  
            CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM                                           
          </Column>                                                                      
          <OpEQ>                                                                         
            <NumericVal scale='0'>                                                       
              -1                                                                         
            </NumericVal>                                                                
          </OpEQ>                                                                        
        </Range>                                                                         
      </RangePredList>                                                                   
    </Hub>                                                                               
    <ExtraHub>                                                                           
    </ExtraHub>                                                                          
    <OutputList>                                                                         
      <Output id='O398'>                                                                 
        <Expr id='X398'>                                                                 
          <Function id='S398' op='sum' aggregateFunc='3'>                                
            <Column id='C91' tableId='T2' colIndex='21' isNullable='0'>                  
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.QUANTITY                                
            </Column>                                                                    
          </Function>                                                                    
        </Expr>                                                                          
      </Output>                                                                          
      <Output id='O399'>                                                                 
        <Expr id='X399'>                                                                 
          <Function id='S399' op='sum' aggregateFunc='3'>                                
            <Column id='C93' tableId='T2' colIndex='23'>                                 
              CAT.SCEE.FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD                       
            </Column>                                                                    
          </Function>                                                                    
        </Expr>                                                                          
      </Output>                                                                          
      <Output id='O411'>                                                                 
        <Column ref='C4'>                                                                
        </Column>                                                                        
      </Output>                                                                          
      <Output id='O670'>                                                                 
        <Column ref='C241'>                                                              
        </Column>                                                                        
      </Output>                                                                          
    </OutputList>                                                                        
    <GroupBy id='G5'>                                                                    
      <Primary>                                                                          
        <Column id='C4' tableId='T4' colIndex='3' isNullable='0'>                        
          CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE                                 
        </Column>                                                                        
        <Column id='C241' tableId='T1' colIndex='17' isNullable='0'>                     
          CAT.SCEE.DIM_DT.WEEK_END_DT                                                    
        </Column>                                                                        
      </Primary>                                                                         
    </GroupBy>                                                                           
  </JBB>                                                                                 
</Query>                                                                                 

--- 133 row(s) selected.
>>
>>
>>control query default MVQR_LOG_QUERY_DESCRIPTORS 'OFF';

--- SQL operation complete.
>>
>>sh echo INITIALIZE           >> scee_q3.in;
>>sh echo PUBLISH SCEE_MV1.xml >> scee_q3.in;
>>sh echo PUBLISH SCEE_MV2.xml >> scee_q3.in;
>>sh echo MATCH SCEE_Q3.xml    >> scee_q3.in;
>>
>>sh sh -c "$QMS scee_q3.in scee.out";
>>
>>log;
<Result>
  <Version>
    1.0
  </Version>
  <JbbResult ref='B0'>
    <JbbSubset ref='G5' hasGroupby='1'>
      <TableList>
        <Table ref='T2'>
          CAT.SCEE.FCT_PSN_STORE_TRANSACTION
        </Table>
      </TableList>
      <CandidateList>
        <Candidate isPreferredMatch='0' isIndirectGroupBy='1' statsOnly='0'>
          <MVName TS='0'>
            CAT.SCEE.SCEE_MV1
          </MVName>
          <RangePredList>
            <Range ref='R787' result='NotProvided'>
              <Column ref='C264' tableId='T1'>
                CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM
              </Column>
            </Range>
          </RangePredList>
          <GroupBy ref='G5' result='NotProvided'>
            <Primary>
              <Column ref='C4' tableId='T4'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE
              </Column>
              <Column ref='C241' tableId='T1'>
                CAT.SCEE.DIM_DT.WEEK_END_DT
              </Column>
            </Primary>
          </GroupBy>
          <OutputList>
            <Output ref='C72' result='Provided'>
              <MVColumn ref='C72'>
                BILLABLE_DEMOGRAPHIC_ID
              </MVColumn>
            </Output>
            <Output ref='C70' result='Provided'>
              <MVColumn ref='C70'>
                TRANSACTION_LOCAL_DT_ID
              </MVColumn>
            </Output>
            <Output ref='O399' result='NotProvided'>
              <Expr ref='X399'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S399'>
                    SALES_INC_VAT_USD
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
            <Output ref='O398' result='NotProvided'>
              <Expr ref='X398'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S398'>
                    QUANTITY
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
          </OutputList>
        </Candidate>
        <Candidate isPreferredMatch='0' isIndirectGroupBy='1' statsOnly='0'>
          <MVName TS='0'>
            CAT.SCEE.SCEE_MV2
          </MVName>
          <RangePredList>
            <Range ref='R787' result='NotProvided'>
              <Column ref='C264' tableId='T1'>
                CAT.SCEE.DIM_DT.RELATIVE_MONTH_NUM
              </Column>
            </Range>
          </RangePredList>
          <GroupBy ref='G5' result='NotProvided'>
            <Primary>
              <Column ref='C4' tableId='T4'>
                CAT.SCEE.DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE
              </Column>
              <Column ref='C241' tableId='T1'>
                CAT.SCEE.DIM_DT.WEEK_END_DT
              </Column>
            </Primary>
          </GroupBy>
          <OutputList>
            <Output ref='C72' result='Provided'>
              <MVColumn ref='C72'>
                BILLABLE_DEMOGRAPHIC_ID
              </MVColumn>
            </Output>
            <Output ref='C70' result='Provided'>
              <MVColumn ref='C70'>
                TRANSACTION_LOCAL_DT_ID
              </MVColumn>
            </Output>
            <Output ref='O399' result='NotProvided'>
              <Expr ref='X399'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S399'>
                    SALES_INC_VAT_USD
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
            <Output ref='O398' result='NotProvided'>
              <Expr ref='X398'>
                <Function op='sum' aggregateFunc='3'>
                  <MVColumn ref='S398'>
                    QUANTITY
                  </MVColumn>
                </Function>
              </Expr>
            </Output>
          </OutputList>
        </Candidate>
      </CandidateList>
    </JbbSubset>
  </JbbResult>
</Result>
>>
>>
>>
>>obey TESTSCEE(check_plan_Q1);
>>--===========================================
>>--== Low Level Query
>>--===========================================
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    DIM_ACCT.SOURCE_PSN_ACCT_ID,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD) AS SALES_INC_VAT_USD
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>        --FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.day_of_week
+>    )
+>INNER JOIN DIM_TITLE
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TITLE_ID = DIM_TITLE.TITLE_ID
+>    )
+>INNER JOIN DIM_PRODUCT_SKU
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID = DIM_PRODUCT_SKU.PRODUCT_SKU_ID
+>    )
+>INNER JOIN DIM_ACCT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.BILLABLE_ACCT_AGE_ID = DIM_ACCT.ACCT_ID
+>    )
+>WHERE
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE = 'SCEA'
+>AND DIM_DT.RELATIVE_MONTH_NUM = -1
+>AND DIM_TITLE.TITLE_NAME = 'SingStar'
+>AND DIM_PRODUCT_SKU.PRODUCT_NAME = 'Song - Amy Winehouse, Rehab'
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    DIM_ACCT.SOURCE_PSN_ACCT_ID
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME ASC ;

--- SQL command prepared.
>>
>>execute checkPlan;

OPERATOR                        TNAME
------------------------------  ------------------------------------------------------------

FILE_SCAN                       CAT.SCEE.DIM_ACCT                                           
FILE_SCAN                       CAT.SCEE.DIM_COUNTRY_OUTRIGGER                              
FILE_SCAN                       CAT.SCEE.DIM_DEMOGRAPHIC                                    
FILE_SCAN                       CAT.SCEE.DIM_DT                                             
FILE_SCAN                       CAT.SCEE.DIM_PRODUCT_SKU                                    
FILE_SCAN                       CAT.SCEE.DIM_TITLE                                          
FILE_SCAN                       CAT.SCEE.SCEE_MV1                                           

--- 7 row(s) selected.
>>
>>obey TESTSCEE(check_plan_Q2);
>>--===========================================
>>--== Mid Level Query
>>--===========================================
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD) AS SALES_INC_VAT_USD
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>    )
+>INNER JOIN DIM_TITLE
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TITLE_ID = DIM_TITLE.TITLE_ID
+>    )
+>INNER JOIN DIM_PRODUCT_SKU
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.PRODUCT_SKU_ID = DIM_PRODUCT_SKU.PRODUCT_SKU_ID
+>    )
+>WHERE
+>    DIM_DT.RELATIVE_MONTH_NUM = -1
+>AND DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE = 'SCEA'
+>AND DIM_TITLE.TITLE_NAME = 'SingStar'
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    DIM_COUNTRY_OUTRIGGER.COUNTRY_NAME,
+>    DIM_TITLE.TITLE_NAME,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC,
+>    DIM_PRODUCT_SKU.PRODUCT_NAME ASC 
+>;

--- SQL command prepared.
>>
>>execute checkPlan;

OPERATOR                        TNAME
------------------------------  ------------------------------------------------------------

FILE_SCAN                       CAT.SCEE.DIM_COUNTRY_OUTRIGGER                              
FILE_SCAN                       CAT.SCEE.DIM_DEMOGRAPHIC                                    
FILE_SCAN                       CAT.SCEE.DIM_DT                                             
FILE_SCAN                       CAT.SCEE.DIM_PRODUCT_SKU                                    
FILE_SCAN                       CAT.SCEE.DIM_TITLE                                          
FILE_SCAN                       CAT.SCEE.SCEE_MV1                                           

--- 6 row(s) selected.
>>
>>obey TESTSCEE(check_plan_Q3);
>>--===========================================
>>--== High Level Query
>>--===========================================
>>
>>prepare QueryStmt from
+>SELECT
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT,
+>    SUM(FCT_PSN_STORE_TRANSACTION.QUANTITY) AS QUANTITY,
+>    SUM(FCT_PSN_STORE_TRANSACTION.SALES_INC_VAT_USD ) AS SALES_INC_VAT_USD
+>FROM
+>    DIM_COUNTRY_OUTRIGGER
+>INNER JOIN DIM_DEMOGRAPHIC
+>ON
+>    (
+>        DIM_COUNTRY_OUTRIGGER.COUNTRY_ISO_CODE = DIM_DEMOGRAPHIC.COUNTRY_ISO_CODE
+>    )
+>INNER JOIN FCT_PSN_STORE_TRANSACTION
+>ON
+>    (
+>        DIM_DEMOGRAPHIC.DEMOGRAPHIC_ID = FCT_PSN_STORE_TRANSACTION.BILLABLE_DEMOGRAPHIC_ID
+>    )
+>INNER JOIN DIM_DT
+>ON
+>    (
+>        FCT_PSN_STORE_TRANSACTION.TRANSACTION_LOCAL_DT_ID = DIM_DT.DT_HRCHY_ID
+>    )
+>WHERE
+>    DIM_DT.RELATIVE_MONTH_NUM = -1
+>GROUP BY
+>    DIM_COUNTRY_OUTRIGGER.SCE_REGION_CODE,
+>    DIM_DT.WEEK_END_DT
+>ORDER BY
+>    DIM_DT.WEEK_END_DT ASC 
+>;

--- SQL command prepared.
>>
>>execute checkPlan;

OPERATOR                        TNAME
------------------------------  ------------------------------------------------------------

FILE_SCAN                       CAT.SCEE.DIM_COUNTRY_OUTRIGGER                              
FILE_SCAN                       CAT.SCEE.DIM_DEMOGRAPHIC                                    
FILE_SCAN                       CAT.SCEE.DIM_DT                                             
FILE_SCAN                       CAT.SCEE.SCEE_MV2                                           

--- 4 row(s) selected.
>>
>>
>>obey TESTSCEE(clean_up);
>>----------------------------------------------------
>>------------------ clean up section ----------------
>>----------------------------------------------------
>>drop schema scee cascade;

--- SQL operation complete.
>>
>>
>>exit;

End of MXCI Session

