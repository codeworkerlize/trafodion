-- @@@ START COPYRIGHT @@@ 
--
-- Licensed to the Apache Software Foundation (ASF) under one 
-- or more contributor license agreements.  See the NOTICE file
-- distributed with this work for additional information
-- regarding copyright ownership.  The ASF licenses this file
-- to you under the Apache License, Version 2.0 (the
-- "License"); you may not use this file except in compliance
-- with the License.  You may obtain a copy of the License at
--
--   http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing,
-- software distributed under the License is distributed on an
-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY 
-- KIND, either express or implied.  See the License for the 
-- specific language governing permissions and limitations
-- under the License.
--
-- @@@ END COPYRIGHT @@@ 

-- Tests for update statistics table like


log LOG043 clear;

drop table if exists gen_stats_t231;
drop table if exists gen_stats_t111;

create table gen_stats_t111(c1 varchar(10));
create table gen_stats_t231(c1 varchar(15));
update statistics for table gen_stats_t231 like gen_stats_t111;

drop table gen_stats_t231;
drop table gen_stats_t111;

create table gen_stats_t111(c1 number(10,5));
create table gen_stats_t231(c1 numeric(10,6));
update statistics for table gen_stats_t231 like gen_stats_t111;

drop table gen_stats_t231;
drop table gen_stats_t111;

create table gen_stats_t111(c1 int, c2 int);
create table gen_stats_t231 like gen_stats_t111;
explain options 'f' select count(*) from gen_stats_t231 where c2 > 5;

insert into gen_stats_t111 values(1,1);
update statistics for table gen_stats_t111 on every column;
update statistics for table gen_stats_t231 like gen_stats_t111;
explain options 'f' select count(*) from gen_stats_t231 where c2 > 5;

drop table gen_stats_t231;
drop table gen_stats_t111;

-- Test for Row Key Max Length Limitation with(out) Salt partitions
drop table if exists TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY;
drop schema if exists IFL;
create schema IFL;

-- case 1: use salt partitions and row key length >= 1490, throw exception!
CREATE TABLE TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY
  (
    ACT_SET_MRK NUMERIC(19, 0) DEFAULT NULL NOT SERIALIZED
  , SYS_ID VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_DT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_ORG VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ITM_CD VARCHAR(20 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CCY_CD VARCHAR(3 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , TOT_ACT_TYP VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DTY_CNTR VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , STAF_MEMB VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUST VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD_LINE VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_0 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_1 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_2 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_3 VARCHAR(1000 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_4 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_5 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_6 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_7 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_8 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_9 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , CRD_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , DBT_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CUR_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUR_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , LAST_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , LAST_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , IS_IT_FINA_ENC VARCHAR(1 BYTE) CHARACTER SET UTF8 COLLATE
      DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , ITM_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PART_CTRL VARCHAR(4 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_TAB VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_SYS VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ETL_DAT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PRIMARY KEY NULLABLE (ACT_SET_MRK ASC, SYS_ID ASC, ACT_DT ASC, ACT_ORG ASC,
    ITM_CD ASC, CCY_CD ASC, TOT_ACT_TYP ASC, DTY_CNTR ASC, STAF_MEMB ASC, CUST
    ASC, PROD ASC, PROD_LINE ASC, ACT ASC, ASST_ACT_0 ASC, ASST_ACT_1 ASC,
    ASST_ACT_2 ASC, ASST_ACT_3 ASC, ASST_ACT_4 ASC, ASST_ACT_5 ASC, ASST_ACT_6
    ASC, ASST_ACT_7 ASC, ASST_ACT_8 ASC, ASST_ACT_9 ASC, PART_CTRL ASC, ETL_DAT
    ASC)
  )
   SALT USING 21 PARTITIONS
   ATTRIBUTES ALIGNED FORMAT
   HBASE_OPTIONS
   (
       DATA_BLOCK_ENCODING = 'FAST_DIFF',
       COMPRESSION = 'SNAPPY',
       MEMSTORE_FLUSH_SIZE = '1073741824'
    )
;

-- case 2: use salt partitions and row key length < 1490, succeed!
drop table if exists TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY;
CREATE TABLE TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY
  (
    ACT_SET_MRK NUMERIC(19, 0) DEFAULT NULL NOT SERIALIZED
  , SYS_ID VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_DT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_ORG VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ITM_CD VARCHAR(20 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CCY_CD VARCHAR(3 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , TOT_ACT_TYP VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DTY_CNTR VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , STAF_MEMB VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUST VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD_LINE VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_0 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_1 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_2 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_3 VARCHAR(960 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_4 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_5 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_6 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_7 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_8 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_9 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , CRD_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , DBT_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CUR_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUR_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , LAST_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , LAST_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , IS_IT_FINA_ENC VARCHAR(1 BYTE) CHARACTER SET UTF8 COLLATE
      DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , ITM_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PART_CTRL VARCHAR(4 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_TAB VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_SYS VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ETL_DAT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PRIMARY KEY NULLABLE (ACT_SET_MRK ASC, SYS_ID ASC, ACT_DT ASC, ACT_ORG ASC,
    ITM_CD ASC, CCY_CD ASC, TOT_ACT_TYP ASC, DTY_CNTR ASC, STAF_MEMB ASC, CUST
    ASC, PROD ASC, PROD_LINE ASC, ACT ASC, ASST_ACT_0 ASC, ASST_ACT_1 ASC,
    ASST_ACT_2 ASC, ASST_ACT_3 ASC, ASST_ACT_4 ASC, ASST_ACT_5 ASC, ASST_ACT_6
    ASC, ASST_ACT_7 ASC, ASST_ACT_8 ASC, ASST_ACT_9 ASC, PART_CTRL ASC, ETL_DAT
    ASC)
  )
   SALT USING 21 PARTITIONS
   ATTRIBUTES ALIGNED FORMAT
   HBASE_OPTIONS
   (
       DATA_BLOCK_ENCODING = 'FAST_DIFF',
       COMPRESSION = 'SNAPPY',
       MEMSTORE_FLUSH_SIZE = '1073741824'
    )
;
DELETE FROM IFL.EV_NSM_Mult_Dim_lg_Day WHERE ETL_DAT = '20270925';

-- case 3: without salt partition clause, row key length greater than or equal to 1490 and less than 32000
drop table if exists TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY;
CREATE TABLE TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY
  (
    ACT_SET_MRK NUMERIC(19, 0) DEFAULT NULL NOT SERIALIZED
  , SYS_ID VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_DT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_ORG VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ITM_CD VARCHAR(20 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CCY_CD VARCHAR(3 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , TOT_ACT_TYP VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DTY_CNTR VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , STAF_MEMB VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUST VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD_LINE VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_0 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_1 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_2 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_3 VARCHAR(5000 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_4 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_5 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_6 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_7 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_8 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_9 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , CRD_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , DBT_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CUR_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUR_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , LAST_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , LAST_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , IS_IT_FINA_ENC VARCHAR(1 BYTE) CHARACTER SET UTF8 COLLATE
      DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , ITM_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PART_CTRL VARCHAR(4 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_TAB VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_SYS VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ETL_DAT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PRIMARY KEY NULLABLE (ACT_SET_MRK ASC, SYS_ID ASC, ACT_DT ASC, ACT_ORG ASC,
    ITM_CD ASC, CCY_CD ASC, TOT_ACT_TYP ASC, DTY_CNTR ASC, STAF_MEMB ASC, CUST
    ASC, PROD ASC, PROD_LINE ASC, ACT ASC, ASST_ACT_0 ASC, ASST_ACT_1 ASC,
    ASST_ACT_2 ASC, ASST_ACT_3 ASC, ASST_ACT_4 ASC, ASST_ACT_5 ASC, ASST_ACT_6
    ASC, ASST_ACT_7 ASC, ASST_ACT_8 ASC, ASST_ACT_9 ASC, PART_CTRL ASC, ETL_DAT
    ASC)
  )
;
DELETE FROM IFL.EV_NSM_Mult_Dim_lg_Day WHERE ETL_DAT = '20270925';

-- case 4: without salt partition clause, row key length greater than 32000, throw exception!
drop table if exists TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY;
CREATE TABLE TRAFODION.IFL.EV_NSM_MULT_DIM_LG_DAY
  (
    ACT_SET_MRK NUMERIC(19, 0) DEFAULT NULL NOT SERIALIZED
  , SYS_ID VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_DT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT_ORG VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ITM_CD VARCHAR(20 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CCY_CD VARCHAR(3 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , TOT_ACT_TYP VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DTY_CNTR VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , STAF_MEMB VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUST VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PROD_LINE VARCHAR(16 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ACT VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_0 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_1 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_2 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_3 VARCHAR(32000 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_4 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_5 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_6 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_7 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_8 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ASST_ACT_9 VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_UPPE_DAY_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , DBT_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , CRD_BOOK_DAY_AMT NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_TDAY_AMT_CNT NUMERIC(18, 0) DEFAULT NULL NOT SERIALIZED
  , DBT_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CUR_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , CUR_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , LAST_BAL_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , LAST_BAL NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , IS_IT_FINA_ENC VARCHAR(1 BYTE) CHARACTER SET UTF8 COLLATE
      DEFAULT DEFAULT NULL NOT SERIALIZED
  , DBT_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , CRD_AUD_ADJ_ENTR NUMERIC(18, 2) DEFAULT NULL NOT SERIALIZED
  , ITM_DIR VARCHAR(9 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PART_CTRL VARCHAR(4 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_TAB VARCHAR(30 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , SRC_SYS VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , ETL_DAT VARCHAR(10 BYTES) CHARACTER SET UTF8
      COLLATE DEFAULT DEFAULT NULL NOT SERIALIZED
  , PRIMARY KEY NULLABLE (ACT_SET_MRK ASC, SYS_ID ASC, ACT_DT ASC, ACT_ORG ASC,
    ITM_CD ASC, CCY_CD ASC, TOT_ACT_TYP ASC, DTY_CNTR ASC, STAF_MEMB ASC, CUST
    ASC, PROD ASC, PROD_LINE ASC, ACT ASC, ASST_ACT_0 ASC, ASST_ACT_1 ASC,
    ASST_ACT_2 ASC, ASST_ACT_3 ASC, ASST_ACT_4 ASC, ASST_ACT_5 ASC, ASST_ACT_6
    ASC, ASST_ACT_7 ASC, ASST_ACT_8 ASC, ASST_ACT_9 ASC, PART_CTRL ASC, ETL_DAT
    ASC)
  )
;
drop schema IFL;

log;
