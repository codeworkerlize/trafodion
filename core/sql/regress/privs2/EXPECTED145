>>obey TEST145(create_db);
>>-- =================================================================
>>-- add trafodion external tables, create native hive tables/views,
>>-- create roles
>>-- =================================================================
>>
>>-- create hive tables that can be changed
>>sh regrhive.ksh -v -f $REGRTSTDIR/t145.create.hive &>> $REGRRUNDIR/LOG145.hive.log;
>>obey TEST145 (load_tbls);
>>-- =================================================================
>>-- load data into hive tables
>>-- =================================================================
>>insert overwrite table hive.t145_sch.t145t1 values
+>  (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5), (6,6,6), (7,7,7), (8,8,8);

--- 8 row(s) inserted.
>>insert overwrite table hive.t145_sch.t145t2 values
+>  (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5), (6,6,6), (7,7,7), (8,8,8);

--- 8 row(s) inserted.
>>select * from hive.t145_sch.t145t1;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>select * from hive.t145_sch.t145t2;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>
>>
>>-- create views on hive tables
>>
>>create role t145_role1;

--- SQL operation complete.
>>create role t145_role2;

--- SQL operation complete.
>>create role t145_role3;

--- SQL operation complete.
>>
>>get tables in schema hive.t145_sch;

Tables in Schema HIVE.T145_SCH
==============================

t145t1
t145t2

--- SQL operation complete.
>>
>>obey TEST145(show_cmds);
>>-- =================================================================
>>-- show hive objects
>>-- =================================================================
>>showddl hive.hive.store;

/* Hive DDL */
CREATE EXTERNAL TABLE HIVE.HIVE.STORE
  (
    S_STORE_SK                       int
  , S_STORE_ID                       string
  , S_REC_START_DATE                 date
  , S_REC_END_DATE                   date
  , S_CLOSED_DATE_SK                 int
  , S_STORE_NAME                     string
  , S_NUMBER_EMPLOYEES               int
  , S_FLOOR_SPACE                    int
  , S_HOURS                          string
  , S_MANAGER                        string
  , S_MARKET_ID                      int
  , S_GEOGRAPHY_CLASS                string
  , S_MARKET_DESC                    string
  , S_MARKET_MANAGER                 string
  , S_DIVISION_ID                    int
  , S_DIVISION_NAME                  string
  , S_COMPANY_ID                     int
  , S_COMPANY_NAME                   string
  , S_STREET_NUMBER                  string
  , S_STREET_NAME                    string
  , S_STREET_TYPE                    string
  , S_SUITE_NUMBER                   string
  , S_CITY                           string
  , S_COUNTY                         string
  , S_STATE                          string
  , S_ZIP                            string
  , S_COUNTRY                        string
  , S_GMT_OFFSET                     float
  , S_TAX_PRECENTAGE                 float
  )
  stored as textfile
;

/* Trafodion DDL */

--- SQL operation complete.
>>showddl hive.hive.store_orc;

/* Hive DDL */
CREATE TABLE HIVE.HIVE.STORE_ORC
  (
    S_STORE_SK                       int
  , S_STORE_ID                       string
  , S_REC_START_DATE                 date
  , S_REC_END_DATE                   date
  , S_CLOSED_DATE_SK                 int
  , S_STORE_NAME                     string
  , S_NUMBER_EMPLOYEES               int
  , S_FLOOR_SPACE                    int
  , S_HOURS                          string
  , S_MANAGER                        string
  , S_MARKET_ID                      int
  , S_GEOGRAPHY_CLASS                string
  , S_MARKET_DESC                    string
  , S_MARKET_MANAGER                 string
  , S_DIVISION_ID                    int
  , S_DIVISION_NAME                  string
  , S_COMPANY_ID                     int
  , S_COMPANY_NAME                   string
  , S_STREET_NUMBER                  string
  , S_STREET_NAME                    string
  , S_STREET_TYPE                    string
  , S_SUITE_NUMBER                   string
  , S_CITY                           string
  , S_COUNTY                         string
  , S_STATE                          string
  , S_ZIP                            string
  , S_COUNTRY                        string
  , S_GMT_OFFSET                     float
  , S_TAX_PRECENTAGE                 float
  )
  stored as orc
;

/* Trafodion DDL */

--- SQL operation complete.
>>showddl hive.t145_sch.t145t1;

/* Hive DDL */
CREATE TABLE HIVE.T145_SCH.T145T1
  (
    A                                int
  , B                                int
  , C                                int
  )
  stored as textfile
;

/* Trafodion DDL */

--- SQL operation complete.
>>showddl hive.t145_sch.t145t2;

/* Hive DDL */
CREATE TABLE HIVE.T145_SCH.T145T2
  (
    A                                int
  , B                                int
  , C                                int
  )
  stored as orc
;

/* Trafodion DDL */

--- SQL operation complete.
>>
>>
>>obey TEST145(set_up);
>>-- =================================================================
>>-- Perform any specific setup information
>>-- =================================================================
>>select grantor_id, component_uid, operation_code  
+>  from "_PRIVMGR_MD_".component_privileges where grantee_id = -1;

GRANTOR_ID   COMPONENT_UID         OPERATION_CODE
-----------  --------------------  --------------

      33333                     1  CH            
      33333                     1  SW            

--- 2 row(s) selected.
>>
>>revoke component privilege "SHOW" on sql_operations from "PUBLIC";

--- SQL operation complete.
>>select grantor_id, component_uid, operation_code  
+>  from "_PRIVMGR_MD_".component_privileges where grantee_id = -1;

GRANTOR_ID   COMPONENT_UID         OPERATION_CODE
-----------  --------------------  --------------

      33333                     1  CH            

--- 1 row(s) selected.
>>
>>revoke component privilege "CREATE_SCHEMA" on sql_operations from "PUBLIC";

--- SQL operation complete.
>>select grantor_id, component_uid, operation_code  
+>  from "_PRIVMGR_MD_".component_privileges where grantee_id = -1;

--- 0 row(s) selected.
>>
>>get privileges on component sql_operations for "PUBLIC";

--- SQL operation complete.
>>
>>grant role DB__HIVEROLE to sql_user5;

--- SQL operation complete.
>>grant role t145_role3 to sql_user5;

--- SQL operation complete.
>>showddl role DB__HIVEROLE;

CREATE ROLE "DB__HIVEROLE";
  -- GRANT ROLE "DB__HIVEROLE" TO "DB__ROOT" WITH ADMIN OPTION;
GRANT ROLE
  "DB__HIVEROLE" TO "SQL_USER5";

--- SQL operation complete.
>>
>>grant role t145_role2 to sql_user6;

--- SQL operation complete.
>>grant component privilege "SHOW" on sql_operations to sql_user6;

--- SQL operation complete.
>>grant component privilege "CREATE_SCHEMA" on sql_operations to t145_role3;

--- SQL operation complete.
>>
>>obey TEST145(ext_tbls);
>>-- =================================================================
>>-- Verify external tables are created as designed
>>-- =================================================================
>>
>>-- create an external table on hive.hive.store by a user with no privs
>>sh sqlci -i "TEST145(create_ext_table)" -u sql_user2;
>>
>>values(user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER2                                                                                                                       

--- 1 row(s) selected.
>>create external table store for hive.hive.store;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>showddl hive.hive.store;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>
>>exit;

End of MXCI Session

>>-- create an external table by DB__ROOT
>>create external table store_orc for hive.hive.store_orc;

--- SQL operation complete.
>>showddl hive.hive.store_orc;

/* Hive DDL */
CREATE TABLE HIVE.HIVE.STORE_ORC
  (
    S_STORE_SK                       int
  , S_STORE_ID                       string
  , S_REC_START_DATE                 date
  , S_REC_END_DATE                   date
  , S_CLOSED_DATE_SK                 int
  , S_STORE_NAME                     string
  , S_NUMBER_EMPLOYEES               int
  , S_FLOOR_SPACE                    int
  , S_HOURS                          string
  , S_MANAGER                        string
  , S_MARKET_ID                      int
  , S_GEOGRAPHY_CLASS                string
  , S_MARKET_DESC                    string
  , S_MARKET_MANAGER                 string
  , S_DIVISION_ID                    int
  , S_DIVISION_NAME                  string
  , S_COMPANY_ID                     int
  , S_COMPANY_NAME                   string
  , S_STREET_NUMBER                  string
  , S_STREET_NAME                    string
  , S_STREET_TYPE                    string
  , S_SUITE_NUMBER                   string
  , S_CITY                           string
  , S_COUNTY                         string
  , S_STATE                          string
  , S_ZIP                            string
  , S_COUNTRY                        string
  , S_GMT_OFFSET                     float
  , S_TAX_PRECENTAGE                 float
  )
  stored as orc
;

/* Trafodion DDL */

REGISTER /*INTERNAL*/ HIVE TABLE HIVE.HIVE.STORE_ORC;
/* ObjectUID = 785504836339534968 */

CREATE EXTERNAL TABLE STORE_ORC
  FOR HIVE.HIVE.STORE_ORC


;

-- GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON HIVE.HIVE.STORE_ORC TO DB__HIVEROLE WITH GRANT OPTION;

--- SQL operation complete.
>>-- create an external table by user with hive admin privs
>>sh sqlci -i "TEST145(create_ext_table)" -u sql_user5;
>>
>>values(user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER5                                                                                                                       

--- 1 row(s) selected.
>>create external table store for hive.hive.store;

--- SQL operation complete.
>>showddl hive.hive.store;

/* Hive DDL */
CREATE EXTERNAL TABLE HIVE.HIVE.STORE
  (
    S_STORE_SK                       int
  , S_STORE_ID                       string
  , S_REC_START_DATE                 date
  , S_REC_END_DATE                   date
  , S_CLOSED_DATE_SK                 int
  , S_STORE_NAME                     string
  , S_NUMBER_EMPLOYEES               int
  , S_FLOOR_SPACE                    int
  , S_HOURS                          string
  , S_MANAGER                        string
  , S_MARKET_ID                      int
  , S_GEOGRAPHY_CLASS                string
  , S_MARKET_DESC                    string
  , S_MARKET_MANAGER                 string
  , S_DIVISION_ID                    int
  , S_DIVISION_NAME                  string
  , S_COMPANY_ID                     int
  , S_COMPANY_NAME                   string
  , S_STREET_NUMBER                  string
  , S_STREET_NAME                    string
  , S_STREET_TYPE                    string
  , S_SUITE_NUMBER                   string
  , S_CITY                           string
  , S_COUNTY                         string
  , S_STATE                          string
  , S_ZIP                            string
  , S_COUNTRY                        string
  , S_GMT_OFFSET                     float
  , S_TAX_PRECENTAGE                 float
  )
  stored as textfile
;

/* Trafodion DDL */

REGISTER /*INTERNAL*/ HIVE TABLE HIVE.HIVE.STORE;
/* ObjectUID = 4314075144480321588 */

CREATE EXTERNAL TABLE STORE
  FOR HIVE.HIVE.STORE


;

-- GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON HIVE.HIVE.STORE TO DB__HIVEROLE WITH GRANT OPTION;
  GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON
  HIVE.HIVE.STORE TO SQL_USER5 WITH GRANT OPTION;

--- SQL operation complete.
>>
>>exit;

End of MXCI Session

>>
>>obey TEST145(test_grants);
>>-- =================================================================
>>-- this set of tests run basic grant tests for native Hive tables
>>-- =================================================================
>>
>>-- grant a privilege where user has no grant privilege
>>sh sqlci -i "TEST145(grant_store)" -u sql_user3;
>>
>>values(user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER3                                                                                                                       

--- 1 row(s) selected.
>>grant all on hive.hive.store to t145_role1 by db__hiverole;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>grant all on hive.hive.store_orc to t145_role1 by db__hiverole;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>grant all on hive.hive.store to sql_user1 with grant option by db__hiverole;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>grant all on hive.hive.store_orc to sql_user1 with grant option by db__hiverole;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>grant select(s_store_sk, s_number_employees) on hive.hive.store to sql_user3 by db__hiverole;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>grant select on hive.hive.store_orc to sql_user3 by db__hiverole;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>showddl hive.hive.store;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>showddl hive.hive.store_orc;

*** ERROR[1017] You are not authorized to perform this operation.

--- SQL operation failed with errors.
>>
>>exit;

End of MXCI Session

>>
>>-- grant privileges for the hive admin user
>>sh sqlci -i "TEST145(grant_store)" -u sql_user5;
>>
>>values(user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER5                                                                                                                       

--- 1 row(s) selected.
>>grant all on hive.hive.store to t145_role1 by db__hiverole;

--- SQL operation complete.
>>grant all on hive.hive.store_orc to t145_role1 by db__hiverole;

--- SQL operation complete.
>>grant all on hive.hive.store to sql_user1 with grant option by db__hiverole;

--- SQL operation complete.
>>grant all on hive.hive.store_orc to sql_user1 with grant option by db__hiverole;

--- SQL operation complete.
>>grant select(s_store_sk, s_number_employees) on hive.hive.store to sql_user3 by db__hiverole;

--- SQL operation complete.
>>grant select on hive.hive.store_orc to sql_user3 by db__hiverole;

--- SQL operation complete.
>>showddl hive.hive.store;

/* Hive DDL */
CREATE EXTERNAL TABLE HIVE.HIVE.STORE
  (
    S_STORE_SK                       int
  , S_STORE_ID                       string
  , S_REC_START_DATE                 date
  , S_REC_END_DATE                   date
  , S_CLOSED_DATE_SK                 int
  , S_STORE_NAME                     string
  , S_NUMBER_EMPLOYEES               int
  , S_FLOOR_SPACE                    int
  , S_HOURS                          string
  , S_MANAGER                        string
  , S_MARKET_ID                      int
  , S_GEOGRAPHY_CLASS                string
  , S_MARKET_DESC                    string
  , S_MARKET_MANAGER                 string
  , S_DIVISION_ID                    int
  , S_DIVISION_NAME                  string
  , S_COMPANY_ID                     int
  , S_COMPANY_NAME                   string
  , S_STREET_NUMBER                  string
  , S_STREET_NAME                    string
  , S_STREET_TYPE                    string
  , S_SUITE_NUMBER                   string
  , S_CITY                           string
  , S_COUNTY                         string
  , S_STATE                          string
  , S_ZIP                            string
  , S_COUNTRY                        string
  , S_GMT_OFFSET                     float
  , S_TAX_PRECENTAGE                 float
  )
  stored as textfile
;

/* Trafodion DDL */

REGISTER /*INTERNAL*/ HIVE TABLE HIVE.HIVE.STORE;
/* ObjectUID = 4314075144480321588 */

CREATE EXTERNAL TABLE STORE
  FOR HIVE.HIVE.STORE


;

-- GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON HIVE.HIVE.STORE TO DB__HIVEROLE WITH GRANT OPTION;
  GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON
  HIVE.HIVE.STORE TO SQL_USER1 WITH GRANT OPTION;
GRANT SELECT, INSERT, DELETE,
  UPDATE, REFERENCES, ALTER, DROP ON HIVE.HIVE.STORE TO SQL_USER5 WITH GRANT
  OPTION;
GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON
  HIVE.HIVE.STORE TO T145_ROLE1;
GRANT SELECT(S_STORE_SK, S_NUMBER_EMPLOYEES)
  ON HIVE.HIVE.STORE TO SQL_USER3;

--- SQL operation complete.
>>showddl hive.hive.store_orc;

/* Hive DDL */
CREATE TABLE HIVE.HIVE.STORE_ORC
  (
    S_STORE_SK                       int
  , S_STORE_ID                       string
  , S_REC_START_DATE                 date
  , S_REC_END_DATE                   date
  , S_CLOSED_DATE_SK                 int
  , S_STORE_NAME                     string
  , S_NUMBER_EMPLOYEES               int
  , S_FLOOR_SPACE                    int
  , S_HOURS                          string
  , S_MANAGER                        string
  , S_MARKET_ID                      int
  , S_GEOGRAPHY_CLASS                string
  , S_MARKET_DESC                    string
  , S_MARKET_MANAGER                 string
  , S_DIVISION_ID                    int
  , S_DIVISION_NAME                  string
  , S_COMPANY_ID                     int
  , S_COMPANY_NAME                   string
  , S_STREET_NUMBER                  string
  , S_STREET_NAME                    string
  , S_STREET_TYPE                    string
  , S_SUITE_NUMBER                   string
  , S_CITY                           string
  , S_COUNTY                         string
  , S_STATE                          string
  , S_ZIP                            string
  , S_COUNTRY                        string
  , S_GMT_OFFSET                     float
  , S_TAX_PRECENTAGE                 float
  )
  stored as orc
;

/* Trafodion DDL */

REGISTER /*INTERNAL*/ HIVE TABLE HIVE.HIVE.STORE_ORC;
/* ObjectUID = 785504836339534968 */

CREATE EXTERNAL TABLE STORE_ORC
  FOR HIVE.HIVE.STORE_ORC


;

-- GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON HIVE.HIVE.STORE_ORC TO DB__HIVEROLE WITH GRANT OPTION;
  GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON
  HIVE.HIVE.STORE_ORC TO SQL_USER1 WITH GRANT OPTION;
GRANT SELECT ON
  HIVE.HIVE.STORE_ORC TO SQL_USER3;
GRANT SELECT, INSERT, DELETE, UPDATE,
  REFERENCES, ALTER, DROP ON HIVE.HIVE.STORE_ORC TO T145_ROLE1;

--- SQL operation complete.
>>
>>exit;

End of MXCI Session

>>
>>-- grant remaining privileges as DB__ROOT
>>grant insert, delete on hive.t145_sch.t145t1 to t145_role2;

--- SQL operation complete.
>>grant all on hive.t145_sch.t145t1 to sql_user1 with grant option;

--- SQL operation complete.
>>grant all on hive.t145_sch.t145t2 to sql_user1 with grant option;

--- SQL operation complete.
>>grant select, insert on hive.t145_sch.t145t1 to sql_user2 by sql_user1;

--- SQL operation complete.
>>grant select, delete on hive.t145_sch.t145t1 to sql_user4;

--- SQL operation complete.
>>showddl hive.t145_sch.t145t1;

/* Hive DDL */
CREATE TABLE HIVE.T145_SCH.T145T1
  (
    A                                int
  , B                                int
  , C                                int
  )
  stored as textfile
;

/* Trafodion DDL */

REGISTER /*INTERNAL*/ HIVE TABLE HIVE.T145_SCH.T145T1;
/* ObjectUID = 785504836339545215 */

-- GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON HIVE.T145_SCH.T145T1 TO DB__HIVEROLE WITH GRANT OPTION;
  GRANT SELECT, INSERT ON HIVE.T145_SCH.T145T1 TO SQL_USER2 GRANTED BY
  SQL_USER1;
GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON
  HIVE.T145_SCH.T145T1 TO SQL_USER1 WITH GRANT OPTION;
GRANT SELECT, DELETE ON
  HIVE.T145_SCH.T145T1 TO SQL_USER4;
GRANT INSERT, DELETE ON
  HIVE.T145_SCH.T145T1 TO T145_ROLE2;

--- SQL operation complete.
>>showddl hive.t145_sch.t145t2;

/* Hive DDL */
CREATE TABLE HIVE.T145_SCH.T145T2
  (
    A                                int
  , B                                int
  , C                                int
  )
  stored as orc
;

/* Trafodion DDL */

REGISTER /*INTERNAL*/ HIVE TABLE HIVE.T145_SCH.T145T2;
/* ObjectUID = 785504836339545538 */

-- GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON HIVE.T145_SCH.T145T2 TO DB__HIVEROLE WITH GRANT OPTION;
  GRANT SELECT, INSERT, DELETE, UPDATE, REFERENCES, ALTER, DROP ON
  HIVE.T145_SCH.T145T2 TO SQL_USER1 WITH GRANT OPTION;

--- SQL operation complete.
>>
>>-- user1 can select and update all tables
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user1;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER1                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

(EXPR)              
--------------------

                  12

--- 1 row(s) selected.
>>select count(*) from hive.hive.store_orc;

(EXPR)              
--------------------

                  12

--- 1 row(s) selected.
>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

S_STORE_SK   S_NUMBER_EMPLOYEES
-----------  ------------------

          1                 245
          2                 236
          3                 236

--- 3 row(s) selected.
>>select * from hive.t145_sch.t145t1 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>select * from hive.t145_sch.t145t2 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>insert into hive.t145_sch.t145t1 values (12,12,12);

--- 1 row(s) inserted.
>>insert into hive.t145_sch.t145t2 values (12,12,12);

--- 1 row(s) inserted.
>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>sh sqlci -i "TEST145(perform_utils)" -u sql_user1;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER1                                                                                                                       

--- 1 row(s) selected.
>>update statistics for table hive.hive.store_orc on every column sample;

--- SQL operation complete.
>>update statistics for table hive.hive.store on every column sample;

--- SQL operation complete.
>>update statistics for table hive.t145_sch.t145t1 on every column sample;

--- SQL operation complete.
>>update statistics for table hive.t145_sch.t145t2 on every column sample;

--- SQL operation complete.
>>truncate table hive.t145_sch.t145t1;

--- SQL operation complete.
>>truncate table hive.t145_sch.t145t2;

--- SQL operation complete.
>>
>>
>>exit;

End of MXCI Session

>>obey TEST145(load_tbls);
>>-- =================================================================
>>-- load data into hive tables
>>-- =================================================================
>>insert overwrite table hive.t145_sch.t145t1 values
+>  (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5), (6,6,6), (7,7,7), (8,8,8);

--- 8 row(s) inserted.
>>insert overwrite table hive.t145_sch.t145t2 values
+>  (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5), (6,6,6), (7,7,7), (8,8,8);

--- 8 row(s) inserted.
>>select * from hive.t145_sch.t145t1;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>select * from hive.t145_sch.t145t2;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>
>>
>>--user2 can select, insert into t145t1
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user2;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER2                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select count(*) from hive.hive.store_orc;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[8822] The statement was not prepared.

>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t1 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

--- 1 row(s) inserted.
>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>
>>-- user3 can select and update statistics on store_orc
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user3;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER3                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

(EXPR)              
--------------------

                  12

--- 1 row(s) selected.
>>select count(*) from hive.hive.store_orc;

(EXPR)              
--------------------

                  12

--- 1 row(s) selected.
>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

S_STORE_SK   S_NUMBER_EMPLOYEES
-----------  ------------------

          1                 245
          2                 236
          3                 236

--- 3 row(s) selected.
>>select * from hive.t145_sch.t145t1 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>sh sqlci -i "TEST145(perform_utils)" -u sql_user3;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER3                                                                                                                       

--- 1 row(s) selected.
>>update statistics for table hive.hive.store_orc on every column sample;

--- SQL operation complete.
>>update statistics for table hive.hive.store on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.HIVE.STORE.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.HIVE.STORE.

--- SQL operation failed with errors.
>>update statistics for table hive.t145_sch.t145t1 on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.T145_SCH.T145T1.

--- SQL operation failed with errors.
>>update statistics for table hive.t145_sch.t145t2 on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.T145_SCH.T145T2.

--- SQL operation failed with errors.
>>truncate table hive.t145_sch.t145t1;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[4481] The user does not have DELETE privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>truncate table hive.t145_sch.t145t2;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[4481] The user does not have DELETE privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>
>>
>>exit;

End of MXCI Session

>>
>>-- user4 can select, update stats, and trucate on t145t1
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user4;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER4                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select count(*) from hive.hive.store_orc;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[8822] The statement was not prepared.

>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t1 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8
         12           12           12

--- 9 row(s) selected.
>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>sh sqlci -i "TEST145(perform_utils)" -u sql_user4;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER4                                                                                                                       

--- 1 row(s) selected.
>>update statistics for table hive.hive.store_orc on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.HIVE.STORE_ORC.

--- SQL operation failed with errors.
>>update statistics for table hive.hive.store on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.HIVE.STORE.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.HIVE.STORE.

--- SQL operation failed with errors.
>>update statistics for table hive.t145_sch.t145t1 on every column sample;

--- SQL operation complete.
>>update statistics for table hive.t145_sch.t145t2 on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.T145_SCH.T145T2.

--- SQL operation failed with errors.
>>truncate table hive.t145_sch.t145t1;

--- SQL operation complete.
>>truncate table hive.t145_sch.t145t2;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[4481] The user does not have DELETE privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>
>>
>>exit;

End of MXCI Session

>>obey TEST145(load_tbls);
>>-- =================================================================
>>-- load data into hive tables
>>-- =================================================================
>>insert overwrite table hive.t145_sch.t145t1 values
+>  (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5), (6,6,6), (7,7,7), (8,8,8);

--- 8 row(s) inserted.
>>insert overwrite table hive.t145_sch.t145t2 values
+>  (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5), (6,6,6), (7,7,7), (8,8,8);

--- 8 row(s) inserted.
>>select * from hive.t145_sch.t145t1;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>select * from hive.t145_sch.t145t2;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>
>>
>>-- user5 can do everything as HIVE_ADMIN
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user5;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER5                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

(EXPR)              
--------------------

                  12

--- 1 row(s) selected.
>>select count(*) from hive.hive.store_orc;

(EXPR)              
--------------------

                  12

--- 1 row(s) selected.
>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

S_STORE_SK   S_NUMBER_EMPLOYEES
-----------  ------------------

          1                 245
          2                 236
          3                 236

--- 3 row(s) selected.
>>select * from hive.t145_sch.t145t1 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>select * from hive.t145_sch.t145t2 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8

--- 8 row(s) selected.
>>insert into hive.t145_sch.t145t1 values (12,12,12);

--- 1 row(s) inserted.
>>insert into hive.t145_sch.t145t2 values (12,12,12);

--- 1 row(s) inserted.
>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>
>>-- user6 can do what t145_role2 has been granted (I,D on t145t1)
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user6;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER6                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select count(*) from hive.hive.store_orc;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[8822] The statement was not prepared.

>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t1 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

--- 1 row(s) inserted.
>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>
>>
>>obey TEST145(test_revokes);
>>-- ============================================================================
>>-- verify that revoking privileges work as expected on native Hive tables
>>-- ============================================================================
>>set schema hive.t145_sch;

--- SQL operation complete.
>>
>>-- user4 can't do anything
>>revoke select, delete on hive.t145_sch.t145t1 from sql_user4;

--- SQL operation complete.
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user4;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER4                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select count(*) from hive.hive.store_orc;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[8822] The statement was not prepared.

>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t1 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>sh sqlci -i "TEST145(perform_utils)" -u sql_user4;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER4                                                                                                                       

--- 1 row(s) selected.
>>update statistics for table hive.hive.store_orc on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.HIVE.STORE_ORC.

--- SQL operation failed with errors.
>>update statistics for table hive.hive.store on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.HIVE.STORE.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.HIVE.STORE.

--- SQL operation failed with errors.
>>update statistics for table hive.t145_sch.t145t1 on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.T145_SCH.T145T1.

--- SQL operation failed with errors.
>>update statistics for table hive.t145_sch.t145t2 on every column sample;

*** ERROR[4481] The user does not have SELECT or MANAGE_STATISTICS privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[9241] Insufficient privileges to perform the statistics request for table HIVE.T145_SCH.T145T2.

--- SQL operation failed with errors.
>>truncate table hive.t145_sch.t145t1;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[4481] The user does not have DELETE privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>truncate table hive.t145_sch.t145t2;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[4481] The user does not have DELETE privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>
>>
>>exit;

End of MXCI Session

>>
>>--user2 can on only select from t145t1
>>revoke insert on hive.t145_sch.t145t1 from sql_user2 by sql_user1;

--- SQL operation complete.
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user2;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER2                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select count(*) from hive.hive.store_orc;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[8822] The statement was not prepared.

>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t1 order by a;

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            2            2
          3            3            3
          4            4            4
          5            5            5
          6            6            6
          7            7            7
          8            8            8
         12           12           12
         12           12           12

--- 10 row(s) selected.
>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>
>>-- user6 can't do anything
>>revoke role t145_role2 from sql_user6;

--- SQL operation complete.
>>sh sqlci -i "TEST145(perform_dml)" -u sql_user6;
>>
>>values (user);

(EXPR)
--------------------------------------------------------------------------------------------------------------------------------

SQL_USER6                                                                                                                       

--- 1 row(s) selected.
>>select count(*) from hive.hive.store;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select count(*) from hive.hive.store_orc;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE_ORC.

*** ERROR[8822] The statement was not prepared.

>>select [first 3] s_store_sk, s_number_employees 
+>  from hive.hive.store order by s_store_sk;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.HIVE.STORE.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t1 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>select * from hive.t145_sch.t145t2 order by a;

*** ERROR[4481] The user does not have SELECT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t1 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T1.

*** ERROR[8822] The statement was not prepared.

>>insert into hive.t145_sch.t145t2 values (12,12,12);

*** ERROR[4481] The user does not have INSERT privilege on table or view HIVE.T145_SCH.T145T2.

*** ERROR[8822] The statement was not prepared.

>>delete from hive.t145_sch.t145t1 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>update hive.t145_sch.t145t1 set a = 13 where a = 12;

*** ERROR[4223] Update/Delete on Hive table is not supported in this software version or edition.

*** ERROR[8822] The statement was not prepared.

>>
>>exit;

End of MXCI Session

>>
>>log;
